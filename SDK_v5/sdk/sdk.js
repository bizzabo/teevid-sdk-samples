module.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}({"./node_modules/asap/browser-raw.js":
/*!******************************************!*\
  !*** ./node_modules/asap/browser-raw.js ***!
  \******************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){"use strict";(function(t){function n(e){i.length||(r(),!0),i[i.length]=e}e.exports=n;var r,i=[],o=0,a=1024;function s(){for(;o<i.length;){var e=o;if(o+=1,i[e].call(),o>a){for(var t=0,n=i.length-o;t<n;t++)i[t]=i[t+o];i.length-=o,o=0}}i.length=0,o=0,!1}var c,d,u,l=void 0!==t?t:self,p=l.MutationObserver||l.WebKitMutationObserver;function f(e){return function(){var t=setTimeout(r,0),n=setInterval(r,50);function r(){clearTimeout(t),clearInterval(n),e()}}}"function"==typeof p?(c=1,d=new p(s),u=document.createTextNode(""),d.observe(u,{characterData:!0}),r=function(){c=-c,u.data=c}):r=f(s),n.requestFlush=r,n.makeRequestCallFromTimer=f}).call(this,n(/*! ./../webpack/buildin/global.js */"./node_modules/webpack/buildin/global.js"))},"./node_modules/immutability-helper/index.js":
/*!***************************************************!*\
  !*** ./node_modules/immutability-helper/index.js ***!
  \***************************************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){var r=n(/*! invariant */"./node_modules/invariant/browser.js"),i=Object.prototype.hasOwnProperty,o=Array.prototype.splice,a=Object.prototype.toString,s=function(e){return a.call(e).slice(8,-1)},c=Object.assign||function(e,t){return d(t).forEach(function(n){i.call(t,n)&&(e[n]=t[n])}),e},d="function"==typeof Object.getOwnPropertySymbols?function(e){return Object.keys(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.keys(e)};function u(e){if(Array.isArray(e))return c(e.constructor(e.length),e);if("Map"===s(e))return new Map(e);if("Set"===s(e))return new Set(e);if(e&&"object"==typeof e){var t=Object.getPrototypeOf(e);return c(Object.create(t),e)}return e}function l(){var e=c({},p);return t.extend=function(t,n){e[t]=n},t.isEquals=function(e,t){return e===t},t;function t(n,o){"function"==typeof o&&(o={$apply:o}),Array.isArray(n)&&Array.isArray(o)||r(!Array.isArray(o),"update(): You provided an invalid spec to update(). The spec may not contain an array except as the value of $set, $push, $unshift, $splice or any custom command allowing an array value."),r("object"==typeof o&&null!==o,"update(): You provided an invalid spec to update(). The spec and every included key path must be plain objects containing one of the following commands: %s.",Object.keys(e).join(", "));var a=n;return d(o).forEach(function(r){if(i.call(e,r)){var c=n===a;a=e[r](o[r],a,o,n),c&&t.isEquals(a,n)&&(a=n)}else{var d="Map"===s(n)?t(n.get(r),o[r]):t(n[r],o[r]),l="Map"===s(a)?a.get(r):a[r];t.isEquals(d,l)&&(void 0!==d||i.call(n,r))||(a===n&&(a=u(n)),"Map"===s(a)?a.set(r,d):a[r]=d)}}),a}}var p={$push:function(e,t,n){return h(t,n,"$push"),e.length?t.concat(e):t},$unshift:function(e,t,n){return h(t,n,"$unshift"),e.length?e.concat(t):t},$splice:function(e,t,n,i){return function(e,t){r(Array.isArray(e),"Expected $splice target to be an array; got %s",e),y(t.$splice)}(t,n),e.forEach(function(e){y(e),t===i&&e.length&&(t=u(i)),o.apply(t,e)}),t},$set:function(e,t,n){return function(e){r(1===Object.keys(e).length,"Cannot have more than one key in an object with $set")}(n),e},$toggle:function(e,t){m(e,"$toggle");var n=e.length?u(t):t;return e.forEach(function(e){n[e]=!t[e]}),n},$unset:function(e,t,n,r){return m(e,"$unset"),e.forEach(function(e){Object.hasOwnProperty.call(t,e)&&(t===r&&(t=u(r)),delete t[e])}),t},$add:function(e,t,n,r){return g(t,"$add"),m(e,"$add"),"Map"===s(t)?e.forEach(function(e){var n=e[0],i=e[1];t===r&&t.get(n)!==i&&(t=u(r)),t.set(n,i)}):e.forEach(function(e){t!==r||t.has(e)||(t=u(r)),t.add(e)}),t},$remove:function(e,t,n,r){return g(t,"$remove"),m(e,"$remove"),e.forEach(function(e){t===r&&t.has(e)&&(t=u(r)),t.delete(e)}),t},$merge:function(e,t,n,i){var o,a;return o=t,r((a=e)&&"object"==typeof a,"update(): $merge expects a spec of type 'object'; got %s",a),r(o&&"object"==typeof o,"update(): $merge expects a target of type 'object'; got %s",o),d(e).forEach(function(n){e[n]!==t[n]&&(t===i&&(t=u(i)),t[n]=e[n])}),t},$apply:function(e,t){var n;return r("function"==typeof(n=e),"update(): expected spec of $apply to be a function; got %s.",n),e(t)}},f=l();function h(e,t,n){r(Array.isArray(e),"update(): expected target of %s to be an array; got %s.",n,e),m(t[n],n)}function m(e,t){r(Array.isArray(e),"update(): expected spec of %s to be an array; got %s. Did you forget to wrap your parameter in an array?",t,e)}function y(e){r(Array.isArray(e),"update(): expected spec of $splice to be an array of arrays; got %s. Did you forget to wrap your parameters in an array?",e)}function g(e,t){var n=s(e);r("Map"===n||"Set"===n,"update(): %s expects a target of type Set or Map; got %s",t,n)}e.exports=f,e.exports.default=f,e.exports.newContext=l},"./node_modules/invariant/browser.js":
/*!*******************************************!*\
  !*** ./node_modules/invariant/browser.js ***!
  \*******************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){"use strict";e.exports=function(e,t,n,r,i,o,a,s){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var d=[n,r,i,o,a,s],u=0;(c=new Error(t.replace(/%s/g,function(){return d[u++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}}},"./node_modules/lodash-es/_freeGlobal.js":
/*!***********************************************!*\
  !*** ./node_modules/lodash-es/_freeGlobal.js ***!
  \***********************************************/
/*! exports provided: default */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module uses injected variables (global) */function(e,t,n){"use strict";(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.a=n}).call(this,n(/*! ./../webpack/buildin/global.js */"./node_modules/webpack/buildin/global.js"))},"./node_modules/lodash.get/index.js":
/*!******************************************!*\
  !*** ./node_modules/lodash.get/index.js ***!
  \******************************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){(function(t){var n="Expected a function",r="__lodash_hash_undefined__",i=1/0,o="[object Function]",a="[object GeneratorFunction]",s="[object Symbol]",c=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,d=/^\w*$/,u=/^\./,l=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,p=/\\(\\)?/g,f=/^\[object .+?Constructor\]$/,h="object"==typeof t&&t&&t.Object===Object&&t,m="object"==typeof self&&self&&self.Object===Object&&self,y=h||m||Function("return this")();var g,v=Array.prototype,E=Function.prototype,S=Object.prototype,_=y["__core-js_shared__"],T=(g=/[^.]+$/.exec(_&&_.keys&&_.keys.IE_PROTO||""))?"Symbol(src)_1."+g:"",b=E.toString,C=S.hasOwnProperty,R=S.toString,I=RegExp("^"+b.call(C).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),A=y.Symbol,O=v.splice,P=V(y,"Map"),w=V(Object,"create"),N=A?A.prototype:void 0,D=N?N.toString:void 0;function k(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function M(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function x(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function L(e,t){for(var n,r,i=e.length;i--;)if((n=e[i][0])===(r=t)||n!=n&&r!=r)return i;return-1}function U(e,t){for(var n,r=0,i=(t=function(e,t){if(z(e))return!1;var n=typeof e;if("number"==n||"symbol"==n||"boolean"==n||null==e||W(e))return!0;return d.test(e)||!c.test(e)||null!=t&&e in Object(t)}(t,e)?[t]:z(n=t)?n:G(n)).length;null!=e&&r<i;)e=e[F(t[r++])];return r&&r==i?e:void 0}function j(e){return!(!H(e)||(t=e,T&&T in t))&&(function(e){var t=H(e)?R.call(e):"";return t==o||t==a}(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?I:f).test(function(e){if(null!=e){try{return b.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function B(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function V(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return j(n)?n:void 0}k.prototype.clear=function(){this.__data__=w?w(null):{}},k.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},k.prototype.get=function(e){var t=this.__data__;if(w){var n=t[e];return n===r?void 0:n}return C.call(t,e)?t[e]:void 0},k.prototype.has=function(e){var t=this.__data__;return w?void 0!==t[e]:C.call(t,e)},k.prototype.set=function(e,t){return this.__data__[e]=w&&void 0===t?r:t,this},M.prototype.clear=function(){this.__data__=[]},M.prototype.delete=function(e){var t=this.__data__,n=L(t,e);return!(n<0||(n==t.length-1?t.pop():O.call(t,n,1),0))},M.prototype.get=function(e){var t=this.__data__,n=L(t,e);return n<0?void 0:t[n][1]},M.prototype.has=function(e){return L(this.__data__,e)>-1},M.prototype.set=function(e,t){var n=this.__data__,r=L(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},x.prototype.clear=function(){this.__data__={hash:new k,map:new(P||M),string:new k}},x.prototype.delete=function(e){return B(this,e).delete(e)},x.prototype.get=function(e){return B(this,e).get(e)},x.prototype.has=function(e){return B(this,e).has(e)},x.prototype.set=function(e,t){return B(this,e).set(e,t),this};var G=q(function(e){var t;e=null==(t=e)?"":function(e){if("string"==typeof e)return e;if(W(e))return D?D.call(e):"";var t=e+"";return"0"==t&&1/e==-i?"-0":t}(t);var n=[];return u.test(e)&&n.push(""),e.replace(l,function(e,t,r,i){n.push(r?i.replace(p,"$1"):t||e)}),n});function F(e){if("string"==typeof e||W(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}function q(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new TypeError(n);var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],o=r.cache;if(o.has(i))return o.get(i);var a=e.apply(this,n);return r.cache=o.set(i,a),a};return r.cache=new(q.Cache||x),r}q.Cache=x;var z=Array.isArray;function H(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function W(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&R.call(e)==s}e.exports=function(e,t,n){var r=null==e?void 0:U(e,t);return void 0===r?n:r}}).call(this,n(/*! ./../webpack/buildin/global.js */"./node_modules/webpack/buildin/global.js"))},"./node_modules/lodash.omit/index.js":
/*!*******************************************!*\
  !*** ./node_modules/lodash.omit/index.js ***!
  \*******************************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){(function(t){var n=200,r="__lodash_hash_undefined__",i=1/0,o=9007199254740991,a="[object Arguments]",s="[object Function]",c="[object GeneratorFunction]",d="[object Symbol]",u=/^\[object .+?Constructor\]$/,l=/^(?:0|[1-9]\d*)$/,p="object"==typeof t&&t&&t.Object===Object&&t,f="object"==typeof self&&self&&self.Object===Object&&self,h=p||f||Function("return this")();function m(e,t){return!!(e?e.length:0)&&function(e,t,n){if(t!=t)return function(e,t,n,r){var i=e.length,o=n+(r?1:-1);for(;r?o--:++o<i;)if(t(e[o],o,e))return o;return-1}(e,E,n);var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,0)>-1}function y(e,t,n){for(var r=-1,i=e?e.length:0;++r<i;)if(n(t,e[r]))return!0;return!1}function g(e,t){for(var n=-1,r=e?e.length:0,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function v(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function E(e){return e!=e}function S(e,t){return e.has(t)}function _(e,t){return function(n){return e(t(n))}}var T,b=Array.prototype,C=Function.prototype,R=Object.prototype,I=h["__core-js_shared__"],A=(T=/[^.]+$/.exec(I&&I.keys&&I.keys.IE_PROTO||""))?"Symbol(src)_1."+T:"",O=C.toString,P=R.hasOwnProperty,w=R.toString,N=RegExp("^"+O.call(P).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),D=h.Symbol,k=_(Object.getPrototypeOf,Object),M=R.propertyIsEnumerable,x=b.splice,L=D?D.isConcatSpreadable:void 0,U=Object.getOwnPropertySymbols,j=Math.max,B=K(h,"Map"),V=K(Object,"create");function G(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function F(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function q(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function z(e){var t=-1,n=e?e.length:0;for(this.__data__=new q;++t<n;)this.add(e[t])}function H(e,t){var n=ie(e)||re(e)?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],r=n.length,i=!!r;for(var o in e)!t&&!P.call(e,o)||i&&("length"==o||te(o,r))||n.push(o);return n}function W(e,t){for(var n,r,i=e.length;i--;)if((n=e[i][0])===(r=t)||n!=n&&r!=r)return i;return-1}function $(e){return!(!se(e)||(t=e,A&&A in t))&&(ae(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e)?N:u).test(function(e){if(null!=e){try{return O.call(e)}catch(e){}try{return e+""}catch(e){}}return""}(e));var t}function Q(e){if(!se(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t,n,r,i=(n=(t=e)&&t.constructor,r="function"==typeof n&&n.prototype||R,t===r),o=[];for(var a in e)("constructor"!=a||!i&&P.call(e,a))&&o.push(a);return o}function Y(e){return function(e,t,n){var r=t(e);return ie(e)?r:v(r,n(e))}(e,de,Z)}function J(e,t){var n,r,i=e.__data__;return("string"==(r=typeof(n=t))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map}function K(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return $(n)?n:void 0}G.prototype.clear=function(){this.__data__=V?V(null):{}},G.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},G.prototype.get=function(e){var t=this.__data__;if(V){var n=t[e];return n===r?void 0:n}return P.call(t,e)?t[e]:void 0},G.prototype.has=function(e){var t=this.__data__;return V?void 0!==t[e]:P.call(t,e)},G.prototype.set=function(e,t){return this.__data__[e]=V&&void 0===t?r:t,this},F.prototype.clear=function(){this.__data__=[]},F.prototype.delete=function(e){var t=this.__data__,n=W(t,e);return!(n<0||(n==t.length-1?t.pop():x.call(t,n,1),0))},F.prototype.get=function(e){var t=this.__data__,n=W(t,e);return n<0?void 0:t[n][1]},F.prototype.has=function(e){return W(this.__data__,e)>-1},F.prototype.set=function(e,t){var n=this.__data__,r=W(n,e);return r<0?n.push([e,t]):n[r][1]=t,this},q.prototype.clear=function(){this.__data__={hash:new G,map:new(B||F),string:new G}},q.prototype.delete=function(e){return J(this,e).delete(e)},q.prototype.get=function(e){return J(this,e).get(e)},q.prototype.has=function(e){return J(this,e).has(e)},q.prototype.set=function(e,t){return J(this,e).set(e,t),this},z.prototype.add=z.prototype.push=function(e){return this.__data__.set(e,r),this},z.prototype.has=function(e){return this.__data__.has(e)};var X=U?_(U,Object):fe,Z=U?function(e){for(var t=[];e;)v(t,X(e)),e=k(e);return t}:fe;function ee(e){return ie(e)||re(e)||!!(L&&e&&e[L])}function te(e,t){return!!(t=null==t?o:t)&&("number"==typeof e||l.test(e))&&e>-1&&e%1==0&&e<t}function ne(e){if("string"==typeof e||function(e){return"symbol"==typeof e||ce(e)&&w.call(e)==d}(e))return e;var t=e+"";return"0"==t&&1/e==-i?"-0":t}function re(e){return function(e){return ce(e)&&oe(e)}(e)&&P.call(e,"callee")&&(!M.call(e,"callee")||w.call(e)==a)}var ie=Array.isArray;function oe(e){return null!=e&&function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=o}(e.length)&&!ae(e)}function ae(e){var t=se(e)?w.call(e):"";return t==s||t==c}function se(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function ce(e){return!!e&&"object"==typeof e}function de(e){return oe(e)?H(e,!0):Q(e)}var ue,le,pe=(ue=function(e,t){return null==e?{}:(t=g(function e(t,n,r,i,o){var a=-1,s=t.length;for(r||(r=ee),o||(o=[]);++a<s;){var c=t[a];n>0&&r(c)?n>1?e(c,n-1,r,i,o):v(o,c):i||(o[o.length]=c)}return o}(t,1),ne),function(e,t){return function(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var a=t[r],s=e[a];n(s,a)&&(o[a]=s)}return o}(e=Object(e),t,function(t,n){return n in e})}(e,function(e,t,r,i){var o,a=-1,s=m,c=!0,d=e.length,u=[],l=t.length;if(!d)return u;r&&(t=g(t,(o=r,function(e){return o(e)}))),i?(s=y,c=!1):t.length>=n&&(s=S,c=!1,t=new z(t));e:for(;++a<d;){var p=e[a],f=r?r(p):p;if(p=i||0!==p?p:0,c&&f==f){for(var h=l;h--;)if(t[h]===f)continue e;u.push(p)}else s(t,f,i)||u.push(p)}return u}(Y(e),t)))},le=j(void 0===le?ue.length-1:le,0),function(){for(var e=arguments,t=-1,n=j(e.length-le,0),r=Array(n);++t<n;)r[t]=e[le+t];t=-1;for(var i=Array(le+1);++t<le;)i[t]=e[t];return i[le]=r,function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(ue,this,i)});function fe(){return[]}e.exports=pe}).call(this,n(/*! ./../webpack/buildin/global.js */"./node_modules/webpack/buildin/global.js"))},"./node_modules/object-assign/index.js":
/*!*********************************************!*\
  !*** ./node_modules/object-assign/index.js ***!
  \*********************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,a,s=function(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),c=1;c<arguments.length;c++){for(var d in n=Object(arguments[c]))i.call(n,d)&&(s[d]=n[d]);if(r){a=r(n);for(var u=0;u<a.length;u++)o.call(n,a[u])&&(s[a[u]]=n[a[u]])}}return s}},"./node_modules/performance-now/lib/performance-now.js":
/*!*************************************************************!*\
  !*** ./node_modules/performance-now/lib/performance-now.js ***!
  \*************************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){(function(t){(function(){var n,r,i,o,a,s;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=t&&t.hrtime?(e.exports=function(){return(n()-a)/1e6},r=t.hrtime,o=(n=function(){var e;return 1e9*(e=r())[0]+e[1]})(),s=1e9*t.uptime(),a=o-s):Date.now?(e.exports=function(){return Date.now()-i},i=Date.now()):(e.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)}).call(this,n(/*! ./../../process/browser.js */"./node_modules/process/browser.js"))},"./node_modules/process/browser.js":
/*!*****************************************!*\
  !*** ./node_modules/process/browser.js ***!
  \*****************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,d=[],u=!1,l=-1;function p(){u&&c&&(u=!1,c.length?d=c.concat(d):l=-1,d.length&&f())}function f(){if(!u){var e=s(p);u=!0;for(var t=d.length;t;){for(c=d,d=[];++l<t;)c&&c[l].run();l=-1,t=d.length}c=null,u=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new h(e,t)),1!==d.length||u||s(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},"./node_modules/promise/lib/core.js":
/*!******************************************!*\
  !*** ./node_modules/promise/lib/core.js ***!
  \******************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){"use strict";var r=n(/*! asap/raw */"./node_modules/asap/browser-raw.js");function i(){}var o=null,a={};function s(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("Promise constructor's argument is not a function");this._h=0,this._i=0,this._j=null,this._k=null,e!==i&&f(e,this)}function c(e,t){for(;3===e._i;)e=e._j;if(s._l&&s._l(e),0===e._i)return 0===e._h?(e._h=1,void(e._k=t)):1===e._h?(e._h=2,void(e._k=[e._k,t])):void e._k.push(t);!function(e,t){r(function(){var n=1===e._i?t.onFulfilled:t.onRejected;if(null!==n){var r=function(e,t){try{return e(t)}catch(e){return o=e,a}}(n,e._j);r===a?u(t.promise,o):d(t.promise,r)}else 1===e._i?d(t.promise,e._j):u(t.promise,e._j)})}(e,t)}function d(e,t){if(t===e)return u(e,new TypeError("A promise cannot be resolved with itself."));if(t&&("object"==typeof t||"function"==typeof t)){var n=function(e){try{return e.then}catch(e){return o=e,a}}(t);if(n===a)return u(e,o);if(n===e.then&&t instanceof s)return e._i=3,e._j=t,void l(e);if("function"==typeof n)return void f(n.bind(t),e)}e._i=1,e._j=t,l(e)}function u(e,t){e._i=2,e._j=t,s._m&&s._m(e,t),l(e)}function l(e){if(1===e._h&&(c(e,e._k),e._k=null),2===e._h){for(var t=0;t<e._k.length;t++)c(e,e._k[t]);e._k=null}}function p(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function f(e,t){var n=!1,r=function(e,t,n){try{e(t,n)}catch(e){return o=e,a}}(e,function(e){n||(n=!0,d(t,e))},function(e){n||(n=!0,u(t,e))});n||r!==a||(n=!0,u(t,o))}e.exports=s,s._l=null,s._m=null,s._n=i,s.prototype.then=function(e,t){if(this.constructor!==s)return function(e,t,n){return new e.constructor(function(r,o){var a=new s(i);a.then(r,o),c(e,new p(t,n,a))})}(this,e,t);var n=new s(i);return c(this,new p(e,t,n)),n}},"./node_modules/promise/lib/es6-extensions.js":
/*!****************************************************!*\
  !*** ./node_modules/promise/lib/es6-extensions.js ***!
  \****************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){"use strict";var r=n(/*! ./core.js */"./node_modules/promise/lib/core.js");e.exports=r;var i=u(!0),o=u(!1),a=u(null),s=u(void 0),c=u(0),d=u("");function u(e){var t=new r(r._n);return t._i=1,t._j=e,t}r.resolve=function(e){if(e instanceof r)return e;if(null===e)return a;if(void 0===e)return s;if(!0===e)return i;if(!1===e)return o;if(0===e)return c;if(""===e)return d;if("object"==typeof e||"function"==typeof e)try{var t=e.then;if("function"==typeof t)return new r(t.bind(e))}catch(e){return new r(function(t,n){n(e)})}return u(e)},r.all=function(e){var t=Array.prototype.slice.call(e);return new r(function(e,n){if(0===t.length)return e([]);var i=t.length;function o(a,s){if(s&&("object"==typeof s||"function"==typeof s)){if(s instanceof r&&s.then===r.prototype.then){for(;3===s._i;)s=s._j;return 1===s._i?o(a,s._j):(2===s._i&&n(s._j),void s.then(function(e){o(a,e)},n))}var c=s.then;if("function"==typeof c)return void new r(c.bind(s)).then(function(e){o(a,e)},n)}t[a]=s,0==--i&&e(t)}for(var a=0;a<t.length;a++)o(a,t[a])})},r.reject=function(e){return new r(function(t,n){n(e)})},r.race=function(e){return new r(function(t,n){e.forEach(function(e){r.resolve(e).then(t,n)})})},r.prototype.catch=function(e){return this.then(null,e)}},"./node_modules/promise/lib/rejection-tracking.js":
/*!********************************************************!*\
  !*** ./node_modules/promise/lib/rejection-tracking.js ***!
  \********************************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){"use strict";var r=n(/*! ./core */"./node_modules/promise/lib/core.js"),i=[ReferenceError,TypeError,RangeError],o=!1;function a(){o=!1,r._l=null,r._m=null}function s(e,t){return t.some(function(t){return e instanceof t})}t.disable=a,t.enable=function(e){e=e||{},o&&a();o=!0;var t=0,n=0,c={};function d(t){(e.allRejections||s(c[t].error,e.whitelist||i))&&(c[t].displayId=n++,e.onUnhandled?(c[t].logged=!0,e.onUnhandled(c[t].displayId,c[t].error)):(c[t].logged=!0,function(e,t){console.warn("Possible Unhandled Promise Rejection (id: "+e+"):"),((t&&(t.stack||t))+"").split("\n").forEach(function(e){console.warn("  "+e)})}(c[t].displayId,c[t].error)))}r._l=function(t){var n;2===t._i&&c[t._o]&&(c[t._o].logged?(n=t._o,c[n].logged&&(e.onHandled?e.onHandled(c[n].displayId,c[n].error):c[n].onUnhandled||(console.warn("Promise Rejection Handled (id: "+c[n].displayId+"):"),console.warn('  This means you can ignore any previous messages of the form "Possible Unhandled Promise Rejection" with id '+c[n].displayId+".")))):clearTimeout(c[t._o].timeout),delete c[t._o])},r._m=function(e,n){0===e._h&&(e._o=t++,c[e._o]={displayId:null,error:n,timeout:setTimeout(d.bind(null,e._o),s(n,i)?100:2e3),logged:!1})}}},"./node_modules/raf/index.js":
/*!***********************************!*\
  !*** ./node_modules/raf/index.js ***!
  \***********************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){(function(t){for(var r=n(/*! performance-now */"./node_modules/performance-now/lib/performance-now.js"),i="undefined"==typeof window?t:window,o=["moz","webkit"],a="AnimationFrame",s=i["request"+a],c=i["cancel"+a]||i["cancelRequest"+a],d=0;!s&&d<o.length;d++)s=i[o[d]+"Request"+a],c=i[o[d]+"Cancel"+a]||i[o[d]+"CancelRequest"+a];if(!s||!c){var u=0,l=0,p=[];s=function(e){if(0===p.length){var t=r(),n=Math.max(0,1e3/60-(t-u));u=n+t,setTimeout(function(){var e=p.slice(0);p.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(u)}catch(e){setTimeout(function(){throw e},0)}},Math.round(n))}return p.push({handle:++l,callback:e,cancelled:!1}),l},c=function(e){for(var t=0;t<p.length;t++)p[t].handle===e&&(p[t].cancelled=!0)}}e.exports=function(e){return s.call(i,e)},e.exports.cancel=function(){c.apply(i,arguments)},e.exports.polyfill=function(e){e||(e=i),e.requestAnimationFrame=s,e.cancelAnimationFrame=c}}).call(this,n(/*! ./../webpack/buildin/global.js */"./node_modules/webpack/buildin/global.js"))},"./node_modules/raf/polyfill.js":
/*!**************************************!*\
  !*** ./node_modules/raf/polyfill.js ***!
  \**************************************/
/*! no static exports found */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){n(/*! ./ */"./node_modules/raf/index.js").polyfill()},"./node_modules/symbol-observable/es/index.js":
/*!****************************************************!*\
  !*** ./node_modules/symbol-observable/es/index.js ***!
  \****************************************************/
/*! exports provided: default */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module uses injected variables (global, module) */function(e,t,n){"use strict";(function(e,r){var i,o=n(/*! ./ponyfill.js */"./node_modules/symbol-observable/es/ponyfill.js");i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:r;var a=Object(o.a)(i);t.a=a}).call(this,n(/*! ./../../webpack/buildin/global.js */"./node_modules/webpack/buildin/global.js"),n(/*! ./../../webpack/buildin/harmony-module.js */"./node_modules/webpack/buildin/harmony-module.js")(e))},"./node_modules/symbol-observable/es/ponyfill.js":
/*!*******************************************************!*\
  !*** ./node_modules/symbol-observable/es/ponyfill.js ***!
  \*******************************************************/
/*! exports provided: default */
/*! exports used: default */function(e,t,n){"use strict";function r(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}n.d(t,"a",function(){return r})},"./node_modules/webpack/buildin/global.js":
/*!***********************************!*\
  !*** (webpack)/buildin/global.js ***!
  \***********************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},"./node_modules/webpack/buildin/harmony-module.js":
/*!*******************************************!*\
  !*** (webpack)/buildin/harmony-module.js ***!
  \*******************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},"./node_modules/whatwg-fetch/fetch.js":
/*!********************************************!*\
  !*** ./node_modules/whatwg-fetch/fetch.js ***!
  \********************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t){!function(e){"use strict";if(!e.fetch){var t={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(t.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],r=function(e){return e&&DataView.prototype.isPrototypeOf(e)},i=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1};u.prototype.append=function(e,t){e=s(e),t=c(t);var n=this.map[e];this.map[e]=n?n+","+t:t},u.prototype.delete=function(e){delete this.map[s(e)]},u.prototype.get=function(e){return e=s(e),this.has(e)?this.map[e]:null},u.prototype.has=function(e){return this.map.hasOwnProperty(s(e))},u.prototype.set=function(e,t){this.map[s(e)]=c(t)},u.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},u.prototype.keys=function(){var e=[];return this.forEach(function(t,n){e.push(n)}),d(e)},u.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),d(e)},u.prototype.entries=function(){var e=[];return this.forEach(function(t,n){e.push([n,t])}),d(e)},t.iterable&&(u.prototype[Symbol.iterator]=u.prototype.entries);var o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},m.call(y.prototype),m.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},v.error=function(){var e=new v(null,{status:0,statusText:""});return e.type="error",e};var a=[301,302,303,307,308];v.redirect=function(e,t){if(-1===a.indexOf(t))throw new RangeError("Invalid status code");return new v(null,{status:t,headers:{location:e}})},e.Headers=u,e.Request=y,e.Response=v,e.fetch=function(e,n){return new Promise(function(r,i){var o=new y(e,n),a=new XMLHttpRequest;a.onload=function(){var e,t,n={status:a.status,statusText:a.statusText,headers:(e=a.getAllResponseHeaders()||"",t=new u,e.split(/\r?\n/).forEach(function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}}),t)};n.url="responseURL"in a?a.responseURL:n.headers.get("X-Request-URL");var i="response"in a?a.response:a.responseText;r(new v(i,n))},a.onerror=function(){i(new TypeError("Network request failed"))},a.ontimeout=function(){i(new TypeError("Network request failed"))},a.open(o.method,o.url,!0),"include"===o.credentials&&(a.withCredentials=!0),"responseType"in a&&t.blob&&(a.responseType="blob"),o.headers.forEach(function(e,t){a.setRequestHeader(t,e)}),a.send(void 0===o._bodyInit?null:o._bodyInit)})},e.fetch.polyfill=!0}function s(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function d(e){var n={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return t.iterable&&(n[Symbol.iterator]=function(){return n}),n}function u(e){this.map={},e instanceof u?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function l(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise(function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function f(e){var t=new FileReader,n=p(t);return t.readAsArrayBuffer(e),n}function h(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(t.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(t.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(t.arrayBuffer&&t.blob&&r(e))this._bodyArrayBuffer=h(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!t.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!i(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=h(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},t.blob&&(this.blob=function(){var e=l(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?l(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(f)}),this.text=function(){var e,t,n,r=l(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=p(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},t.formData&&(this.formData=function(){return this.text().then(g)}),this.json=function(){return this.text().then(JSON.parse)},this}function y(e,t){var n,r,i=(t=t||{}).body;if(e instanceof y){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new u(e.headers)),this.method=e.method,this.mode=e.mode,i||null==e._bodyInit||(i=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new u(t.headers)),this.method=(n=t.method||this.method||"GET",r=n.toUpperCase(),o.indexOf(r)>-1?r:n),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&i)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(i)}function g(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}}),t}function v(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new u(t.headers),this.url=t.url||"",this._initBody(e)}}("undefined"!=typeof self?self:this)},"./sdk/index.js":
/*!***********************************!*\
  !*** ./sdk/index.js + 62 modules ***!
  \***********************************/
/*! exports provided: actionTypes, actions, moderationActions, default */
/*! all exports used */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/immutability-helper/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/lodash-es/_freeGlobal.js (<- Module uses injected variables (global)) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/lodash.get/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/lodash.omit/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/symbol-observable/es/index.js (<- Module uses injected variables (global, module)) */
/*! ModuleConcatenation bailout: Cannot concat with ./sdk/libs/erizo.js (<- Module is not an ECMAScript module) */function(e,t,n){"use strict";n.r(t);var r={GENERAL_ERROR:"teevid/error",GENERAL_WARNING:"teevid/warning",GENERAL_INFO:"teevid/info",SET_GLOBAL_CONFIGS:"teevid/api/global_config",SET_ADMIN_PORTAL:"teevid/api/admin_portal",SET_ADMIN_SOCKET:"teevid/api/admin_socket",PARTICIPANT_STATS:"teevid/api/participant_stats",DELETE_FROM_ROOM:"teevid/api/delete_from_room",ROOM_CLOSE:"teevid/api/room_close",LICENSE_GET:"teevid/api/license_get",LICENSE_SUCCESS:"teevid/api/license_success",LICENSE_ERROR:"teevid/api/license_error",LICENSE_UPDATE:"teevid/api/license_update",LICENSE_UPDATE_SUCCESS:"teevid/api/license_update_success",LICENSE_UPDATE_ERROR:"teevid/api/license_update_error",SERVERS_GET:"teevid/api/servers_get",SERVERS_SUCCESS:"teevid/api/servers_success",SERVERS_ERROR:"teevid/api/servers/error",LIVE_MEETINGS_GET:"teevid/api/live_meetings_get",LIVE_MEETINGS_SUCCESS:"teevid/api/live_meetings_success",LIVE_MEETINGS_ERROR:"teevid/api/live_meetings_error",STORYBOARD_FETCH_ALL:"teevid/api/storyboard_all",STORYBOARD_SUCCESS_ALL:"teevid/api/storyboard_success_all",STORYBOARD_LOAD_PROGRESS:"teevid/api/storyboard_load_progress",STORYBOARD_LOAD_PROGRESS_ERROR:"teevid/api/storyboard_load_progress_error",STORYBOARD_THEMES_FETCH:"teevid/api/storyboard_themes",STORYBOARD_THEMES_SUCCESS:"teevid/api/storyboard_themes_success",STORYBOARD_FETCH:"teevid/api/storyboard_fetch",STORYBOARD_FETCH_SUCCESS:"teevid/api/storyboard_fetch_success",STORYBOARD_UPDATE:"teevid/api/storyboard_update",STORYBOARD_CREATE:"teevid/api/storyboard_create",STORYBOARD_REMOVE:"teevid/api/storyboard_remove",STORYBOARD_REMOVED:"teevid/api/storyboard_removed",STORYBOARD_SUCCESS:"teevid/api/storyboard_success",STORYBOARD_ERROR:"teevid/api/storyboard_error",STORYBOARD_SCENE_CREATE:"teevid/api/storyboard_scene_create",STORYBOARD_SCENE_CREATE_SUCCESS:"teevid/api/storyboard_scene_create_success",STORYBOARD_SCENE_CREATE_ERROR:"teevid/api/storyboard_scene_create_error",REFRESH_MEDIA_DEVICES:"teevid/media/devices_refresh",REFRESH_CURRENT_MEDIA_DEVICES:"teevid/media/devices_refresh_current",SET_MEDIA_DEVICES:"teevid/media/devices_set",SET_CURRENT_MEDIA_DEVICES:"teevid/media/devices_set_current",USERS_FETCH_ALL:"teevid/api/users_all",USERS_SUCCESS_ALL:"teevid/api/users_success_all",USER_CREATE:"teevid/api/users_create",USER_EDIT:"teevid/api/users_edit",USER_CREATE_SUCCESS:"teevid/api/users_create_success",USER_EDIT_SUCCESS:"teevid/api/users_edit_success",USER_CREATE_ERROR:"teevid/api/users_create_error",USER_EDIT_ERROR:"teevid/api/users_edit_error",USER_CHANGE_PASSWORD:"teevid/api/users_change_password",USER_DELETE:"teevid/api/users_delete",USER_DELETE_SUCCESS:"teevid/api/users_delete_success",USER_DELETE_ERROR:"teevid/api/users_delete_error",USERS_ERROR:"teevid/api/users_error",ROOM_FETCH_ALL:"teevid/api/room_all",ROOM_SUCCESS_ALL:"teevid/api/room_success_all",ROOM_CREATE:"teevid/api/room_create",ROOM_CREATE_SUCCESS:"teevid/api/room_create_success",ROOM_CREATE_ERROR:"teevid/api/room_create_error",ROOM_EDIT:"teevid/api/room_edit",ROOM_EDIT_SUCCESS:"teevid/api/room_edit_success",ROOM_EDIT_ERROR:"teevid/api/room_edit_error",ROOM_DELETE:"teevid/api/room_delete",ROOM_DELETE_SUCCESS:"teevid/api/room_delete_success",ROOM_DELETE_ERROR:"teevid/api/room_delete_error",ROOM_ERROR:"teevid/api/room_error",SERVER_STATUS:"server-status",GET_TERMINATED_MEETINGS:"teevid/api/terminated_meetings",GET_TERMINATED_MEETINGS_SUCCESS:"teevid/api/terminated_meetings_success",GET_TERMINATED_MEETINGS_ERROR:"teevid/api/terminated_meetings_error",GET_TERMINATED_PARTICIPANTS:"teevid/api/terminated_participants",GET_TERMINATED_PARTICIPANTS_SUCCESS:"teevid/api/terminated_participants_success",GET_TERMINATED_PARTICIPANTS_ERROR:"teevid/api/terminated_participants_error",MCU_FETCH_ALL:"teevid/api/mcu_all",MCU_SUCCESS_ALL:"teevid/api/mcu_all_success",MCU_START:"teevid/api/mcu_start",MCU_RESTART:"teevid/api/mcu_restart",MCU_START_SUCCESS:"teevid/api/mcu_start_success",MCU_START_ERROR:"teevid/api/mcu_start_error",MCU_REMOVE:"teevid/api/mcu_remove",MCU_REMOVE_SUCCESS:"teevid/api/mcu_remove_success",MCU_STOP:"teevid/api/mcu_stop",MCU_STOP_SUCCESS:"teevid/api/mcu_stop_success",MCU_KILL:"teevid/api/mcu_kill",MCU_KILL_SUCCESS:"teevid/api/mcu_kill_success",MCU_STATS:"teevid/api/mcu_stats",MS_FETCH_ALL:"teevid/api/media_servers_all",MS_SUCCESS_ALL:"teevid/api/media_servers_success_all",MS_ADD:"teevid/api/media_servers_add",MS_ADD_SUCCESS:"teevid/api/media_servers_add_success",MS_REMOVE:"teevid/api/media_servers_remove",MS_REMOVE_SUCCESS:"teevid/api/media_servers_remove_success",KURENTO_FETCH_ALL:"teevid/api/kurento_servers_all",KURENTO_SUCCESS_ALL:"teevid/api/kurento_servers_success_all",NOOP:"noop"};const i={SERVER_STATUS:"server-status",STATS_UPDATED:"stats-update",MCU_INSTANCES:"mcu-instance-list"};var o={UPDATE_TOKEN:"teevid/token/update",SET_SERVER_URL:"teevid/server_url/set",LOGIN:"teevid/login",LOGIN_SUCCESS:"teevid/login/sucess",LOGIN_ERROR:"teevid/login/error",LOGOUT:"teevid/logout",USER_REFRESH_PROFILE:"teevid/user_profile/refresh",USER_EDIT_PROFILE:"teevid/user_profile/edit",USER_EDIT_PROFILE_ERROR:"teevid/user_profile/edit_error",USER_SET_PROFILE:"teevid/user_profile/set",SET_EVENT_ROOM:"teevid/set_event_room"},a=n("./node_modules/immutability-helper/index.js"),s=n.n(a);const c={INTERACTIVE:"interactive",BASIC_LECTURE:"basic-lecture",LECTURE:"lecture"},d={AUTO:"auto",MANUAL:"manual"},u={INIT:0,CONNECTED:1,IS_STREAMING:2,STOPPING:3,STOPPED:4,ERROR:5},l={DISCONNECTED:0,CONNECTING:1,CONNECTED:2,IN_WAITING_ROOM:3,IN_WAITING_SLOT:4},p={INACTIVE:0,CALLING:1,ACCEPTED:2,REJECTED:3},f={0:{length:1,geometry:{optimized_layout_full_quality:1,optimized_layout_threshold:0}},1:{length:2,geometry:{optimized_layout_full_quality:2,optimized_layout_threshold:0}},2:{length:4,geometry:{optimized_layout_full_quality:4,optimized_layout_threshold:0}},3:{length:5,geometry:{optimized_layout_full_quality:1,optimized_layout_threshold:4}},4:{length:6,geometry:{optimized_layout_full_quality:2,optimized_layout_threshold:4}},5:{length:8,geometry:{optimized_layout_full_quality:4,optimized_layout_threshold:4}},default:{length:10,geometry:{optimized_layout_full_quality:4,optimized_layout_threshold:6}}},h={adminSocket:null,isAdminPortal:!1,users:[],license:{},servers:[],mcus:[],mediaServers:[],kurentoServers:[],liveMeetings:{},terminatedMeetings:{},serverUrl:"",storyboards:[],storyboard:null,rooms:[],themes:[],globalConfigs:{},audioDevices:[],videoDevices:[],currentDevices:{video:null,audio:null},percents:0},m=e=>{const t={};return e.forEach(e=>{"optimized_layout_full_quality"===e._id?isNaN(e.value)||0===parseInt(e.value)?t[e._id]=null:t[e._id]=parseInt(e.value):"optimized_layout_threshold"===e._id?isNaN(e.value)?t[e._id]=null:t[e._id]=parseInt(e.value):t[e._id]=e.value}),t.optimized_layout_full_quality||(t.optimized_layout_full_quality=f.default.geometry.optimized_layout_full_quality),t.optimized_layout_threshold||(t.optimized_layout_threshold=f.default.geometry.optimized_layout_threshold),t};var y=(e=h,{type:t,payload:n})=>{switch(t){case o.LOGOUT:return Object.assign({},e,{adminSocket:null,isAdminPortal:!1,users:[],servers:[],liveMeetings:{}});case r.SET_MEDIA_DEVICES:return Object.assign({},e,{audioDevices:n.audio,videoDevices:n.video});case r.SET_CURRENT_MEDIA_DEVICES:return Object.assign({},e,{currentDevices:n});case r.SET_ADMIN_PORTAL:return Object.assign({},e,{isAdminPortal:n});case r.SET_ADMIN_SOCKET:return Object.assign({},e,{adminSocket:n});case r.SET_GLOBAL_CONFIGS:return Object.assign({},e,{globalConfigs:m(n)});case r.LICENSE_SUCCESS:case r.LICENSE_UPDATE_SUCCESS:return Object.assign({},e,{license:n});case r.LIVE_MEETINGS_SUCCESS:return Object.assign({},e,{liveMeetings:n});case r.SERVERS_SUCCESS:return Object.assign({},e,{servers:n});case r.LICENSE_ERROR:return Object.assign({},e,{license:{}});case r.STORYBOARD_FETCH_SUCCESS:return Object.assign({},e,{storyboard:n});case r.STORYBOARD_SUCCESS_ALL:return Object.assign({},e,{storyboards:n});case r.STORYBOARD_LOAD_PROGRESS:return Object.assign({},e,{percents:n});case r.STORYBOARD_THEMES_SUCCESS:return Object.assign({},e,{themes:n});case r.USERS_SUCCESS_ALL:return Object.assign({},e,{users:n});case r.ROOM_SUCCESS_ALL:return Object.assign({},e,{rooms:n});case r.MCU_SUCCESS_ALL:case r.MCU_STATS:return Object.assign({},e,{mcus:n});case r.MS_SUCCESS_ALL:return Object.assign({},e,{mediaServers:n});case r.KURENTO_SUCCESS_ALL:return Object.assign({},e,{kurentoServers:n});case r.SERVER_STATUS:return Object.assign({},e,{liveMeetings:n});case r.PARTICIPANT_STATS:let i={};return Object.keys(n.stats).map(t=>{i[t]=Object.assign({},e.liveMeetings[n.roomId].currentParticipants[t],n.stats[t])}),Object.assign({},s()(e,{liveMeetings:{[n.roomId]:{currentParticipants:{$merge:i}}}}));case r.GET_TERMINATED_MEETINGS_SUCCESS:return Object.assign({},e,{terminatedMeetings:n});default:return e}},g=(Object.assign,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}),v=function(e){return"@@redux-saga/"+e},E=v("TASK"),S=v("HELPER"),_=v("MATCH"),T=v("CANCEL_PROMISE"),b=v("SELF_CANCELLATION"),C=function(e){return function(){return e}},R=C(!0),I=function(){},A=function(e){return e};function O(e,t,n){if(!t(e))throw U("error","uncaught at check",n),new Error(n)}var P=Object.prototype.hasOwnProperty;function w(e,t){return N.notUndef(e)&&P.call(e,t)}var N={undef:function(e){return null==e},notUndef:function(e){return null!=e},func:function(e){return"function"==typeof e},number:function(e){return"number"==typeof e},string:function(e){return"string"==typeof e},array:Array.isArray,object:function(e){return e&&!N.array(e)&&"object"===(void 0===e?"undefined":g(e))},promise:function(e){return e&&N.func(e.then)},iterator:function(e){return e&&N.func(e.next)&&N.func(e.throw)},iterable:function(e){return e&&N.func(Symbol)?N.func(e[Symbol.iterator]):N.array(e)},task:function(e){return e&&e[E]},observable:function(e){return e&&N.func(e.subscribe)},buffer:function(e){return e&&N.func(e.isEmpty)&&N.func(e.take)&&N.func(e.put)},pattern:function(e){return e&&(N.string(e)||"symbol"===(void 0===e?"undefined":g(e))||N.func(e)||N.array(e))},channel:function(e){return e&&N.func(e.take)&&N.func(e.close)},helper:function(e){return e&&e[S]},stringableFunc:function(e){return N.func(e)&&w(e,"toString")}};function D(e,t){var n=e.indexOf(t);n>=0&&e.splice(n,1)}function k(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=void 0,r=new Promise(function(r){n=setTimeout(function(){return r(t)},e)});return r[T]=function(){return clearTimeout(n)},r}var M=function(e){throw e},x=function(e){return{value:e,done:!0}};function L(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:M,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments[3],i={name:n,next:e,throw:t,return:x};return r&&(i[S]=!0),"undefined"!=typeof Symbol&&(i[Symbol.iterator]=function(){return i}),i}function U(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";"undefined"==typeof window?console.log("redux-saga "+e+": "+t+"\n"+(n&&n.stack||n)):console[e](t,n)}function j(e,t){return function(){return e.apply(void 0,arguments)}}var B=function(e){return new Error("\n  redux-saga: Error checking hooks detected an inconsistent state. This is likely a bug\n  in redux-saga code and not yours. Thanks for reporting this in the project's github repo.\n  Error: "+e+"\n")},V=v("IO"),G="TAKE",F="PUT",q="ALL",z="CALL",H="FORK",W="CANCEL",$="SELECT",Q="\n(HINT: if you are getting this errors in tests, consider using createMockTask from redux-saga/utils)",Y=function(e,t){var n;return(n={})[V]=!0,n[e]=t,n};function J(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";if(arguments.length&&O(arguments[0],N.notUndef,"take(patternOrChannel): patternOrChannel is undefined"),N.pattern(e))return Y(G,{pattern:e});if(N.channel(e))return Y(G,{channel:e});throw new Error("take(patternOrChannel): argument "+String(e)+" is not valid channel or a valid pattern")}J.maybe=function(){var e=J.apply(void 0,arguments);return e[G].maybe=!0,e};J.maybe;function K(e,t){return arguments.length>1?(O(e,N.notUndef,"put(channel, action): argument channel is undefined"),O(e,N.channel,"put(channel, action): argument "+e+" is not a valid channel"),O(t,N.notUndef,"put(channel, action): argument action is undefined")):(O(e,N.notUndef,"put(action): argument action is undefined"),t=e,e=null),Y(F,{channel:e,action:t})}function X(e){return Y(q,e)}function Z(e,t,n){O(t,N.notUndef,e+": argument fn is undefined");var r=null;if(N.array(t)){var i=t;r=i[0],t=i[1]}else if(t.fn){var o=t;r=o.context,t=o.fn}return r&&N.string(t)&&N.func(r[t])&&(t=r[t]),O(t,N.func,e+": argument "+t+" is not a function"),{context:r,fn:t,args:n}}function ee(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Y(z,Z("call",e,n))}function te(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Y(H,Z("fork",e,n))}function ne(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t.length>1)return X(t.map(function(e){return ne(e)}));var r=t[0];return 1===t.length&&(O(r,N.notUndef,"cancel(task): argument task is undefined"),O(r,N.task,"cancel(task): argument "+r+" is not a valid Task object "+Q)),Y(W,r||b)}function re(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return 0===arguments.length?e=A:(O(e,N.notUndef,"select(selector,[...]): argument selector is undefined"),O(e,N.func,"select(selector,[...]): argument "+e+" is not a function")),Y($,{selector:e,args:n})}K.resolve=function(){var e=K.apply(void 0,arguments);return e[F].resolve=!0,e},K.sync=j(K.resolve);var ie={done:!0,value:void 0},oe={};function ae(e){return N.channel(e)?"channel":Array.isArray(e)?String(e.map(function(e){return String(e)})):String(e)}function se(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"iterator",r=void 0,i=t;function o(t,n){if(i===oe)return ie;if(n)throw i=oe,n;r&&r(t);var o=e[i](),a=o[0],s=o[1],c=o[2];return r=c,(i=a)===oe?ie:s}return L(o,function(e){return o(null,e)},n,!0)}var ce="Channel's Buffer overflow!",de=1,ue=3,le=4,pe={isEmpty:R,put:I,take:I};function fe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,t=arguments[1],n=new Array(e),r=0,i=0,o=0,a=function(t){n[i]=t,i=(i+1)%e,r++},s=function(){if(0!=r){var t=n[o];return n[o]=null,r--,o=(o+1)%e,t}},c=function(){for(var e=[];r;)e.push(s());return e};return{isEmpty:function(){return 0==r},put:function(s){if(r<e)a(s);else{var d=void 0;switch(t){case de:throw new Error(ce);case ue:n[i]=s,o=i=(i+1)%e;break;case le:d=2*e,n=c(),r=n.length,i=n.length,o=0,n.length=d,e=d,a(s)}}},take:s,flush:c}}var he={none:function(){return pe},fixed:function(e){return fe(e,de)},dropping:function(e){return fe(e,2)},sliding:function(e){return fe(e,ue)},expanding:function(e){return fe(e,le)}};Object.assign;var me={type:"@@redux-saga/CHANNEL_END"},ye=function(e){return e&&"@@redux-saga/CHANNEL_END"===e.type};var ge="invalid buffer passed to channel factory function",ve="Saga was provided with an undefined action";function Ee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:he.none(),n=arguments[2];arguments.length>2&&O(n,N.func,"Invalid match function passed to eventChannel");var r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:he.fixed(),t=!1,n=[];function r(){if(t&&n.length)throw B("Cannot have a closed channel with pending takers");if(n.length&&!e.isEmpty())throw B("Cannot have pending takers with non empty buffer")}return O(e,N.buffer,ge),{take:function(i){r(),O(i,N.func,"channel.take's callback must be a function"),t&&e.isEmpty()?i(me):e.isEmpty()?(n.push(i),i.cancel=function(){return D(n,i)}):i(e.take())},put:function(i){if(r(),O(i,N.notUndef,ve),!t){if(!n.length)return e.put(i);for(var o=0;o<n.length;o++){var a=n[o];if(!a[_]||a[_](i))return n.splice(o,1),a(i)}}},flush:function(n){r(),O(n,N.func,"channel.flush' callback must be a function"),t&&e.isEmpty()?n(me):n(e.flush())},close:function(){if(r(),!t&&(t=!0,n.length)){var e=n;n=[];for(var i=0,o=e.length;i<o;i++)e[i](me)}},get __takers__(){return n},get __closed__(){return t}}}(t),i=function(){r.__closed__||(o&&o(),r.close())},o=e(function(e){ye(e)?i():n&&!n(e)||r.put(e)});if(r.__closed__&&o(),!N.func(o))throw new Error("in eventChannel: subscribe should return a function to unsubscribe");return{take:r.take,flush:r.flush,close:i}}function Se(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o={done:!1,value:J(e)},a=void 0,s=function(e){return a=e};return se({q1:function(){return["q2",o,s]},q2:function(){return a===me?[oe]:["q1",(e=a,{done:!1,value:te.apply(void 0,[t].concat(r,[e]))})];var e}},"q1","takeEvery("+ae(e)+", "+t.name+")")}function _e(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o={done:!1,value:J(e)},a=function(e){return{done:!1,value:te.apply(void 0,[t].concat(r,[e]))}},s=function(e){return{done:!1,value:ne(e)}},c=void 0,d=void 0,u=function(e){return c=e},l=function(e){return d=e};return se({q1:function(){return["q2",o,l]},q2:function(){return d===me?[oe]:c?["q3",s(c)]:["q1",a(d),u]},q3:function(){return["q1",a(d),u]}},"q1","takeLatest("+ae(e)+", "+t.name+")")}function Te(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return te.apply(void 0,[Se,e,t].concat(r))}function be(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return te.apply(void 0,[_e,e,t].concat(r))}Object.assign,"function"==typeof Symbol&&Symbol.iterator;var Ce={INIT_MEETING:"teevid/meeting/init",SET_CONNECTION_STATE:"teevid/connection/state/set",SET_ACCESS_PIN_REQ:"teevid/connection/access_pin/require",MODERATION_SERVER_READY:"teevid/moderation/ready",STATS_ROOM:"teevid/meeting/stats",STATS_PARTICIPANT:"teevid/meeting/participant_stats",MODERATION_MESSAGE_RECEIVED:"teevid/moderation/message",MODERATION_MESSAGE_ERROR:"teevid/moderation/message/error",MODERATION_SOCKET_CREATED:"teevid/moderation/socket/created",MODERATION_SOCKET_CLOSED:"teevid/moderation/socket/closed",MODERATION_SOCKET_OPENED:"teevid/moderation/socket/opened",MODERATION_SOCKET_ERROR:"teevid/moderation/socket/error",CREATE_PARTICIPANT:"teevid/participant/create",CREATE_PARTICIPANT_SUCCESS:"teevid/participant/success",CREATE_PARTICIPANT_ERROR:"teevid/participant/error",CREATE_CONNECTION:"teevid/connection/create",CREATE_CONNECTION_SUCCESS:"teevid/connection/create/success",CREATE_CONNECTION_ERROR:"teevid/connection/create/error",CONNECT:"teevid/connection/connect",CONNECTION_SUCCESS:"teevid/connection/connect/success",CONNECTION_ERROR:"teevid/connection/connect/error",CONNECTION_EVENT:"teevid/connection/event",CONNECTION_READY:"teevid/connection/ready",SET_CURRENT_ROOM:"teevid/meeting/room/set",ROOM_READY:"teevid/meeting/room/ready",CONNECTION_CANCEL:"teevid/connection/cancel",CONNECTION_DISCONNECT:"teevid/connection/disconnect",CONNECTION_DISCONNECTED:"teevid/connection/disconnected",STATUS_UPDATE:"teevid/connection/status_update",SET_STREAMING_STATE:"teevid/streaming/state",STREAMING_START:"teevid/streaming/start",STREAMING_STOP:"teevid/streaming/stop",LOCAL_STREAM_ADDED:"teevid/local_stream/added",CONNECTION_STREAM_ADDED:"teevid/stream/added",CONNECTION_STREAM_REMOVED:"teevid/stream/removed",CONNECTION_LOCAL_STREAM_REMOVED:"teevid/local_stream/removed",CONNECTION_STREAM_SUBSCRIBED:"teevid/stream/subscribed",CONNECTION_STOP_SHARING:"teevid/sharing/stopped",CONNECTION_START_SHARING:"teevid/sharing/started",CONNECTION_ADD_PARTICIPANT:"teevid/participant/add",CONNECTION_ADD_PARTICIPANT_STREAM:"teevid/participant/stream/add",CONNECTION_PARTICIPANT_REMOVED:"teevid/participant/removed",KICK_PARTICIPANT:"teevid/participant/kick",PARTICIPANT_AVATAR_GET:"teevid/participant/avatar_get",PARTICIPANT_AVATAR_SET:"teevid/participant/avatar_set",PARTICIPANT_NAME_CHANGED:"teevid/participant/change_name",NOOP:"noop",SET_MEETING_STATE:"teevid/meeting/set",MEETING_CHANGE_MODE:"teevid/meeting/change_mode",MEETING_CHANGE_LAYOUT:"teevid/meeting/change_layout",MEETING_LAYOUT_MODE:"teevid/meeting/change_layout_mode",MEETING_SEND_LAYOUT:"teevid/meeting/send_layout",MEETING_SLIDE_NUMBER:"teevid/meeting/slide_number",MEETING_SLIDE_CHANGED:"teevid/meeting/slide_number_changed",ROOM_CONNECTED:"teevid/meeting/room/connected",MUTE_STREAM:"teevid/connection/stream/mute",MUTE_UPDATED:"teevid/connection/stream/mute_updated",MUTE_ALL:"teevid/meeting/mute",MUTE_AUDIO:"teevid/meeting/mute_audio",MUTE_VIDEO:"teevid/meeting/mute_video",REMOTE_MUTE:"teevid/meeting/remote_mute",UNMUTE_REQUEST_SENT:"teevid/meeting/um_request_sent",UNMUTE_RESPONSE:"teevid/meeting/um_response",MODERATOR_UNMUTE_REQUEST:"teevid/meeting/moderator_um_request",MODERATOR_UNMUTE_RESPONSE:"teevid/meeting/moderator_um_response",SET_MUTE_STATE:"teevid/meeting/set_mute_state",REQUEST_OWNER_PIN:"teevid/meeting/request_owner_pin",ROLE_CHANGED:"teevid/participant/role_changed",OWNER_PIN_SUCCESS:"teevid/participant/owner-pin-success",OWNER_PIN_FAILED:"teevid/participant/owner-pin-failed",SET_LECTURE_LAYOUT:"teevid/meeting/set_lecture_layout",SET_LAYOUT_MODE:"teevid/meeting/set_layout_mode",UPDATE_LAYOUT_GEOMETRY:"teevid/meeting/update_layout_geometry",UPDATE_LAYOUT_PARTICIPANTS:"teevid/meeting/update_layout_participants",UPDATE_PANEL_LAYOUT_PARTICIPANTS:"teevid/meeting/update_panel_layout_participants",MEETING_SET_MODE:"teevid/meeting/mode",SELECT_FOR_LECTURE:"teevid/meeting/select_for_lecture",SELECT_FOR_PANEL_MODE:"teevid/meeting/select_for_panel_mode",REQUEST_MODERATED_ACTION:"teevid/meeting/request_moderated_action",SET_OWNER_PIN:"teevid/meeting/set_owner_pin",SDK_MESSAGE:"teevid/moderation/sdk_message",RAISE_HAND_REQ:"teevid/meeting/raise_hand",RAISE_HAND_UPDATE:"teevid/meeting/raise_hand/update",RAISE_HAND_RES:"teevid/meeting/raise_hand/response",SET_SIP_STATE:"teevid/meeting/sip_state",SEND_SIP_STATE:"teevid/meeting/send_sip_state",SEND_MESSAGE:"teevid/meeting/send_message",SEND_TRANSCRIPT:"teevid/meeting/send_transcript",ADD_CHAT_MESSAGE:"teevid/meeting/add_chat_message",ADD_TRANSCRIPT_MESSAGE:"teevid/meeting/add_transcript_message",TURN_ON_SUBTITLES:"teevid/meeting/turn_on_subtitles",RECEIVE_SUBTITLES_REQUEST:"teevid/meeting/receive_subtitles_request",UPDATE_TRANSCRIPT:"teevid/meeting/update_transcript_configs",SHARE_TRANSCRIPT:"teevid/meeting/share_transcript",RECEIVE_TRANSCRIPT:"teevid/meeting/receive_transcript",SCREEN_SHARE_STARTED:"teevid/screen_share/started",SCREEN_SHARE_STOPPED:"teevid/screen_share/stopped",SCREEN_SHARE_SET_REMOTE:"teevid/screen_share/set_remote",RECEIVED_REQUEST_TO_PARTICIPATE:"teevid/meeting/received_request_to_participate",BFM_ON_PAUSE:"teevid/meeting/bfm_on_pause",SET_BFM_PAUSE_STATE:"teevid/meeting/set_bfm_pause_state"};const Re={AUDIO:"audio",VIDEO:"video"},Ie={MODERATOR:"Moderator",PARTICIPANT:"Participant"},Ae=(Object.freeze({CONNECTION_SUCCESS:"app/connection/connection_success",SET_CURRENT_ROOM:"teevid/meeting/room/set",CONNECTION_ROOM:"2",LOCAL_STREAM_ADDED:"7",CONNECTION_STREAM_ADDED:"8",CONNECTION_STREAM_REMOVED:"9",CONNECTION_STOP_SHARING:"10",CONNECTION_START_SHARING:"11",MUTE_AUDIO:"12",MUTE_VIDEO:"13",UNMUTE_REQUEST:"UNMUTE_REQUEST",PARTICIPANT_UNMUTE_REQUEST:"PARTICIPANT_UNMUTE_REQUEST",UNMUTE_REQUEST_ACCEPT:"UNMUTE_REQUEST_ACCEPT",UNMUTE_REQUEST_DECLINE:"UNMUTE_REQUEST_DECLINE",UNMUTE_REQUEST_ACCEPTED:"UNMUTE_REQUEST_ACCEPTED",UNMUTE_REQUEST_DECLINED:"UNMUTE_REQUEST_DECLINED",MUTE_VIDEO_STATE_INDICATION:"MUTE_VIDEO_STATE_INDICATION",MUTE_AUDIO_STATE_INDICATION:"MUTE_AUDIO_STATE_INDICATION",CHAT_DISABLE:"CHAT_DISABLE",SET_SCREEN_SHARE:"SET_SCREEN_SHARE",MUTE_ALL:"MUTE_ALL",SET_AUDIO_DEVICES:"SET_AUDIO_DEVICES",SET_VIDEO_DEVICES:"SET_VIDEO_DEVICES",SET_CURRENT_DEVICES:"SET_CURRENT_DEVICES",SWITCH_CURRENT_DEVICES:"SWITCH_CURRENT_DEVICES",INIT_DEVICES:"INIT_DEVICES",MEETING_CHAT_MESSAGE:"MEETING_CHAT_MESSAGE",MEETING_LECTURE_LAYOUT_APPLY:"MEETING_LECTURE_LAYOUT_APPLY",MEETING_LECTURE_LAYOUT:"MEETING_LECTURE_LAYOUT",PARTICIPANT_MUTED:"PARTICIPANT_MUTED",PARTICIPANT_ADDED:"PARTICIPANT_ADDED",PARTICIPANT_REMOVED:"PARTICIPANT_REMOVED",MEETING_LECTURE_SET_SELECTION:"MEETING_LECTURE_SET_SELECTION",MEETING_LECTURE_LAYOUT_UPDATE:"MEETING_LECTURE_LAYOUT_UPDATE",MEETING_LECTURE_SELECT:"MEETING_LECTURE_SELECT",REQUEST_MODERATED_ACTION:"REQUEST_MODERATED_ACTION",PARTICIPANT_ROLE_UPDATE:"PARTICIPANT_ROLE_UPDATE",PARTICIPANT_ROLE_UPDATE_SUCCESS:"PARTICIPANT_ROLE_UPDATE_SUCCESS",PARTICIPANT_ROLE_UPDATE_ERROR:"PARTICIPANT_ROLE_UPDATE_ERROR",MEETING_MODE_SETUP:"MEETING_MODE_SETUP",MEETING_SET_SLIDE:"MEETING_SET_SLIDE",MEETING_SET_MODE:"MEETING_SET_MODE",MEETING_SET_MODE_REQUEST:"MEETING_SET_MODE_REQUEST",MEETING_SET_PRESENTER_STREAM:"MEETING_SET_PRESENTER_STREAM",MEETING_INIT_STB:"MEETING_INIT_STB",MEETING_SET_SCREEN_STREAM:"MEETING_SET_SCREEN_STREAM",STATS_ROOM:"STATS_ROOM",STATS_QOE:"STATS_QOE"}),e=>e.teevid.meeting.participant),Oe=e=>e.teevid.user.profile,Pe=e=>e.teevid.meeting.participant.status.mute,we=e=>e.teevid.meeting.streams,Ne=e=>e.teevid.meeting.remoteParticipants,De=e=>e.teevid.meeting.room,ke=e=>e.teevid.meeting.roomOptions,Me=e=>e.teevid.api.globalConfigs,xe=e=>e.teevid.user.serverUrl,Le=e=>e.teevid.meeting.connection,Ue=e=>e.teevid.meeting.moderationSocket,je=e=>e.teevid.meeting.mode,Be=e=>e.teevid.meeting.participantToken,Ve=e=>e.teevid.user.userToken,Ge=e=>e.teevid.meeting.requiresAccessPin,Fe=e=>e.teevid.meeting.sipCallState,qe=e=>({token:e.teevid.user.userToken,serverUrl:e.teevid.user.serverUrl}),ze=e=>({storyboard:e.teevid.api.storyboard,slideNumber:e.teevid.meeting.slideNumber}),He=e=>({room:e.teevid.meeting.room,globalConfigs:e.teevid.api.globalConfigs,lectureLayout:e.teevid.meeting.lectureLayout,layoutMode:e.teevid.meeting.layoutMode,mode:e.teevid.meeting.mode}),We=e=>({mode:e.teevid.meeting.mode,lecturerId:e.teevid.meeting.lecturerId,storyboardId:e.teevid.meeting.storyboardId,slideNumber:e.teevid.meeting.slideNumber,lectureLayout:e.teevid.meeting.lectureLayout,selectedForLecture:e.teevid.meeting.selectedForLecture,layoutMode:e.teevid.meeting.layoutMode}),$e=e=>({lectureLayout:e.teevid.meeting.lectureLayout,layoutMode:e.teevid.meeting.layoutMode,selectedForLecture:e.teevid.meeting.selectedForLecture}),Qe=(e,t)=>{let n;return(n=e.teevid.meeting.participant._id===t?e.teevid.meeting.participant:e.teevid.meeting.remoteParticipants[t])&&n.streams&&n.streams.mediaStreamId&&e.teevid.meeting.streams&&e.teevid.meeting.streams[n.streams.mediaStreamId]?e.teevid.meeting.streams[n.streams.mediaStreamId]:null},Ye=e=>({token:e.teevid.meeting.participantToken,serverUrl:e.teevid.user.serverUrl,mSocket:e.teevid.meeting.moderationSocket});var Je={setAdminPortal:e=>({type:r.SET_ADMIN_PORTAL,payload:e}),adminSocket:e=>({type:r.SET_ADMIN_SOCKET,payload:e}),serverStatus:e=>({type:r.SERVER_STATUS,payload:e}),participantStats:e=>({type:r.PARTICIPANT_STATS,payload:e}),deleteParticipantFromRoom:(e,t)=>({type:r.DELETE_FROM_ROOM,roomId:e,participantId:t}),closeRoom:e=>({type:r.ROOM_CLOSE,roomId:e}),setGlobalConfig:e=>({type:r.SET_GLOBAL_CONFIGS,payload:e}),licenseGet:()=>({type:r.LICENSE_GET}),licenseSuccess:e=>({type:r.LICENSE_SUCCESS,payload:e}),licenseError:e=>({type:r.LICENSE_ERROR,payload:e}),licenseUpdate:e=>({type:r.LICENSE_UPDATE,license:e}),licenseUpdateSuccess:e=>({type:r.LICENSE_UPDATE_SUCCESS,payload:e}),licenseUpdateError:e=>({type:r.LICENSE_UPDATE_ERROR,error:e}),serversGet:()=>({type:r.SERVERS_GET}),serversSuccess:e=>({type:r.SERVERS_SUCCESS,payload:e}),serversError:()=>({type:r.SERVERS_ERROR}),liveMeetingsGet:()=>({type:r.LIVE_MEETINGS_GET}),liveMeetingsSuccess:e=>({type:r.LIVE_MEETINGS_SUCCESS,payload:e}),liveMeetingsError:()=>({type:r.LIVE_MEETINGS_ERROR}),storyboardFetch:e=>({type:r.STORYBOARD_FETCH,stbId:e}),storyboardFetchSuccess:e=>({type:r.STORYBOARD_FETCH_SUCCESS,payload:e}),storyboardFetchAll:()=>({type:r.STORYBOARD_FETCH_ALL}),storyboardSuccessAll:e=>({type:r.STORYBOARD_SUCCESS_ALL,payload:e}),storyboardLoadProgress:e=>({type:r.STORYBOARD_LOAD_PROGRESS,payload:e}),storyboardLoadProgressError:e=>({type:r.STORYBOARD_LOAD_PROGRESS_ERROR,payload:e}),storyboardThemesFetch:()=>({type:r.STORYBOARD_THEMES_FETCH}),storyboardThemesSuccess:e=>({type:r.STORYBOARD_THEMES_SUCCESS,payload:e}),storyboardError:e=>({type:r.STORYBOARD_ERROR,payload:e}),storyboardSceneCreate:(e,t)=>({type:r.STORYBOARD_SCENE_CREATE,stbId:e,scene:t}),storyboardSceneCreateSuccess:e=>({type:r.STORYBOARD_SCENE_CREATE_SUCCESS,result:e}),storyboardSceneCreateError:e=>({type:r.STORYBOARD_SCENE_CREATE_ERROR,error:e}),usersFetchAll:()=>({type:r.USERS_FETCH_ALL}),usersSuccessAll:e=>({type:r.USERS_SUCCESS_ALL,payload:e}),userCreate:e=>({type:r.USER_CREATE,data:e}),userEdit:(e,t)=>({type:r.USER_EDIT,id:e,data:t}),userCreateSuccess:e=>({type:r.USER_CREATE_SUCCESS}),userEditSuccess:e=>({type:r.USER_EDIT_SUCCESS}),userCreateError:e=>({type:r.USER_CREATE_ERROR,error:e}),userEditError:e=>({type:r.USER_EDIT_ERROR,error:e}),userChangePassword:e=>({type:r.USER_CHANGE_PASSWORD,data:e}),userDelete:e=>({type:r.USER_DELETE,name:e}),userDeleteSuccess:e=>({type:r.USER_DELETE_SUCCESS}),userDeleteError:e=>({type:r.USER_DELETE_ERROR,error:e}),usersError:()=>({type:r.USERS_ERROR}),roomsFetchAll:()=>({type:r.ROOM_FETCH_ALL}),roomsSuccessAll:e=>({type:r.ROOM_SUCCESS_ALL,payload:e}),roomCreate:e=>({type:r.ROOM_CREATE,data:e}),roomCreateSuccess:e=>({type:r.ROOM_CREATE_SUCCESS}),roomCreateError:e=>({type:r.ROOM_CREATE_ERROR,error:e}),roomEdit:(e,t)=>({type:r.ROOM_EDIT,id:e,data:t}),roomEditSuccess:()=>({type:r.ROOM_EDIT_SUCCESS}),roomEditError:e=>({type:r.ROOM_EDIT_ERROR,error:e}),roomDelete:e=>({type:r.ROOM_DELETE,name:e}),roomDeleteSuccess:e=>({type:r.ROOM_DELETE_SUCCESS}),roomDeleteError:e=>({type:r.ROOM_DELETE_ERROR,error:e}),roomsError:()=>({type:r.ROOM_ERROR}),noop:()=>({type:r.NOOP}),refreshMediaDevices:()=>({type:r.REFRESH_MEDIA_DEVICES}),refreshCurrentMediaDevices:e=>({type:r.REFRESH_CURRENT_MEDIA_DEVICES,payload:e}),setMediaDevices:e=>({type:r.SET_MEDIA_DEVICES,payload:e}),setCurrentMediaDevices:e=>({type:r.SET_CURRENT_MEDIA_DEVICES,payload:e}),generalError:e=>({type:r.GENERAL_ERROR,payload:e}),generalWarning:e=>({type:r.GENERAL_WARNING,payload:e}),generalInfo:e=>({type:r.GENERAL_INFO,payload:e}),getTerminatedMeetings:e=>({type:r.GET_TERMINATED_MEETINGS,data:e}),getTerminatedMeetingsSuccess:e=>({type:r.GET_TERMINATED_MEETINGS_SUCCESS,payload:e}),getTerminatedMeetingsError:e=>({type:r.GET_TERMINATED_MEETINGS_ERROR,payload:e}),getTerminatedParticipants:e=>({type:r.GET_TERMINATED_PARTICIPANTS,data:e}),getTerminatedParticipantsSuccess:e=>({type:r.GET_TERMINATED_PARTICIPANTS_SUCCESS,payload:e}),getTerminatedParticipantsError:e=>({type:r.GET_TERMINATED_PARTICIPANTS_ERROR,payload:e}),mcuFetchAll:()=>({type:r.MCU_FETCH_ALL}),mcuSuccessAll:e=>({type:r.MCU_SUCCESS_ALL,payload:e}),mcuStart:e=>({type:r.MCU_START,id:e}),mcuRestart:e=>({type:r.MCU_RESTART,id:e}),mcuStartSuccess:e=>({type:r.MCU_START_SUCCESS,payload:e}),mcuRemove:e=>({type:r.MCU_REMOVE,id:e}),mcuRemoveSuccess:e=>({type:r.MCU_REMOVE_SUCCESS,data:e}),mcuStop:e=>({type:r.MCU_STOP,id:e}),mcuStopSuccess:e=>({type:r.MCU_STOP_SUCCESS,data:e}),mcuKill:e=>({type:r.MCU_KILL,id:e}),mcuKillSuccess:e=>({type:r.MCU_KILL_SUCCESS,data:e}),mcuStats:e=>({type:r.MCU_STATS,payload:e}),msFetchAll:()=>({type:r.MS_FETCH_ALL}),msSuccessAll:e=>({type:r.MS_SUCCESS_ALL,payload:e}),msAdd:e=>({type:r.MS_ADD,data:e}),msAddSuccess:()=>({type:r.MS_ADD_SUCCESS}),msRemove:e=>({type:r.MS_REMOVE,id:e}),msRemoveSuccess:()=>({type:r.MS_REMOVE_SUCCESS}),kurentoFetchAll:()=>({type:r.KURENTO_FETCH_ALL}),kurentoSuccessAll:e=>({type:r.KURENTO_SUCCESS_ALL,payload:e})};const Ke={READY:"ready",STATS_UPDATE:"stats-update",STATUS_UPDATE:"status-update",MEETING_STATE:"meeting-state",ROLE_CHANGED:"role-changed",OWNER_PIN_SUCCESS:"owner-pin-success",OWNER_PIN_FAILED:"owner-pin-failed",STREAMING_STATE:"streaming-state",PARTICIPANT_READY:"participant-ready",PARTICIPANT_ADDED:"participant-added",PARTICIPANT_REMOVED:"participant-removed",MEETING_SET_MODE:"set-meeting-mode",MUTE:"mute",MUTE_UPDATE:"mute-update",UNMUTE_REQUEST:"um-request",GET_ROLE:"get-role",UNMUTE_RESPONSE:"um-response",CHAT:"chat-message",SEND_TRANSCRIPT:"send-transcript-message",SHARE_TRANSCRIPT:"share-transcript",TURN_ON_SUBTITLES:"turn-on-subtitles",STATS:"stats",OWNER_PIN_ENTER:"enter-owner-pin",MEETING_DISBAND:"disband",MEETING_MODE:"set-meeting-mode",LECTURE_LAYOUT:"lecture-layout",LECTURE_STATE:"set-lecture-state",LECTURE_SLIDE_NUMBER:"set-lecture-slide",SHARING_STOP:"stop-sharing",PARTICIPANT_UPDATE:"part-update",KICK_PARTICIPANT:"kick-participant",ROOM_CLOSE:"room-close",DISCONNECT:"disconnect",PARTICIPANT_PUBLISHED:"publish",PARTICIPANT_UNPUBLISHED:"unpublish",PARTICIPANT_SHARES:"part-screen-share",PARTICIPANT_NAME_CHANGED:"part-change-name",STREAMING_START:"strm-start",STREAMING_STOP:"strm-stop",RAISE_HAND_REQ:"raise-hand",RAISE_HAND_UPDATE:"raise-hand-set",RAISE_HAND_RES:"raise-hand-res",SEND_REQUEST_TO_PARTICIPATE:"send-request-to-participate",LEAVE_PLAYBACK_PAGE:"leave-playback-page",RECEIVE_REQUEST_TO_PARTICIPATE:"receive-request-to-participate",REQUEST_TO_PARTICIPATE_SENT:"request-to-participate-sent",ACCEPT_REQUEST_TO_PARTICIPATE:"accept-request-to-participate",REJECT_REQUEST_TO_PARTICIPATE:"reject-request-to-participate",VIEWER_JOIN_TO_MEETING:"viewer-join-to-meeting",SIP_CALL_STATE:"sip-call-state",BFM_ON_PAUSE:"bfm-on-pause"},Xe={type:"web",token:"",data:{method:"noop",params:{}}};var Ze={stats:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.STATS,params:{stats:t}}}),sendToSip:(e,t,n,r)=>Object.assign({},Xe,{token:e,data:{method:Ke.SIP_CALL_STATE,params:{sipUri:t,room:n,state:r}}}),streamRemoved:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.KICK_PARTICIPANT,params:{streamId:t}}}),kickParticipant:(e,t,n)=>Object.assign({},Xe,{token:e,data:{method:Ke.KICK_PARTICIPANT,params:{roomId:t,participantId:n}}}),roomClose:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.ROOM_CLOSE,params:{roomId:t}}}),publishStream:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.PARTICIPANT_PUBLISHED,params:{streamId:t}}}),publishScreenStream:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.PARTICIPANT_SHARES,params:{streamId:t}}}),setOwnerPin:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.OWNER_PIN_ENTER,params:{pin:t}}}),changeParticipantName:(e,t,n)=>Object.assign({},Xe,{token:e,data:{method:Ke.PARTICIPANT_NAME_CHANGED,params:{participantId:t,name:n}}}),mute:(e,t,n,r)=>Object.assign({},Xe,{token:e,data:{method:Ke.MUTE,params:{senderId:t,participantId:n,state:r}}}),muteUpdate:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.MUTE_UPDATE,params:{state:t}}}),raiseHand:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.RAISE_HAND_REQ,params:{state:t}}}),raiseHandUpdate:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.RAISE_HAND_UPDATE,params:t}}),raiseHandDecline:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.RAISE_HAND_RES,params:{participantId:t,accepted:!1}}}),raiseHandAccept:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.RAISE_HAND_RES,params:{participantId:t,accepted:!0}}}),stopSharing:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.SHARING_STOP,params:{state:t}}}),updateRole:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.OWNER_PIN_ENTER,params:{pin:t}}}),participantReady:(e,t,n)=>Object.assign({},Xe,{token:e,data:{method:Ke.PARTICIPANT_READY,params:{hasMic:t.status.hasMic,hasCam:t.status.hasCam,meetingState:n}}}),updateStatus:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.STATUS_UPDATE,params:t}}),setMode:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.MEETING_MODE,params:t}}),setSlide:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.LECTURE_SLIDE_NUMBER,params:{number:t}}}),setLayout:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.LECTURE_LAYOUT,params:t}}),chat:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.CHAT,params:t}}),sendTranscript:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.SEND_TRANSCRIPT,params:t}}),shareTranscript:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.SHARE_TRANSCRIPT,params:t}}),turnOnSubtitles:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.TURN_ON_SUBTITLES,params:t}}),stats:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.STATS,params:{stats:t}}}),startStreaming:e=>Object.assign({},Xe,{token:e,data:{method:Ke.STREAMING_START,params:{}}}),stopStreaming:e=>Object.assign({},Xe,{token:e,data:{method:Ke.STREAMING_STOP,params:{}}}),unmuteRequest:(e,t,n,r)=>Object.assign({},Xe,{token:e,data:{method:Ke.UNMUTE_REQUEST,params:{senderId:t,participantId:n,state:r}}}),getRole:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.GET_ROLE,params:{userToken:t}}}),unmuteResponse:(e,t,n,r)=>Object.assign({},Xe,{token:e,data:{method:Ke.UNMUTE_RESPONSE,params:{senderId:t,participantId:n,state:r}}}),leavePlaybackPage:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.LEAVE_PLAYBACK_PAGE,params:t}}),sendRequestToParticipate:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.SEND_REQUEST_TO_PARTICIPATE,params:t}}),acceptRequestToParticipate:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.ACCEPT_REQUEST_TO_PARTICIPATE,params:t}}),rejectRequestToParticipate:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.REJECT_REQUEST_TO_PARTICIPATE,params:t}}),joinToMeeting:(e,t)=>Object.assign({},Xe,{token:e,data:{method:Ke.JOIN_TO_MEETING,params:t}}),bfmOnPause:(e,t)=>(console.log("BFMONPAUSE ",t),Object.assign({},Xe,{token:e,data:{method:Ke.BFM_ON_PAUSE,params:t}}))};function*et(e,...t){const n=yield re(Ue),r=yield re(Be);n&&1===n.readyState&&n.send(JSON.stringify(e(r,...t)))}const tt=(e,t,n,r,i)=>{const o={method:n.toUpperCase(),headers:{Accept:"application/json","cache-control":"no-store"}};if("/accesstokens"===r){const e=window.btoa(`${i.username}:${i.password}`);o.headers.Authorization=`Basic ${e}`}else t&&(o.headers.Authorization=`Bearer ${t}`);return-1!==["post","put","patch"].indexOf(n.toLowerCase())&&i&&(o.body=JSON.stringify(i),o.headers["Content-Type"]="application/json"),fetch(`https://${e}/api/v1${r}`,o).then(e=>{if(204===e.status)return{};const n=e.json().catch(e=>(console.error(`Error calling ${r}: ${e}`),{}));if(e.status>=200&&e.status<300){let r=t;return e.headers.get("Authorization")&&(r=e.headers.get("Authorization").replace(/^Bearer /,"")),n.then(e=>({payload:e,token:r}))}return 401===e.status?n.then(t=>{const n={code:e.status,type:t.type||t.name||"",message:t.message||t.type,details:t.details||""},r=t.message.split("\n");throw r.length>1&&(t.details=t.details||t.message,t.message=r[0]),n}):n.then(t=>{const n=t.message||e.statusText;throw{code:e.status,message:n}})})};function*nt(e,t,n){const{token:r,serverUrl:i}=yield re(qe);return yield tt(i,r,e,t,n)}function*rt(e,t,n){const{token:r,serverUrl:i}=yield re(Ye),{payload:o}=yield tt(i,r,e,t,n);return o}function it(e){var t=e.play;e.play=function(){e.hasAudio()||e.hasVideo()||e.hasScreen()?(t.apply(e,arguments),e.player.bar&&(e.player.bar.link.setAttribute("href","http://teevid.com/"),e.player.bar.logo.setAttribute("alt",""),e.player.bar.logo.setAttribute("src","assets/cayilogo.png"))):console.warn("Stream",e.getID(),"does not have media channels")},e.show=e.play,e.isPublished=function(){return e.stream&&e.getID()&&"local"!==e.getID()}}const ot=e=>{if(!e||!e.hasVideo()||e.videoMuted)return null;try{let t=document.createElement("canvas"),n=t.getContext("2d"),r=e.getVideoFrame();if(!r)return null;let i=!0;for(let e=0;e<20;e++)0!==r.data[e]&&(i=!1);if(i)return null;t.width=r.width,t.height=r.height,n.putImageData(r,0,0);let o=document.createElement("canvas");const a=o.getContext("2d"),{width:s,height:c}=r;return s>c?(o.width=c,o.height=c,a.drawImage(t,(s-c)/2,0,c,c,0,0,c,c)):(o.width=s,o.height=s,a.drawImage(t,0,(c-s)/2,s,s,0,0,s,s)),o.toDataURL("image/png")}catch(t){console.warn("Thumbnail exception %s for stream %o",t,e)}return null},at=e=>JSON.parse(atob(e.split(".")[1]));function*st(){yield Te(r.LICENSE_GET,function*(e){try{let e=null;const{token:t}=yield re(qe);if(e=t||(yield re(Be))){const e=yield TeeVidSdk.license.get();yield K(Je.licenseSuccess(e))}}catch(e){yield K(Je.generalError(e))}yield}),yield Te(r.LICENSE_UPDATE,function*({license:e}){try{const{token:t}=yield re(qe);if(t){const t=yield TeeVidSdk.license.update(e);yield K(Je.licenseUpdateSuccess(t))}}catch(e){yield K(Je.generalError(e))}yield})}function*ct(){yield Te(o.LOGIN_SUCCESS,function*(){yield K(Je.licenseGet()),yield K(Je.storyboardFetchAll())})}function*dt(){yield Te(r.USERS_FETCH_ALL,ut),yield Te(r.USER_CREATE,lt),yield Te(r.USER_EDIT,pt),yield Te(r.USER_DELETE,ft)}function*ut(){try{const{token:e}=yield re(qe);if(e){const e=yield TeeVidSdk.users.list();yield K(Je.usersSuccessAll(e))}}catch(e){yield K(Je.usersError(e))}}function*lt({data:e}){try{const{token:t}=yield re(qe);if(t){yield TeeVidSdk.users.create(e);yield K(Je.userCreateSuccess())}}catch(e){yield K(Je.userCreateError(e))}}function*pt({id:e,data:t}){try{const{token:n}=yield re(qe);if(n){yield TeeVidSdk.users.edit(e,t);yield K(Je.userEditSuccess())}}catch(e){yield K(Je.userEditError(e))}}function*ft({name:e}){try{const{token:t}=yield re(qe);t&&(yield TeeVidSdk.users.remove(e),yield K(Je.userDeleteSuccess()))}catch(e){yield K(Je.userDeleteError(e))}}function*ht(){yield Te(r.ROOM_FETCH_ALL,mt),yield Te(r.ROOM_CREATE,yt),yield Te(r.ROOM_EDIT,gt),yield Te(r.ROOM_DELETE,vt)}function*mt(){try{const{token:e}=yield re(qe);if(e){const e=yield TeeVidSdk.rooms.list();yield K(Je.roomsSuccessAll(e))}}catch(e){yield K(Je.roomsError(e))}}function*yt({data:e}){try{const{token:t}=yield re(qe);t&&(yield TeeVidSdk.rooms.create(e),yield K(Je.roomCreateSuccess()))}catch(e){yield K(Je.roomCreateError(e))}}function*gt({id:e,data:t}){try{const{token:n}=yield re(qe);if(n){yield TeeVidSdk.rooms.edit(e,t);yield K(Je.roomEditSuccess())}}catch(e){yield K(Je.roomEditError(e))}}function*vt({name:e}){try{const{token:t}=yield re(qe);if(t){yield TeeVidSdk.rooms.delete(e);yield K(Je.roomDeleteSuccess())}}catch(e){yield K(Je.roomDeleteError(e))}}function*Et(){yield Te(r.STORYBOARD_FETCH_ALL,_t),yield Te(r.STORYBOARD_FETCH,St),yield Te(r.STORYBOARD_THEMES_FETCH,Ct),yield Te(r.STORYBOARD_SCENE_CREATE,Tt),yield Te(r.STORYBOARD_LOAD_PROGRESS,bt)}function*St({stbId:e}){try{const{token:t,serverUrl:n}=yield re(qe),r=yield re(Be),i=t||r;if(i){const{payload:t}=yield tt(n,i,"get",`/storyboard/${e}`);yield K(Je.storyboardFetchSuccess(t))}}catch(e){yield K(Je.storyboardError(e))}}function*_t(){try{const{token:e,serverUrl:t}=yield re(qe),{name:n}=yield re(Oe),r=yield re(Be),i=e||r;if(i){const{payload:e}=yield tt(t,i,"get",`/storyboard?owner=${n}`);yield K(Je.storyboardSuccessAll(e))}}catch(e){yield K(Je.storyboardError(e))}}function*Tt({stbId:e,scene:t}){try{const{token:n}=yield re(qe);if(n){const n=yield TeeVidSdk.storyboards.sceneCreate(e,t);yield K(Je.storyboardSceneCreateSuccess(n))}}catch(e){yield K(Je.storyboardSceneCreateError(e))}}function*bt({percents:e}){try{e&&(yield K(Je.storyboardLoadProgress(e)))}catch(e){yield K(Je.storyboardLoadProgressError(e))}}function*Ct(){try{const{token:e,serverUrl:t}=yield re(qe),n=yield re(Be),r=e||n;if(r){const{payload:e}=yield tt(t,r,"get","/themes");yield K(Je.storyboardThemesSuccess(e))}}catch(e){yield}}function*Rt(){try{const{token:e}=yield re(qe);if(e){const e=yield TeeVidSdk.system.servers();yield K(Je.serversSuccess(e))}}catch(e){yield K(Je.serversError(e))}}function*It(){try{const{token:e}=yield re(qe);if(e){const e=yield TeeVidSdk.system.liveMeetins();yield K(Je.liveMeetingsSuccess(e))}}catch(e){yield K(Je.liveMeetingsError(e))}}function*At(){yield Te(r.SERVERS_GET,Rt),yield Te(r.LIVE_MEETINGS_GET,It)}function*Ot(){yield Te(r.SET_ADMIN_PORTAL,function*({payload:e}){if(e){const{token:e}=yield re(qe),t=`wss://${yield re(xe)}/socket/moderation?token=${encodeURIComponent(e)}`,n=new WebSocket(t),r=function(e){return Ee(t=>{return e.onerror=(e=>{t(e)}),e.onmessage=(n=>{let r=n.data;"_"===r?e.send(r):(r=JSON.parse(r),t(r))}),()=>{e.close()}})}(n);yield K(Je.adminSocket(n)),yield te(wt,r)}else{const e=yield re(e=>e.teevid.api.adminSocket);e&&1===e.readyState&&e.close(),yield K(Je.adminSocket(null))}}),yield Te(r.DELETE_FROM_ROOM,function*({roomId:e,participantId:t}){yield Pt(Ze.kickParticipant,e,t)}),yield Te(r.ROOM_CLOSE,function*({roomId:e}){yield Pt(Ze.roomClose,e)})}function*Pt(e,...t){const n=yield re(e=>e.teevid.api.adminSocket),{token:r}=yield re(qe);if(n&&1===n.readyState&&e&&"function"==typeof e){const i=e(r,...t);n.send(JSON.stringify(i))}}function*wt(e){yield Te(e,function*(e){if(!e||"middleware"!==e.type)return void console.error("Missing or malformed message");let t=Je.noop();switch(e.data.method){case i.SERVER_STATUS:t=Je.serverStatus(e.data.params.status);break;case i.MCU_INSTANCES:t=Je.mcuStats(e.data.params.instances);break;case i.STATS_UPDATED:t=Je.participantStats(e.data.params)}yield K(t)})}function*Nt(){yield Te(r.REFRESH_CURRENT_MEDIA_DEVICES,function*({payload:e}){navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices&&(e.video||e.audio),yield K(Je.setCurrentMediaDevices(null))})}function*Dt(){yield Te(r.REFRESH_MEDIA_DEVICES,function*(){if(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){const e=yield navigator.mediaDevices.enumerateDevices().then(e=>{return{audio:e.filter(e=>"audioinput"===e.kind),video:e.filter(e=>"videoinput"===e.kind)}});yield K(Je.setMediaDevices(e))}else yield K(Je.setMediaDevices({audio:[],video:[]}))})}function*kt(){yield Te(r.GET_TERMINATED_MEETINGS,function*({data:e}){const{token:t}=yield re(qe);try{if(t){const t=yield TeeVidSdk.reports.meetings(e);yield K(Je.getTerminatedMeetingsSuccess(t))}}catch(e){yield K(Je.getTerminatedMeetingsError(e))}}),yield Te(r.GET_TERMINATED_PARTICIPANTS,function*({data:e}){const{token:t}=yield re(qe);try{if(t){const t=yield TeeVidSdk.reports.participants(e);yield K(Je.getTerminatedParticipantsSuccess(t))}}catch(e){yield K(Je.getTerminatedParticipantsError(e))}})}function*Mt(){yield Te(r.MS_FETCH_ALL,function*(){try{const{token:e}=yield re(qe);if(e){const e=yield TeeVidSdk.mediaServers.list();yield K(Je.msSuccessAll(e))}}catch(e){yield K(Je.generalError(e))}}),yield Te(r.MS_ADD,function*({data:e}){try{const{token:t}=yield re(qe);t&&(yield TeeVidSdk.mediaServers.add(e),yield K(Je.msAddSuccess()))}catch(e){yield K(Je.generalError(e))}}),yield Te(r.MS_REMOVE,function*({id:e}){try{const{token:t}=yield re(qe);t&&(yield TeeVidSdk.mediaServers.delete(e),yield K(Je.msRemoveSuccess()))}catch(e){yield K(Je.generalError(e))}})}function*xt(){yield Te(r.MCU_FETCH_ALL,function*(){try{const{token:e}=yield re(qe);if(e){const e=yield TeeVidSdk.mcu.list();yield K(Je.mcuSuccessAll(e))}}catch(e){yield K(Je.generalError(e))}}),yield Te(r.MCU_START,function*({id:e}){try{const{token:t}=yield re(qe);if(t){const t=yield TeeVidSdk.mcu.start(e);yield K(Je.mcuStartSuccess(t))}}catch(e){yield K(Je.generalError(e))}}),yield Te(r.MCU_STOP,function*({id:e}){try{const{token:t}=yield re(qe);if(t){const t=yield TeeVidSdk.mcu.stop(e);yield K(Je.mcuStopSuccess(t))}}catch(e){yield K(Je.generalError(e))}}),yield Te(r.MCU_KILL,function*({id:e}){try{const{token:t}=yield re(qe);if(t){const t=yield TeeVidSdk.mcu.kill(e);yield K(Je.mcuKillSuccess(t))}}catch(e){yield K(Je.generalError(e))}}),yield Te(r.MCU_RESTART,function*({id:e}){try{const{token:t}=yield re(qe);t&&(yield TeeVidSdk.mcu.restart(e))}catch(e){yield K(Je.generalError(e))}}),yield Te(r.MCU_REMOVE,function*({id:e}){try{const{token:t}=yield re(qe);if(t){const t=yield TeeVidSdk.mcu.remove(e);yield K(Je.mcuRemoveSuccess(t))}}catch(e){yield K(Je.generalError(e))}})}function*Lt(){yield Te(r.KURENTO_FETCH_ALL,function*(){try{const{token:e}=yield re(qe);if(e){const e=yield TeeVidSdk.kurentoServers.list();yield K(Je.kurentoSuccessAll(e))}}catch(e){yield K(Je.generalError(e))}})}var Ut=function*(){yield X([st(),ct(),Et(),Dt(),Nt(),dt(),ht(),kt(),At(),Ot(),xt(),Mt(),Lt()])};const jt={userToken:localStorage.getItem("authToken")||"",serverUrl:"",profile:null,eventRoom:null};var Bt=(e=jt,{type:t,payload:n})=>{switch(t){case o.LOGOUT:return localStorage.clear(),Object.assign({},e,{userToken:"",profile:null});case o.USER_SET_PROFILE:return localStorage.setItem("currentTheme",n.theme),Object.assign({},e,{profile:n});case o.SET_SERVER_URL:return Object.assign({},e,{serverUrl:n});case o.UPDATE_TOKEN:return localStorage.setItem("authToken",n),Object.assign({},e,{userToken:n});case o.LOGIN_SUCCESS:return localStorage.setItem("currentTheme",n.theme),localStorage.setItem("authToken",n.token),Object.assign({},e,{profile:n.profile,userToken:n.token});case o.LOGIN_ERROR:return localStorage.removeItem("authToken"),Object.assign({},e,{profile:null,userToken:""});case o.STORYBOARD_SUCCESS_ALL:return Object.assign({},e,{storyboards:n});case o.SET_EVENT_ROOM:return Object.assign({},e,{eventRoom:n});default:return e}},Vt={setServerUrl:e=>({type:o.SET_SERVER_URL,payload:e}),updateToken:e=>({type:o.UPDATE_TOKEN,payload:e}),login:(e,t)=>({type:o.LOGIN,payload:{username:e,password:t}}),loginSuccess:(e,t)=>({type:o.LOGIN_SUCCESS,payload:{profile:e,token:t}}),setProfile:e=>({type:o.USER_SET_PROFILE,payload:e}),refreshProfile:()=>({type:o.USER_REFRESH_PROFILE}),loginError:(e,t)=>({type:o.LOGIN_ERROR,payload:e,noRedirect:t}),logout:()=>({type:o.LOGOUT}),editProfile:e=>({type:o.USER_EDIT_PROFILE,profile:e}),editProfileError:e=>({type:o.USER_EDIT_PROFILE_ERROR,error:e}),setEventRoom:e=>({type:o.SET_EVENT_ROOM,payload:e})};function*Gt(){yield Te(o.LOGIN,function*({payload:{username:e,password:t}}){e&&t||(yield K(Vt.loginError({status:403,message:"bad-credentials"})));try{const{payload:n,token:r}=yield nt("post","/accesstokens",{username:e,password:t});yield K(Vt.loginSuccess(n,r))}catch(e){yield K(Vt.loginError(e))}})}function*Ft(e){yield Te(o.USER_REFRESH_PROFILE,function*(){try{const{token:e}=yield re(qe);if(e){const{payload:e}=yield nt("get","/users/me");yield K(Vt.setProfile(e))}}catch(e){yield K(Vt.loginError(e))}}),yield Te(o.USER_EDIT_PROFILE,function*({profile:e}){try{const{token:t}=yield re(qe);t&&(yield nt("patch","/users/me",e),yield K(Vt.refreshProfile()))}catch(e){yield K(Vt.editProfileError(e))}})}var qt=function*(){yield X([Gt(),Ft()])},zt=Object.freeze({RECEIVE_STREAMING_STATUS:"teevid/viewer/receive-streaming-status",SEND_REQUEST_TO_PARTICIPATE:"teevid/viewer/send-request-to-participate",VIEWER_LEAVES_PLAYBACK_PAGE:"teevid/viewer/leaves_playback_page",REQUEST_TO_PARTICIPATE:"teevid/viewer/request-to-participate",REQUEST_TO_PARTICIPATE_ACCEPTED:"teevid/viewer/request-accepted",REQUEST_TO_PARTICIPATE_REJECTED:"teevid/viewer/request-rejected",OPEN_VIEWER_CHANNEL:"teevid/viewer/open-channel",CLOSE_VIEWER_CHANNEL:"teevid/viewer/close-channel",VIEWER_CHANNEL_OPENED:"teevid/viewer/channel-opened",VIEWER_CHANNEL_CLOSED:"teevid/viewer/channel-closed",REQUEST_TO_PARTICIPATE_SENT:"teevid/viewer/request-to-participate-sent",ACCEPT_REQUEST_TO_PARTICIPATE:"teevid/viewer/accept-request-to-participate",REJECT_REQUEST_TO_PARTICIPATE:"teevid/viewer/reject-request-to-participate",CLEAR_REQUEST_DATA:"teevid/viewer/clear-request-data",JOIN_TO_MEETING:"teevid/viewer/join-to-meeting",SET_STREAMING_STATE:"teevid/viewer/set-streaming-state",SET_MEETING_STATE:"teevid/viewer/set-meeting-state",SET_RECEIVED_STREAMING_STATE:"teevid/viewer/set-received-meeting-state",NOOP:"noop"});const Ht=Object.freeze({REQUEST_TO_PARTICIPATE_SENT:"request-to-participate-sent",ACCEPT_REQUEST_TO_PARTICIPATE:"accept-request-to-participate",REJECT_REQUEST_TO_PARTICIPATE:"reject-request-to-participate",MEETING_STATE:"meeting-state",SET_STREAMING_STATE:"streaming-state"}),Wt={guestToken:"",room:"",serverUrl:"",name:"",moderationSocket:null,sent:null,reason:null,accepted:null,participant:null,streamingState:2};var $t=(e=Wt,{type:t,payload:n})=>{switch(t){case zt.OPEN_VIEWER_CHANNEL:return Object.assign({},e,{room:n.roomId});case zt.VIEWER_CHANNEL_OPENED:return Object.assign({},e,{moderationSocket:n});case zt.REQUEST_TO_PARTICIPATE_SENT:case zt.REQUEST_TO_PARTICIPATE_ACCEPTED:case zt.REQUEST_TO_PARTICIPATE_REJECTED:return Object.assign({},e,n);case zt.CLEAR_REQUEST_DATA:return Object.assign({},e,{sent:null,reason:"",accepted:null});case zt.SET_MEETING_STATE:return Object.assign({},e,{streamingState:n.state.streamingState});case zt.SET_RECEIVED_STREAMING_STATE:return Object.assign({},e,{streamingState:n.newState});default:return e}},Qt=Object.freeze({requestToParticipate:e=>({type:zt.REQUEST_TO_PARTICIPATE,payload:e}),viewerLeavesPlaybackPage:e=>({type:zt.VIEWER_LEAVES_PLAYBACK_PAGE,payload:e}),acceptRequestToParticipate:e=>({type:zt.ACCEPT_REQUEST_TO_PARTICIPATE,payload:e}),requestToParticipateAccepted:e=>({type:zt.REQUEST_TO_PARTICIPATE_ACCEPTED,payload:e}),rejectRequestToParticipate:e=>({type:zt.REJECT_REQUEST_TO_PARTICIPATE,payload:e}),requestToParticipateRejected:e=>({type:zt.REQUEST_TO_PARTICIPATE_REJECTED,payload:e}),noop:()=>({type:zt.NOOP}),closeViewerChannel:e=>({type:zt.CLOSE_VIEWER_CHANNEL,payload:e}),openViewerChannel:e=>({type:zt.OPEN_VIEWER_CHANNEL,payload:e}),viewerChannelOpened:e=>({type:zt.VIEWER_CHANNEL_OPENED,payload:e}),viewerChannelClosed:()=>({type:zt.VIEWER_CHANNEL_CLOSED}),requestToParticipateSent:e=>({type:zt.REQUEST_TO_PARTICIPATE_SENT,payload:e}),clearRequestData:()=>({type:zt.CLEAR_REQUEST_DATA}),joinToMeeting:()=>({type:zt.JOIN_TO_MEETING}),receiveStreamingStatus:e=>({type:zt.RECEIVE_STREAMING_STATUS,payload:e}),setMeetingState:e=>({type:zt.SET_MEETING_STATE,payload:e}),setReceivedStreamingState:e=>({type:zt.SET_RECEIVED_STREAMING_STATE,payload:e})}),Yt={setCurrentRoom:e=>({type:Ce.SET_CURRENT_ROOM,payload:e}),roomStats:e=>({type:Ce.STATS_ROOM,payload:e}),createParticipant:(e,t,n={})=>({type:Ce.CREATE_PARTICIPANT,payload:{room:e,username:t,pin:n}}),participantCreated:e=>({type:Ce.CREATE_PARTICIPANT_SUCCESS,payload:e}),participantCreationError:(e,t=0)=>({type:Ce.CREATE_PARTICIPANT_ERROR,payload:{error:e,state:t}}),addParticipant:e=>({type:Ce.CONNECTION_ADD_PARTICIPANT,payload:e}),addParticipantStream:e=>({type:Ce.CONNECTION_ADD_PARTICIPANT_STREAM,payload:e}),removeParticipant:e=>({type:Ce.CONNECTION_PARTICIPANT_REMOVED,payload:e}),kickParticipant:(e,t)=>({type:Ce.KICK_PARTICIPANT,roomId:e,participantId:t}),updateStats:e=>({type:Ce.STATS_PARTICIPANT,payload:e}),connect:()=>({type:Ce.CONNECT}),createConnection:e=>({type:Ce.CREATE_CONNECTION,payload:e}),connectionCreated:e=>({type:Ce.CREATE_CONNECTION_SUCCESS,payload:{connection:e}}),connectionCreationError:e=>({type:Ce.CREATE_CONNECTION_ERROR,payload:e}),connectionSuccess:e=>({type:Ce.CONNECTION_SUCCESS,connection:e}),connectionEvent:(e,t)=>({type:Ce.CONNECTION_EVENT,payload:{event:e,eventType:t}}),setOwnerPin:e=>({type:Ce.SET_OWNER_PIN,pin:e}),requestOwnerPin:e=>({type:Ce.REQUEST_OWNER_PIN,payload:{action:e}}),setConnectionState:(e=0)=>({type:Ce.SET_CONNECTION_STATE,payload:e}),setAccessPinRequirement:e=>({type:Ce.SET_ACCESS_PIN_REQ,payload:e}),connectionCancel:()=>({type:Ce.CONNECTION_CANCEL}),connectionReady:()=>({type:Ce.CONNECTION_READY}),moderationSocketCreated:e=>({type:Ce.MODERATION_SOCKET_CREATED,payload:e}),moderationServerReady:()=>({type:Ce.MODERATION_SERVER_READY}),connectionError:e=>({type:Ce.CONNECTION_ERROR,payload:e}),connectionRoomReady:()=>({type:Ce.ROOM_READY}),disconnect:()=>({type:Ce.CONNECTION_DISCONNECT}),disconnected:()=>({type:Ce.CONNECTION_DISCONNECTED}),sendSipState:e=>({type:Ce.SEND_SIP_STATE,payload:e}),setSipState:e=>({type:Ce.SET_SIP_STATE,payload:e}),statusChanged:e=>({type:Ce.STATUS_UPDATE,payload:e}),localStreamAdded:e=>({type:Ce.LOCAL_STREAM_ADDED,payload:e}),streamAdded:e=>({type:Ce.CONNECTION_STREAM_ADDED,payload:e}),streamRemoved:e=>({type:Ce.CONNECTION_STREAM_REMOVED,payload:e}),streamSubscribed:e=>({type:Ce.CONNECTION_STREAM_SUBSCRIBED,payload:e}),stopSharing:()=>({type:Ce.CONNECTION_STOP_SHARING}),startSharing:()=>({type:Ce.CONNECTION_START_SHARING}),mMessage:e=>({type:Ce.MODERATION_MESSAGE_RECEIVED,payload:e}),mMessageError:e=>({type:Ce.MODERATION_MESSAGE_ERROR,payload:e}),mSocketClosed:e=>({type:Ce.MODERATION_SOCKET_CLOSED,payload:e}),mSocketError:e=>({type:Ce.MODERATION_SOCKET_ERROR,payload:e}),noop:()=>({type:Ce.NOOP}),setMeetingState:e=>({type:Ce.SET_MEETING_STATE,payload:e}),setMeetingMode:e=>({type:Ce.MEETING_CHANGE_MODE,payload:e}),setMeetingLayout:e=>({type:Ce.MEETING_CHANGE_LAYOUT,payload:e}),setLayoutMode:e=>({type:Ce.MEETING_LAYOUT_MODE,payload:{layoutMode:e}}),setSlideNumber:e=>({type:Ce.MEETING_SLIDE_NUMBER,payload:{number:e}}),slideNumberChanged:e=>({type:Ce.MEETING_SLIDE_CHANGED,payload:{number:e}}),sendMeetingLayout:()=>({type:Ce.MEETING_SEND_LAYOUT}),roomConnected:()=>({type:Ce.ROOM_CONNECTED}),themesSuccessAll:e=>({type:Ce.THEMES_SUCCESS_ALL,themes:e}),themesFetchAll:()=>({type:Ce.THEMES_FETCH}),raiseHandRequest:e=>({type:Ce.RAISE_HAND_REQ,payload:e}),raiseHandUpdate:e=>({type:Ce.RAISE_HAND_UPDATE,payload:e}),raiseHandResponse:(e,t)=>({type:Ce.RAISE_HAND_RES,payload:{accepted:e,id:t}}),setStreamingState:e=>({type:Ce.SET_STREAMING_STATE,payload:e}),startStreaming:()=>({type:Ce.STREAMING_START}),stopStreaming:()=>({type:Ce.STREAMING_STOP}),setSharingStream:e=>({type:Ce.SCREEN_SHARE_STARTED,payload:e}),setRemoteScreenStream:(e,t)=>({type:Ce.SCREEN_SHARE_SET_REMOTE,payload:{streamId:e,participantId:t}}),removeSharingStream:e=>({type:Ce.SCREEN_SHARE_STOPPED,payload:e}),getAvatar:e=>({type:Ce.PARTICIPANT_AVATAR_GET,participantId:e}),setAvatar:(e,t)=>({type:Ce.PARTICIPANT_AVATAR_SET,payload:{participantId:e,avatar:t}}),roleChanged:(e,t,n)=>({type:Ce.ROLE_CHANGED,payload:{participantId:e,data:{role:t,isRoomOwner:n}}}),ownerPinSuccess:(e,t,n)=>({type:Ce.OWNER_PIN_SUCCESS,payload:{participantId:e,data:{role:t,isRoomOwner:n}}}),ownerPinFailed:e=>({type:Ce.OWNER_PIN_FAILED,payload:e}),participantMuteUpdate:(e,t)=>({type:Ce.MUTE_UPDATED,payload:{participantId:e,mute:t}}),muteStream:()=>({type:Ce.MUTE_STREAM}),mute:e=>({type:Ce.MUTE_ALL,state:e}),muteAudio:e=>({type:Ce.MUTE_AUDIO,state:e}),muteVideo:e=>({type:Ce.MUTE_VIDEO,state:e}),moderatorUnmuteRequest:(e,t)=>({type:Ce.MODERATOR_UNMUTE_REQUEST,payload:{senderId:e,device:t}}),moderatorUnmuteResponse:(e,t)=>({type:Ce.MODERATOR_UNMUTE_RESPONSE,payload:{senderId:e,device:t}}),remoteMute:(e,t,n)=>({type:Ce.REMOTE_MUTE,participantId:e,device:t,state:n}),setMuteState:e=>({type:Ce.SET_MUTE_STATE,payload:e}),unmuteRequestSent:(e,t)=>({type:Ce.UNMUTE_REQUEST_SENT,payload:{participantId:e,device:t}}),setParticipantUnmuteRequest:(e,t)=>({type:Ce.PARTICIPANT_UNMUTE_REQUEST,senderId:e,request:t}),unmuteResponse:(e,t)=>({type:Ce.UNMUTE_RESPONSE,payload:{device:t,senderId:e}}),unmuteRequestAccepted:(e,t)=>({type:Ce.UNMUTE_REQUEST_ACCEPTED,participantId:e,request:t}),unmuteRequestDeclined:(e,t)=>({type:Ce.UNMUTE_REQUEST_DECLINED,participantId:e,request:t}),setVideoStateIndication:e=>({type:Ce.MUTE_VIDEO_STATE_INDICATION,state:e}),setAudioStateIndication:e=>({type:Ce.MUTE_AUDIO_STATE_INDICATION,state:e}),setChatDisabled:e=>({type:Ce.CHAT_DISABLE,state:e}),setScreenSharing:e=>({type:Ce.SET_SCREEN_SHARE,state:e}),setAudioDevices:e=>({type:Ce.SET_AUDIO_DEVICES,devices:e}),setVideoDevices:e=>({type:Ce.SET_VIDEO_DEVICES,devices:e}),setCurrentDevices:(e,t)=>({type:Ce.SET_CURRENT_DEVICES,devices:{video:e,audio:t}}),switchCurrentDevices:(e,t)=>({type:Ce.SWITCH_CURRENT_DEVICES,video:e,audio:t}),initMediaDevices:e=>({type:Ce.INIT_DEVICES,options:e}),sendMessage:e=>({type:Ce.SEND_MESSAGE,payload:e}),addChatMessage:e=>({type:Ce.ADD_CHAT_MESSAGE,payload:e}),sendTranscript:e=>({type:Ce.SEND_TRANSCRIPT,payload:e}),addTranscriptMessage:e=>({type:Ce.ADD_TRANSCRIPT_MESSAGE,payload:e}),turnOnSubtitles:e=>({type:Ce.TURN_ON_SUBTITLES,payload:e}),receiveSubtitlesRequest:e=>({type:Ce.RECEIVE_SUBTITLES_REQUEST,payload:e}),updateTranscript:e=>({type:Ce.UPDATE_TRANSCRIPT,payload:e}),shareTranscript:e=>({type:Ce.SHARE_TRANSCRIPT,payload:e}),receiveTranscript:e=>({type:Ce.RECEIVE_TRANSCRIPT,payload:e}),bfmOnPause:e=>({type:Ce.BFM_ON_PAUSE,payload:e}),setBfmPauseState:e=>({type:Ce.SET_BFM_PAUSE_STATE,payload:e}),applyLectureLayout:()=>({type:Ce.MEETING_LECTURE_LAYOUT_APPLY}),setLectureLayout:e=>({type:Ce.SET_LECTURE_LAYOUT,payload:{lectureLayout:e}}),updateLayoutGeometry:e=>({type:Ce.UPDATE_LAYOUT_GEOMETRY,payload:{geometry:e}}),updateLayoutParticipants:e=>({type:Ce.UPDATE_LAYOUT_PARTICIPANTS,payload:{selectedForLecture:e}}),updatePanelLayoutParticipants:e=>({type:Ce.UPDATE_PANEL_LAYOUT_PARTICIPANTS,payload:{selectedForLecture:e}}),selectForLecture:(e,t,n)=>({type:Ce.SELECT_FOR_LECTURE,payload:{participantId:e,tileId:t,previousParticipantId:n}}),selectForPanelMode:e=>({type:Ce.SELECT_FOR_PANEL_MODE,payload:{selectedForLecture:e}}),setMutedStatus:(e,t)=>({type:Ce.PARTICIPANT_MUTED,streamId:e,add:t}),changeParticipantName:(e,t)=>({type:Ce.PARTICIPANT_NAME_CHANGED,payload:{participantId:e,name:t}}),setSelectionForLecture:e=>({type:Ce.MEETING_LECTURE_SET_SELECTION,list:e}),lectureLayoutUpdate:e=>({type:Ce.MEETING_LECTURE_LAYOUT_UPDATE,action:e}),selectParticipantForLecture:(e,t)=>({type:Ce.MEETING_LECTURE_SELECT,id:e,index:t}),requestModeratedAction:e=>({type:Ce.REQUEST_MODERATED_ACTION,action:e}),updateRole:(e,t)=>({type:Ce.PARTICIPANT_ROLE_UPDATE,action:e,pin:t}),updateRoleSuccess:()=>({type:Ce.PARTICIPANT_ROLE_UPDATE_SUCCESS}),updateRoleError:e=>({type:Ce.PARTICIPANT_ROLE_UPDATE_ERROR,payload:e}),modeSetup:e=>({type:Ce.MEETING_MODE_SETUP,payload:e}),setSlide:e=>({type:Ce.MEETING_SET_SLIDE,slideNumber:e}),setMode:(e,t=null)=>({type:Ce.MEETING_SET_MODE,payload:{mode:e,stbId:t}}),setModeRequest:e=>({type:Ce.MEETING_SET_MODE_REQUEST,mode:e}),setPresenterStream:e=>({type:Ce.MEETING_SET_PRESENTER_STREAM,streamId:e}),setInitStb:e=>({type:Ce.MEETING_INIT_STB,payload:e}),setScreenStream:e=>({type:Ce.MEETING_SET_SCREEN_STREAM,stream:e}),setQoe:(e,t)=>({type:Ce.STATS_QOE,participantId:e,qoe:t}),SDKMessage:e=>({type:Ce.SDK_MESSAGE,payload:e}),receivedRequestToParticipate:e=>({type:Ce.RECEIVED_REQUEST_TO_PARTICIPATE,payload:e})};const Jt=e=>e.teevid.viewer.moderationSocket,Kt=e=>e.teevid.viewer.participant;function*Xt(e,...t){const n=yield re(Jt),{token:r}=yield re(qe);n&&1===n.readyState&&n.send(JSON.stringify(e(r,...t)))}function*Zt(){yield Te(zt.OPEN_VIEWER_CHANNEL,function*({payload:{roomId:e}}){const t=yield re(xe),n=yield re(Ve),r=`wss://${t}/socket/moderation?token=${encodeURIComponent(n)}&roomId=${e}`,i=new WebSocket(r);i.onclose=(e=>{console.info("Moderation Socket closed",e)});const o=function(e){return Ee(t=>(e.onerror=(e=>{console.log(e)}),e.onmessage=(n=>{let r=n.data;r&&"_"===r?e&&1===e.readyState&&e.send(r):(r=JSON.parse(r),t(r))}),()=>{e.close()}))}(i);yield K(Qt.viewerChannelOpened(i)),yield function*(e){yield Te(zt.CLOSE_VIEWER_CHANNEL,()=>{e.close()}),yield Te(e,function*(e){const{method:t,params:n}=e.data;let r=Qt.noop();switch(t){case Ht.ACCEPT_REQUEST_TO_PARTICIPATE:r=Qt.requestToParticipateAccepted(n);break;case Ht.REJECT_REQUEST_TO_PARTICIPATE:r=Qt.requestToParticipateRejected(n);break;case Ht.REQUEST_TO_PARTICIPATE_SENT:r=Qt.requestToParticipateSent(n);break;case Ht.SET_STREAMING_STATE:r=Qt.setReceivedStreamingState(n);break;case Ht.MEETING_STATE:r=Qt.setMeetingState(n)}yield K(r)})}(o)})}function*en(){yield Te(zt.REQUEST_TO_PARTICIPATE,function*({payload:e}){e&&(yield Xt(Ze.sendRequestToParticipate,e)),yield})}function*tn(){yield Te(zt.VIEWER_LEAVES_PLAYBACK_PAGE,function*({payload:e}){e&&(yield Xt(Ze.leavePlaybackPage,e))})}function*nn(){yield Te(zt.ACCEPT_REQUEST_TO_PARTICIPATE,function*({payload:e}){e&&(yield et(Ze.acceptRequestToParticipate,{id:e}))})}function*rn(){yield Te(zt.REJECT_REQUEST_TO_PARTICIPATE,function*({payload:e}){e&&(yield et(Ze.rejectRequestToParticipate,{id:e}))})}function*on(){yield Te(zt.JOIN_TO_MEETING,function*(){const e=yield re(Jt),t=yield re(Kt);yield K(Yt.setCurrentRoom(t.room)),yield K(Yt.participantCreated(t)),e&&3!==e.readyState&&e.close()})}function*an(){yield X([Zt(),en(),nn(),rn(),on(),tn()])}var sn=n("./node_modules/lodash.get/index.js"),cn=n.n(sn),dn=n("./node_modules/lodash.omit/index.js"),un=n.n(dn);const ln=e=>{let t;if(e){const{optimized_layout_full_quality:n,optimized_layout_threshold:r}=e;t=Object.assign({},f.default.geometry,{optimized_layout_full_quality:n,optimized_layout_threshold:r})}else t=Object.assign({},f.default.geometry);return{optimizedLayoutFullQuality:t.optimized_layout_full_quality,optimizedLayoutThreshold:t.optimized_layout_threshold}},pn={participantToken:"",participant:null,remoteParticipants:{},roomOptions:{enableChat:!1,hasAccessPin:!1,hasOwnerPin:!1},viewersRequests:[],layoutGeometry:ln(),room:null,connectionState:l.DISCONNECTED,requiresAccessPin:!1,connection:null,streamStats:{},moderationSocket:null,sipCallState:{state:0,sipUri:""},mode:c.INTERACTIVE,streams:{},meetingId:"",streamingState:u.STOPPED,isConnected:!1,startTime:0,slideNumber:0,storyboardId:null,chatLog:[],lecturerId:null,transcript:[],subtitles:[],subtitlesLangs:[],selectedForLecture:[],lectureLayout:0,layoutMode:"auto",isPresenter:!1,bfmPaused:!1},fn=(e,t,n)=>{let r=e.slice();if(-1===r.indexOf(n)&&(r=[n,...r]),r.length===t)return r;r.length>t&&(r=(r=[n,...r.filter(e=>-1===["stub",n].indexOf(e))]).slice(0,t));for(let e=0;e<t;e++){r[e]||(r[e]="stub")}return r};var hn=(e=pn,{type:t,payload:n})=>{switch(t){case Ce.SET_SIP_STATE:return s()(e,{sipCallState:{$set:n}});case Ce.STATS_PARTICIPANT:return((e,t)=>{const n={streamStats:{}};try{for(const e in t)t.hasOwnProperty(e)&&(n.streamStats[e]={$push:[{value:cn()(t,`${e}.qoe`,0),name:"stats-qoe",label:"QOE"}]});return s()(e,n)}catch(t){return e}})(e,n);case Ce.SCREEN_SHARE_SET_REMOTE:return s()(e,{remoteParticipants:{[n.participantId]:{streams:{screenStreamId:{$set:n.streamId}}}}});case Ce.SCREEN_SHARE_STARTED:return s()(e,{participant:{streams:{screenStreamId:{$set:n}}}});case Ce.SET_STREAMING_STATE:return Object.assign({},e,{streamingState:n});case Ce.SET_ACCESS_PIN_REQ:return Object.assign({},e,{requiresAccessPin:n});case Ce.SET_CONNECTION_STATE:return Object.assign({},e,{connectionState:n});case Ce.STATS_ROOM:return((e,t)=>{const n={streamStats:{}};try{for(const r in t)if(t.hasOwnProperty(r)){const[i]=cn()(e,`streamStats.${r}`,[]).filter(e=>"stats-qoe"===e.name);n.streamStats[r]=i?{$set:[].concat(t[r],i)}:{$set:t[r]}}return s()(e,n)}catch(t){return e}})(e,n);case Ce.CONNECTION_PARTICIPANT_REMOVED:return s()(e,{remoteParticipants:{$unset:[n]}});case Ce.CONNECTION_STREAM_REMOVED:return((e,t)=>{const n=t.getID(),r={streams:{$unset:[n]}};if(n===cn()(e,"participant.streams.mediaStreamId"))r.participant={streams:{mediaStreamId:{$set:null}}};else for(const t in e.remoteParticipants)if(e.remoteParticipants.hasOwnProperty(t)&&cn()(e,`remoteParticipants.${t}.streams.mediaStreamId`,"")===n){r.remoteParticipants={[t]:{streams:{mediaStreamId:{$set:null}}}};break}return s()(e,r)})(e,n);case Ce.CONNECTION_STREAM_SUBSCRIBED:return s()(e,{streams:{[n.getID()]:{$set:n}}});case Ce.CONNECTION_ADD_PARTICIPANT:return s()(e,{remoteParticipants:{[n.participant._id]:{$set:n.participant}}});case Ce.CONNECTION_ADD_PARTICIPANT_STREAM:return s()(e,{remoteParticipants:{[n.participantId]:{streams:{mediaStreamId:{$set:n.streamId}}}}});case Ce.SET_MEETING_STATE:return localStorage.setItem("partName",n.participants[e.participant._id].name),localStorage.setItem("roomId",e.room.id),Object.assign({},e,n.state,{remoteParticipants:un()(n.participants,e.participant._id),participant:Object.assign({},e.participant,n.participants[e.participant._id]),roomOptions:Object.assign({},e.roomOptions,n.state.roomOptions)});case Ce.MEETING_CHANGE_MODE:return s()(e,{$merge:n.state});case Ce.MEETING_CHANGE_LAYOUT:return s()(e,{$merge:n});case Ce.ROOM_READY:return Object.assign({},e,{isConnected:!0,connectionState:l.CONNECTING});case Ce.LOCAL_STREAM_ADDED:let r=null;return n&&(r=n.getID()),s()(e,{localStreamId:{$set:r},participant:{streams:{mediaStreamId:{$set:r}}},streams:{[r]:{$set:n}}});case Ce.MODERATION_SOCKET_CREATED:return Object.assign({},e,{moderationSocket:n});case Ce.CREATE_CONNECTION_SUCCESS:return Object.assign({},e,{connection:n.connection,connectionState:l.CONNECTING});case Ce.MEETING_SET_MODE:return Object.assign({},e,{mode:n.mode,storyboardId:n.stbId,layoutGeometry:n.mode===c.INTERACTIVE?ln(e.room):e.layoutGeometry,lecturerId:n.mode===c.INTERACTIVE?null:e.participant?e.participant._id:null});case Ce.SET_LECTURE_LAYOUT:return Object.assign({},e,{lectureLayout:n.lectureLayout});case Ce.MEETING_LAYOUT_MODE:return n.layoutMode===d.AUTO?Object.assign({},e,{layoutMode:n.layoutMode,lectureLayout:0}):Object.assign({},e,{layoutMode:n.layoutMode});case Ce.MEETING_SLIDE_NUMBER:case Ce.MEETING_SLIDE_CHANGED:return Object.assign({},e,{slideNumber:n.number});case Ce.UPDATE_LAYOUT_GEOMETRY:return Object.assign({},e,{layoutGeometry:n.geometry});case Ce.UPDATE_LAYOUT_PARTICIPANTS:const i=e.layoutGeometry.optimizedLayoutFullQuality+e.layoutGeometry.optimizedLayoutThreshold,o=e.lecturerId?e.lecturerId:e.participant._id;return Object.assign({},e,{selectedForLecture:fn(n.selectedForLecture||e.selectedForLecture,i,o)});case Ce.UPDATE_PANEL_LAYOUT_PARTICIPANTS:return Object.assign({},e,{selectedForLecture:n.selectedForLecture});case Ce.MUTE_UPDATED:let{participantId:a,mute:u}=n;return Object.assign({},s()(e,{remoteParticipants:{[a]:{status:{mute:{$set:u}}}}}));case Ce.UNMUTE_REQUEST_SENT:const p=e.remoteParticipants[n.participantId];return p?p.unmuteRequest?Object.assign({},s()(e,{remoteParticipants:{[n.participantId]:{status:{unmuteRequest:{$merge:{[n.device]:!0}}}}}})):Object.assign({},s()(e,{remoteParticipants:{[n.participantId]:{status:{$merge:{unmuteRequest:Object.assign({},p.unmuteRequest,{[n.device]:!0})}}}}})):e;case Ce.MODERATOR_UNMUTE_REQUEST:return e.participant.status.unmuteRequest?Object.assign({},s()(e,{participant:{status:{unmuteRequest:{$merge:{[n.device]:!0}}}}})):Object.assign({},s()(e,{participant:{status:{$merge:{unmuteRequest:Object.assign({},e.participant.status.unmuteRequest,{[n.device]:!0})}}}}));case Ce.MODERATOR_UNMUTE_RESPONSE:const f={};return n.device.hasOwnProperty("audio")&&(f.audio=!1),n.device.hasOwnProperty("video")&&(f.video=!1),Object.assign({},s()(e,{remoteParticipants:{[n.senderId]:{status:{unmuteRequest:{$merge:f}}}}}));case Ce.UNMUTE_RESPONSE:return e.participant.status.unmuteRequest?Object.assign({},s()(e,{participant:{status:{unmuteRequest:{$merge:{[n.device]:!1}}}}})):Object.assign({},s()(e,{participant:{status:{$merge:{unmuteRequest:Object.assign(e.participant.status.unmuteRequest,{[n.device]:!1})}}}}));case Ce.SET_MUTE_STATE:return Object.assign({},s()(e,{participant:{status:{$set:Object.assign({},e.participant.status,{mute:n})}}}));case Ce.STATUS_UPDATE:return e.participant.status?s()(e,{participant:{status:{$merge:n}}}):Object.assign({},e,{participant:Object.assign({},e.participant,{status:n})});case Ce.REQUEST_OWNER_PIN:return Object.assign({},e,{requestOwnerPinAction:n.action});case Ce.OWNER_PIN_SUCCESS:case Ce.ROLE_CHANGED:return e.participant._id===n.participantId?s()(e,{participant:{$merge:n.data}}):Object.assign({},s()(e,{remoteParticipants:{[n.participantId]:{$merge:n.data}}}));case Ce.PARTICIPANT_NAME_CHANGED:return e.participant._id===n.participantId?s()(e,{participant:{name:{$set:n.name}}}):Object.assign({},s()(e,{remoteParticipants:{[n.participantId]:{name:{$set:n.name}}}}));case Ce.PARTICIPANT_AVATAR_SET:return e.participant._id===n.participantId?s()(e,{participant:{avatar:{$set:n.avatar}}}):Object.assign({},s()(e,{remoteParticipants:{[n.participantId]:{avatar:{$set:n.avatar}}}}));case Ce.SET_CURRENT_ROOM:return Object.assign({},e,{room:n});case Ce.CREATE_PARTICIPANT_SUCCESS:return Object.assign({},e,{participant:n,participantToken:cn()(n,"token","")});case Ce.CONNECTION_DISCONNECTED:return Object.assign({},e,pn);case Ce.CREATE_PARTICIPANT_ERROR:return Object.assign({},e,{connectionState:n.state});case Ce.ADD_CHAT_MESSAGE:case Ce.SEND_MESSAGE:return Object.assign({},e,{chatLog:[].concat(e.chatLog,n)});case Ce.ADD_TRANSCRIPT_MESSAGE:case Ce.SEND_TRANSCRIPT:const h=((e,{authorId:t,result:n,time:r})=>{const{remoteParticipants:i,participant:o,subtitlesLangs:a}=e;return{author:o&&o._id===t?o:i[t],message:n,time:r,translations:""}})(e,n);return Object.assign({},e,{transcript:[].concat(e.transcript,h)});case Ce.SHARE_TRANSCRIPT:case Ce.RECEIVE_TRANSCRIPT:return mn(e,n);case Ce.RECEIVE_SUBTITLES_REQUEST:case Ce.TURN_ON_SUBTITLES:return e.subtitlesLangs.includes(n.value)?e:Object.assign({},e,{subtitlesLangs:[].concat(e.subtitlesLangs,n.value)});case Ce.RAISE_HAND_REQ:return gn(e,n);case Ce.RAISE_HAND_UPDATE:return vn(e,n);case Ce.RECEIVED_REQUEST_TO_PARTICIPATE:return yn(e,n);case Ce.SET_BFM_PAUSE_STATE:case Ce.BFM_ON_PAUSE:return Object.assign({},e,{bfmPaused:n});default:return e}};const mn=(e,t)=>{const n=cn()(e,"participant._id");if(n){const r=((e,t,n,r)=>{const{subtitles:i,participantId:o}=t,{remoteParticipants:a,participant:{name:s}}=e;let c="",d={};if(o===n)d[o]={subtitles:i,name:s},c=s;else{const e=a[o]&&a[o].name;d[o]={subtitles:i,name:e},c=e}return{subtitles:i,name:c}})(e,t,n);return Object.assign({},e,{subtitles:[].concat(e.subtitles,r)})}return e},yn=(e,t)=>{const{username:n,question:r,id:i}=t.data.params,{participant:{role:o,isRoomOwner:a}}=e;if("Moderator"===o||a){const t=(new Date).getTime(),o=[].concat(e.viewersRequests,{username:n,question:r,time:t,id:i});return Object.assign({},e,{viewersRequests:o})}return e},gn=(e,t)=>{return Object.assign({},e,{participant:Object.assign({},e.participant,{status:Object.assign({},e.participant.status,{handRaised:t})})})},vn=(e,t)=>{const{participantId:n,state:r}=t;return Object.assign({},e,{remoteParticipants:Object.assign({},e.remoteParticipants,{[n]:Object.assign({},e.remoteParticipants[n],{status:Object.assign({},e.remoteParticipants[n].status,{handRaised:r})})})})};var En=n("./sdk/libs/erizo.js"),Sn=n.n(En);function _n(e){if(!e)return"- bps";let t;return e<1e3?t="bps":e<1e6?(t="kbps",e/=1e3):(t="Mbps",e/=1e6),e.toPrecision(3)+" "+t}function Tn(e){return e||0===e?parseFloat(e).toFixed(0)+" ms":""}function bn(e){return e/2>=500?1:e/2>=400?2:e/2>=300?3:e/2>=200?4:5}function Cn(e,t,n){return 8*function(e,t,n){let r=e.stat(n),i=t?t.stat(n):null;return r&&i?(r-i)/(e.timestamp-t.timestamp)*1e3:null}(e,t,n)}class Rn{constructor(e){this.stream=e,this.getRawStats=this.getRawStats.bind(this)}getRawStats(){return new Promise((e,t)=>this.stream.pc?this.stream.pc.peerConnection.getStats().then(t=>{e(t)}):t("invalid stream"))}compute(){let e;return this._rawStats?(this._prevRawStats=this._rawStats,e=Promise.resolve(!0)):e=this.getRawStats().then(e=>{new Promise(t=>{setTimeout(()=>{this._prevRawStats=e,t(!0)},500)})}),e.then(this.getRawStats).then(e=>{this._rawStats=e;let t=[];this.stream.simulcastLayers&&this.stream.simulcastLayers>1&&t.push({label:"Simulcast Layers",name:"stats-simulcast-layers",direction:"tx",value:this.stream.simulcastLayers});let n=0;return e.forEach(e=>{let r,i;if(0===e.id.indexOf("outbound_"))r="tx";else{if(0!==e.id.indexOf("inbound_"))return;r="rx"}let o=e;switch(o.mediaType){case"video":i="Video";break;case"audio":i="Audio"}if(o.roundTripTime&&o.roundTripTime>n&&(n=1e3*o.roundTripTime),o.bitrateMean&&o.bitrateMean>0&&t.push({label:i+" BW",name:"stats-"+o.mediaType+"-bw",direction:r,value:o.bitrateMean,formatted:_n(o.bitrateMean)}),o.bytesSent&&o.bytesSent>0&&"audio"===o.mediaType){let e=function(e,t){let n=e.bytesSent,r=t?t.bytesSent:null;return n&&r?(e.bytesSent-t.bytesSent)/(e.timestamp-t.timestamp)*1e3*8:null}(o,function(e,t,n,r,i){let o;e&&e.forEach(e=>{if(e.type===t&&e.mediaType===n){let t=!0;if(r){let n=e[r];(t=void 0!==i?n===i:n)&&(o=e)}}});return o}(this._prevRawStats,o.type,o.mediaType,"bytesSent"));t.push({label:"Audio BW",name:"stats-audio-bw",direction:r,value:o.bytesSent,formatted:_n(e)})}}),n>0&&(t.unshift({label:"RTT",name:"stats-rtt",value:n,formatted:Tn(n)}),t.unshift({label:"QOE",name:"stats-qoe",value:bn(n)})),t})}}class In{constructor(e){this.stream=e}getRawStats(){return new Promise((e,t)=>{if(!this.stream.pc)return t("invalid stream");this.stream.pc.peerConnection.getStats(t=>e(t.result()))})}compute(){let e;return this._rawStats?(this._prevRawStats=this._rawStats,e=Promise.resolve(!0)):e=this.getRawStats().then(e=>{new Promise(t=>{setTimeout(()=>{this._prevRawStats=e,t(!0)},500)})}),e.then(()=>this.getRawStats()).then(e=>{this._rawStats=e;let t=[],n=function(e,t,n){const r=function(e,t,n){let r=An(e,t,n);return r&&-1!==r.names().indexOf(n)?r.stat(n):null}(e,t,n);if(r){let e=parseInt(r);if(-1!==e)return e}return null}(this._rawStats,"ssrc","googRtt");null!==n&&(t.push({label:"QOE",name:"stats-qoe",value:bn(n)}),t.push({label:"RTT",name:"stats-rtt",value:n,formatted:Tn(n)})),this.stream.simulcastLayers&&this.stream.simulcastLayers>1&&t.push({label:"Simulcast Layers",name:"stats-simulcast-layers",direction:"tx",value:this.stream.simulcastLayers});let r=An(this._rawStats,"ssrc","audioInputLevel"),i=An(this._prevRawStats,"ssrc","audioInputLevel");if(r){let e=r.stat("googCodecName");t.push({label:"Audio Codec",name:"stats-audio-codec",direction:"tx",value:e});let n=Cn(r,i,"bytesSent");n>0&&t.push({label:"Audio BW",name:"stats-audio-bw",direction:"tx",value:n,formatted:_n(n)})}let o=An(this._rawStats,"ssrc","audioOutputLevel"),a=An(this._prevRawStats,"ssrc","audioOutputLevel");if(o){let e=o.stat("googCodecName");t.push({label:"Audio Codec",name:"stats-audio-codec",direction:"rx",value:e});let n=Cn(o,a,"bytesReceived");n>0&&t.push({label:"Audio BW",name:"stats-audio-bw",direction:"rx",value:n,formatted:_n(n)});let r=o.stat("googCurrentDelayMs");t.push({label:"Audio Delay",name:"stats-audio-delay",direction:"rx",value:r,formatted:Tn(r)})}let s=An(this._rawStats,"ssrc","googFirsReceived"),c=An(this._prevRawStats,"ssrc","googFirsReceived");if(s){let e=s.stat("googCodecName");t.push({label:"Video Codec",name:"stats-video-codec",direction:"tx",value:e});let n=s.stat("googFrameHeightSent"),r=s.stat("googFrameRateSent");t.push({label:"Video Resolution",name:"stats-video-resolution",direction:"tx",value:n+"p"+r});let i=Cn(s,c,"bytesSent");i>0&&t.push({label:"Video BW",name:"stats-video-bw",direction:"tx",value:i,formatted:_n(i)})}let d=An(this._rawStats,"ssrc","googFirsSent"),u=An(this._prevRawStats,"ssrc","googFirsSent");if(d){let e=d.stat("googCodecName");t.push({label:"Video Codec",name:"stats-video-codec",direction:"rx",value:e});let n=d.stat("googFrameHeightReceived"),r=d.stat("googFrameRateDecoded");t.push({label:"Video Resolution",name:"stats-video-resolution",direction:"rx",value:n+"p"+r});let i=Cn(d,u,"bytesReceived");i>0&&t.push({label:"Video BW",name:"stats-video-bw",direction:"rx",value:i,formatted:_n(i)});let o=d.stat("googCurrentDelayMs");t.push({label:"Video Delay",name:"stats-video-delay",direction:"rx",value:o,formatted:Tn(o)})}return t})}}function An(e,t,n,r){if(e)for(let i=0;i<e.length;++i){let o=e[i];if(o.type===t){let e=!0;if(n){let t="id"===n?o.id:o.stat(n);e=void 0!==r?t===r:t}if(e)return o}}}function On(e){if(On._instances||(On._instances={}),!e)return Promise.reject("stream is null");let t=On._instances[e.getID()];return t?t.stream.pc||(t.stream=e):(t=window.chrome?new In(e):new Rn(e),On._instances[e.getID()]=t),t.compute()}function*Pn(){const e=yield re(Ne),t=yield re(we),n=yield re(Ae),r={};if(cn()(n,"streams.mediaStreamId")){const e=t[n.streams.mediaStreamId];r[n._id]=e?yield On(e).catch(function(e){return console.log("# err",e),[]}):[];const i={qoe:0,videoResolution:0,bandwidth:0};r[n._id].forEach(e=>{switch(e.name){case"stats-qoe":i.qoe=e.value;break;case"stats-video-resolution":i.videoResolution=e.value;break;case"stats-video-bw":i.bandwidth=e.value;break;case"stats-audio-codec":i.audioCodec=e.value;break;case"stats-video-codec":i.videoCodec=e.value}}),yield et(Ze.stats,i)}for(const n in e){const i=cn()(e,`${n}.streams.mediaStreamId`);if(e.hasOwnProperty(n)&&i){const e=t[i];r[n]=e?yield On(e).catch(function(e){return console.log("# err",e),[]}):[]}}yield K(Yt.roomStats(r))}const wn={ROOM_CONNECTED:"room-connected",STREAM_ADDED:"stream-added",STREAM_SUBSCRIBED:"stream-subscribed",STREAM_REMOVED:"stream-removed",ROOM_ERROR:"room-error",ROOM_DISCONNECTED:"room-disconnected"},Nn=e=>{let t;if(e){const{optimized_layout_full_quality:n,optimized_layout_threshold:r}=e;t=Object.assign({},f.default.geometry,{optimized_layout_full_quality:isNaN(n)?1:parseInt(n),optimized_layout_threshold:isNaN(r)?1:parseInt(r)})}else t=Object.assign({},f.default.geometry);return{optimizedLayoutFullQuality:t.optimized_layout_full_quality,optimizedLayoutThreshold:t.optimized_layout_threshold}};function*Dn(){const{room:e,globalConfigs:t,lectureLayout:n,mode:r,layoutMode:i}=yield re(He),o=isNaN(t.optimized_layout_full_quality)?1:parseInt(t.optimized_layout_full_quality),a=isNaN(t.optimized_layout_threshold)?1:parseInt(t.optimized_layout_threshold),s=Object.assign({optimizedLayoutFullQuality:o,optimizedLayoutThreshold:a},Nn(e));return r!==c.BASIC_LECTURE&&!n||i!==d.MANUAL?s:{optimizedLayoutFullQuality:f[n]?f[n].geometry.optimized_layout_full_quality:s.optimizedLayoutFullQuality,optimizedLayoutThreshold:f[n]?f[n].geometry.optimized_layout_threshold:s.optimizedLayoutThreshold}}function*kn(){const e=yield Dn();yield K(Yt.updateLayoutGeometry(e)),yield K(Yt.updateLayoutParticipants()),yield k(500),yield K(Yt.sendMeetingLayout())}function*Mn(){const e=yield re(je);if(e===c.BASIC_LECTURE||e===c.LECTURE){const e=yield re($e);yield et(Ze.setLayout,e)}yield}function*xn(){if(yield re(Ae)){const e=yield Dn();yield K(Yt.updateLayoutGeometry(e)),yield K(Yt.updateLayoutParticipants());const t=yield re(We);yield et(Ze.setMode,t)}}function*Ln({payload:e}){const t=yield re(We),n=yield re(Ae);let r=null,i=null;if(t.lecturerId&&t.lecturerId!==n._id)return yield;const o=t.selectedForLecture[e.tileId],a=t.selectedForLecture.indexOf(e.participantId);if(o===n._id&&(-1===a||"stub"===e.participantId))return yield;"stub"===o||-1!==a&&"stub"!==e.participantId||(r=o),-1===a&&(i=e.participantId),-1!==a&&"stub"!==e.participantId&&(t.selectedForLecture[a]=o),t.selectedForLecture[e.tileId]=e.participantId,yield K(Yt.updateLayoutParticipants(t.selectedForLecture)),t.mode===c.BASIC_LECTURE&&(r&&(yield et(Ze.mute,n._id,r,{audio:!0,video:!0})),i&&(yield et(Ze.mute,n._id,i,{audio:!1,video:!1}))),yield K(Yt.sendMeetingLayout())}function*Un({payload:{selectedForLecture:e}}){const t=yield re(We),n=yield re(Ae);yield K(Yt.updatePanelLayoutParticipants(e)),t.mode===c.LECTURE&&(yield e.map(e=>et(Ze.mute,n._id,e,{audio:!1,video:!1})))}function*jn({payload:e}){let t=[];const n=yield re(Ae),r=yield re(Ne),i=yield Dn();t.push(K(Yt.updateLayoutGeometry(i))),Object.keys(e.mutedState).forEach(i=>{n._id!==i?JSON.stringify(r[i].status.mute)!==JSON.stringify(e.mutedState[i])&&t.push(K(Yt.participantMuteUpdate(i,e.mutedState[i]))):JSON.stringify(n.status.mute)!==JSON.stringify(e.mutedState[i])&&t.push(K(Yt.mute(e.mutedState[i])))}),yield X(t)}function*Bn({payload:e}){if(e.state.mode===c.LECTURE&&e.state.storyboardId){const t=yield re(ze);t.storyboard&&t.storyboard._id!==e.state.storyboardId&&0!==t.slidenumber&&(yield K(Yt.setSlideNumber(0))),yield K(Je.storyboardFetch(e.state.storyboardId))}yield}function*Vn(){const e=yield Dn();yield K(Yt.updateLayoutGeometry(e))}function*Gn({payload:{number:e}}){yield et(Ze.setSlide,e)}function*Fn(){yield be(Ce.SET_LECTURE_LAYOUT,kn),yield be(Ce.MEETING_LAYOUT_MODE,kn),yield be(Ce.CREATE_PARTICIPANT_SUCCESS,kn),yield be(Ce.MEETING_CHANGE_LAYOUT,Vn),yield be(Ce.MEETING_SET_MODE,xn),yield be(Ce.MEETING_CHANGE_MODE,jn),yield be(Ce.MEETING_CHANGE_MODE,Bn),yield be(Ce.SELECT_FOR_LECTURE,Ln),yield be(Ce.SELECT_FOR_PANEL_MODE,Un),yield be(Ce.MEETING_SEND_LAYOUT,Mn),yield be(Ce.SET_MEETING_STATE,Bn),yield be(Ce.MEETING_SLIDE_NUMBER,Gn)}function*qn(){yield Te(Ce.MUTE_ALL,function*({state:e}){let t=yield re(Pe);e.audio&&(t.audio=Object.assign(t.audio,e.audio)),e.video&&(t.video=Object.assign(t.video,e.video)),yield K(Yt.setMuteState(t)),yield K(Yt.muteStream()),yield et(Ze.muteUpdate,t)}),yield Te(Ce.MUTE_AUDIO,function*({state:e}){const t=yield re(Pe);let n;n=typeof e==typeof!0?Object.assign(t,{audio:Object.assign(t.audio,{state:e})}):Object.assign(t,{audio:Object.assign(t.audio,e)}),yield K(Yt.mute(n))}),yield Te(Ce.MUTE_VIDEO,function*({state:e}){const t=yield re(Pe);let n;n=typeof e==typeof!0?Object.assign(t,{video:Object.assign(t.video,{state:e})}):Object.assign(t,{video:Object.assign(t.video,e)}),yield K(Yt.mute(n))}),yield Te(Ce.REMOTE_MUTE,function*({participantId:e,device:t,state:n}){const r=yield re(Ae);n?yield et(Ze.mute,r._id,e,{[t]:n}):yield X([K(Yt.unmuteRequestSent(e,t)),et(Ze.unmuteRequest,r._id,e,{[t]:n})])}),yield Te(Ce.UNMUTE_RESPONSE,function*({payload:{device:e,senderId:t}}){const n=yield re(Ae);e.hasOwnProperty(Re.AUDIO)&&e[Re.AUDIO]&&(yield K(Yt.muteAudio({state:!1,byModerator:!1}))),e.hasOwnProperty(Re.VIDEO)&&e[Re.VIDEO]&&(yield K(Yt.muteVideo({state:!1,byModerator:!1}))),yield et(Ze.unmuteResponse,t,n._id,e)}),yield Te(Ce.MUTE_STREAM,function*(){const e=yield re(Ae);if(e&&e.streams&&e.streams.mediaStreamId){const t=yield re(we);if(t){const n=t[e.streams.mediaStreamId];if(n){const{audio:t,video:r}=e.status.mute,i=!t||t.state||t.byModerator,o=!r||r.state||r.byModerator;n.stream&&n.stream.getTracks().forEach(e=>{"audio"===e.kind?e.enabled=!i:"video"===e.kind&&(e.enabled=!o)}),n.hasAudio()&&(n.muteAudio(i,()=>{n.hasVideo()&&n.muteVideo(o)}),n.stream&&n.stream.getAudioTracks().forEach(e=>{e.enabled=!i}),n.hasVideo()&&n.muteVideo(o))}}}})}function*zn(){yield Te(Ce.SEND_MESSAGE,function*({payload:e}){e&&(yield et(Ze.chat,e))})}function*Hn(){yield Te(Ce.SEND_TRANSCRIPT,function*({payload:e}){e&&(yield et(Ze.sendTranscript,e))})}function*Wn(){yield Te(Ce.SHARE_TRANSCRIPT,function*({payload:e}){e&&(yield et(Ze.shareTranscript,e))})}function*$n(){yield Te(Ce.BFM_ON_PAUSE,function*({payload:e}){yield et(Ze.bfmOnPause,e)})}function*Qn(){yield Te(Ce.TURN_ON_SUBTITLES,function*({payload:e}){e&&(yield et(Ze.turnOnSubtitles,e))})}function*Yn(){yield Te(o.LOGIN_SUCCESS,function*(){const e=yield re(qe);yield et(Ze.getRole,e.token)}),yield Te(o.LOGOUT,function*(){yield et(Ze.getRole,null)}),yield Te(Ce.SET_OWNER_PIN,function*({pin:e}){yield et(Ze.setOwnerPin,e)}),yield Te(Ce.PARTICIPANT_NAME_CHANGED,function*({payload:{participantId:e,name:t}}){const n=yield re(Ae);e&&n._id===e&&(yield et(Ze.changeParticipantName,e,t))}),yield Te(Ce.KICK_PARTICIPANT,function*({roomId:e,participantId:t}){yield et(Ze.kickParticipant,e,t)})}function*Jn(){yield Te(Ce.LOCAL_STREAM_ADDED,function*({payload:e}){e&&(yield K(Yt.muteStream()),yield et(Ze.publishStream,e.getID()))})}function*Kn(){yield Te(Ce.RAISE_HAND_REQ,function*({payload:e}){yield et(Ze.raiseHand,!!e)})}function*Xn(){yield Te(Ce.RAISE_HAND_RES,function*({payload:e}){if(e.accepted){const t=yield re(Ae);yield X([et(Ze.raiseHandAccept,e.id),et(Ze.mute,t._id,e.id,{audio:!1,video:!1})])}else yield et(Ze.raiseHandDecline,e.id)})}function*Zn(){yield Te(Ce.SCREEN_SHARE_STARTED,function*({payload:e}){e&&(yield K(Yt.muteStream()),yield et(Ze.publishScreenStream,e))})}function*er({payload:e}){const t=yield re(Ae),n=yield re(Ne);for(const r in e)e.hasOwnProperty(r)&&(t._id!==r||t.avatar?n.hasOwnProperty(r)&&!n[r].avatar&&(yield K(Yt.getAvatar(r))):yield K(Yt.getAvatar(t._id)))}function*tr(){yield Te(Ce.STATS_PARTICIPANT,er)}function*nr(){yield Te(Ce.SEND_SIP_STATE,rr)}function*rr({payload:{sipUri:e,room:t,state:n}}){yield K(Yt.setSipState({sipUri:e,room:t,state:n})),yield et(Ze.sendToSip,e,t,n)}function*ir(){yield Te(Ce.PARTICIPANT_AVATAR_GET,function*({participantId:e}){const t=yield re(Qe,e);if(t){const n=ot(t);n&&(yield K(Yt.setAvatar(e,n)))}})}function*or(e){yield Te(Ce.CONNECTION_DISCONNECT,()=>{e.close();try{AndroidJSInterface&&AndroidJSInterface.disconnect()}catch(e){}}),yield Te(e,function*(e){if(!e||"web"!==e.type)return void console.error("Missing or malformed message");let t=Yt.noop();switch(e.data.method){case Ke.READY:t=Yt.moderationServerReady();break;case Ke.MEETING_STATE:t=Yt.setMeetingState(e.data.params);break;case Ke.MEETING_SET_MODE:t=Yt.setMeetingMode(e.data.params);break;case Ke.LECTURE_LAYOUT:t=Yt.setMeetingLayout(e.data.params);break;case Ke.LECTURE_SLIDE_NUMBER:t=Yt.slideNumberChanged(e.data.params.number);break;case Ke.PARTICIPANT_ADDED:t=Yt.addParticipant(e.data.params);break;case Ke.PARTICIPANT_PUBLISHED:t=Yt.addParticipantStream(e.data.params);break;case Ke.PARTICIPANT_NAME_CHANGED:t=Yt.changeParticipantName(e.data.params.participantId,e.data.params.name);break;case Ke.PARTICIPANT_REMOVED:t=Yt.removeParticipant(e.data.params.participantId);break;case Ke.DISCONNECT:t=Yt.disconnect();break;case Ke.MUTE_UPDATE:(yield re(Ae))._id!==e.data.params.participantId&&(t=Yt.participantMuteUpdate(e.data.params.participantId,e.data.params.mute));break;case Ke.MUTE:const n=e.data.params.state;n.hasOwnProperty("audio")&&n.hasOwnProperty("video")?t=Yt.mute({audio:{byModerator:n.audio},video:{byModerator:n.video}}):n.hasOwnProperty("audio")?t=Yt.muteAudio({byModerator:n.audio}):n.hasOwnProperty("video")&&(t=Yt.muteVideo({byModerator:n.video}));break;case Ke.UNMUTE_REQUEST:e.data.params.state.hasOwnProperty("audio")&&(t=Yt.moderatorUnmuteRequest(e.data.params.senderId,"audio")),e.data.params.state.hasOwnProperty("video")&&(t=Yt.moderatorUnmuteRequest(e.data.params.senderId,"video"));break;case Ke.UNMUTE_RESPONSE:t=Yt.moderatorUnmuteResponse(e.data.params.senderId,e.data.params.state);break;case Ke.OWNER_PIN_SUCCESS:t=Yt.ownerPinSuccess(e.data.params.participantId,e.data.params.role,e.data.params.isRoomOwner);break;case Ke.OWNER_PIN_FAILED:t=Yt.ownerPinFailed(e.data.params);break;case Ke.ROLE_CHANGED:t=Yt.roleChanged(e.data.params.participantId,e.data.params.role,e.data.params.isRoomOwner);break;case Ke.CHAT:(yield re(Ae))._id!==e.data.params.authorId&&(t=Yt.addChatMessage(e.data.params));break;case Ke.SEND_TRANSCRIPT:(yield re(Ae))._id!==e.data.params.authorId&&(t=Yt.addTranscriptMessage(e.data.params));break;case Ke.SHARE_TRANSCRIPT:(yield re(Ae))._id!==e.data.params.participantId&&(t=Yt.receiveTranscript(e.data.params));break;case Ke.TURN_ON_SUBTITLES:(yield re(Ae))._id!==e.data.params.participantId&&(t=Yt.receiveSubtitlesRequest(e.data.params));break;case Ke.RAISE_HAND_UPDATE:(yield re(Ae))._id!==e.data.params.participantId&&(t=Yt.raiseHandUpdate(e.data.params));break;case Ke.RAISE_HAND_RES:t=Yt.raiseHandRequest(!1);break;case Ke.STREAMING_STATE:t=Yt.setStreamingState(e.data.params.newState);break;case Ke.PARTICIPANT_SHARES:t=Yt.setRemoteScreenStream(e.data.params.streamId,e.data.params.participantId);break;case Ke.SHARING_STOP:t=Yt.stopSharing();break;case Ke.STATS_UPDATE:t=Yt.updateStats(e.data.params.stats);break;case Ke.RECEIVE_REQUEST_TO_PARTICIPATE:t=Yt.receivedRequestToParticipate(e);break;case Ke.SIP_CALL_STATE:t=yield function*(e){const{sipUri:t,state:n,message:r}=e,{sipUri:i}=yield re(Fe);if(t!==i)return Yt.noop();n===p.ACCEPTED&&(yield K(Je.generalInfo("sip-call-accepted")));n===p.REJECTED&&(r?yield K(Je.generalWarning({message:"sip-call-rejected-ext",args:{message:r}})):yield K(Je.generalWarning("sip-call-rejected")));return Yt.setSipState(e)}(e.data.params);break;case Ke.BFM_ON_PAUSE:t=Yt.setBfmPauseState(e.data.params)}yield K(t)})}function*ar(){yield X([Zn(),Jn(),Fn(),qn(),Yn(),zn(),Hn(),Wn(),Qn(),Kn(),Xn(),ir(),tr(),nr(),$n()])}const sr=(e,t)=>localStorage.setItem(e,t);let cr=null,dr=null;function*ur(){let e;for(;;){const t=yield J([Ce.CREATE_PARTICIPANT,Ce.CONNECTION_CANCEL,Ce.CONNECTION_DISCONNECTED]),{connectionState:n}=yield re(e=>e.teevid.meeting);t.type===Ce.CONNECTION_CANCEL||t.type===Ce.CONNECTION_DISCONNECTED?(e&&(yield e.cancel(),e=null,cr&&(yield cr.cancel(),cr=null),dr&&(yield dr.cancel(),dr=null)),yield K(Yt.setConnectionState(l.DISCONNECTED))):(n===l.IN_WAITING_ROOM&&(e&&(yield ne(e)),yield K(Yt.setConnectionState(l.CONNECTING)),e=yield te(lr,t.payload)),e||n===l.CONNECTING||(yield K(Yt.setConnectionState(l.CONNECTING)),e=yield te(lr,t.payload)))}}function*lr({username:e,pin:t,room:n}){yield re(Ge);try{const r=yield ee(pr,{username:e,pin:t,roomId:n});yield K(Yt.setCurrentRoom(r.room)),yield K(Yt.participantCreated(r))}catch(e){console.log("Error creating participant: ",e.message);const t=[K(Yt.connectionCancel())];"err-bad-pin"===e.message||("token-expired-error"===e.message?t.push(K(Vt.logout())):t.push(K(Yt.connectionError(e)))),yield X(t)}}function*pr({username:e,pin:t,roomId:n}){for(;;)try{const{payload:r}=yield ee(nt,"post",`/rooms/${n}/participants/`,{username:e,pin:t});return r}catch(e){switch(e.code){case 412:const t=[K(Yt.setAccessPinRequirement(!1))];"no-slots-error"===e.message?t.unshift(K(Yt.setConnectionState(l.IN_WAITING_SLOT))):t.unshift(K(Yt.setConnectionState(l.IN_WAITING_ROOM))),yield X(t),yield ee(k,2e3);break;case 401:throw-1===["license-error-invalid","license-error-missing"].indexOf(e.message)&&(yield K(Yt.setAccessPinRequirement(!0))),e;default:throw e}}}function fr(e){const t=["room-connected","stream-added","stream-subscribed","stream-removed","room-error","room-disconnected"];return Ee(n=>{return t.forEach(t=>{e.addEventListener(t,function(e,t){n({type:e,event:t})}.bind(null,t))}),()=>{e.disconnect()}})}function*hr(e){yield Te(Ce.CONNECTION_DISCONNECT,()=>{e.close()}),yield Te(e,function*(e){let t=Yt.noop();switch(e.type){case wn.ROOM_CONNECTED:t=Yt.roomConnected();break;case wn.STREAM_ADDED:t=Yt.streamAdded(e.event.stream);break;case wn.STREAM_SUBSCRIBED:t=Yt.streamSubscribed(e.event.stream);break;case wn.STREAM_REMOVED:t=Yt.streamRemoved(e.event.stream);break;case wn.ROOM_DISCONNECTED:t=Yt.disconnected()}yield K(t)})}function*mr(){yield Te(Ce.CONNECT,function*(e){const t=yield re(xe),n=yield re(Ae),r=yield re(Le),i=yield function(){let e={audio:!1,video:!1};return navigator.mediaDevices.enumerateDevices().then(t=>{const n=t.filter(e=>"audioinput"===e.kind),r=t.filter(e=>"videoinput"===e.kind),i=Boolean(n.length);let o=Boolean(i&&r.length);return e=i&&o?{audio:!0,video:!0}:i&&!o?{audio:!0,video:!1}:o&&n.length?{audio:!0,video:!0}:{audio:!1,video:!1},sr("options",JSON.stringify(e)),e}).catch(e=>console.log(e))}();yield K(Je.refreshCurrentMediaDevices(i)),yield K(Yt.statusChanged({hasMic:i.audio,hasCam:i.video}));const o=`wss://${t}/socket/moderation?token=${encodeURIComponent(n.token)}`,a=new WebSocket(o);a.onclose=(e=>{console.info("Moderation Socket closed",e),TeeVidSdk.actions.disconnect()});const s=function(e,t){return Ee(n=>(e.onerror=(n=>{if(2===t.state)return e.onclose(null)}),e.onmessage=(t=>{var r=t.data;"_"===r?e.send(r):(r=JSON.parse(r),n(r))}),()=>{e.close()}))}(a,r),c=fr(r);yield K(Yt.moderationSocketCreated(a)),dr=yield te(or,s),cr=yield te(hr,c)}),yield Te(Ce.MODERATION_SERVER_READY,function*(){const e=yield re(Ae),t=yield re(We);e.role===Ie.MODERATOR&&t.storyboardId&&!t.lecturerId&&t.mode===c.LECTURE?yield et(Ze.participantReady,e,t):yield et(Ze.participantReady,e)})}function*yr(){yield Te(Ce.CREATE_CONNECTION,function*(){const e=yield re(Ae),t=yield re(De),n=yield re(Me),r={token:e.nuveId},i=Sn.a.Room(r),o=i.publish;i.publish=function(r,a,s){if((a=a||{}).scheme="notify-break-recover",r.hasVideo()){let e=0;e="auto"===t.simulcastLayers?parseInt(n.simulcast_layers,10):parseInt(t.simulcastLayers,10),r.simulcastLayers=e,e>1&&window.chrome&&(a.simulcast={numSpatialLayers:e},r.simulcastLayers=e)}var c=r.getAttributes()||{};return c.participantId=e._id,c.username=e.name,r.updateLocalAttributes(c),o.apply(i,[r,a,s])},yield K(Yt.connectionCreated(i))})}function*gr(){yield Te(Ce.SET_MEETING_STATE,function*(){yield K(Yt.connectionReady())})}function*vr(){yield Te(Ce.ROOM_CONNECTED,function*(){const e=yield re(Le);e.remoteStreams.forEach(t=>{t.local||(it(t),e.subscribe(t))}),yield K(Yt.connectionRoomReady());const t=yield te(Er);yield J("stop-timer"),yield ne(t)})}function*Er(){for(;;){(yield re(Ae))||(yield K({type:"stop-timer"})),yield Pn(),yield k(3e3)}}function*Sr(){yield Te(Ce.CONNECTION_STREAM_ADDED,function*({payload:e}){const t=yield re(Le);e.local||(it(e),t.subscribe(e))})}function*_r(){yield Te(Ce.CONNECTION_STREAM_REMOVED,function*({payload:e}){(yield re(Ae)).streams.mediaStreamId===e.getID()&&(yield et(Ze.streamRemoved,e.streamID()))})}function*Tr(){yield X([mr(),ur(),yr(),gr(),vr(),Sr(),_r()])}function*br(){yield Te(Ce.STREAMING_START,function*(){try{const e=yield re(ke),t=yield re(De);e.enabledStreaming&&(yield X([ee(rt,"POST","/media/start",{room:t.id}),K(Yt.setStreamingState(u.INIT))]))}catch(e){}})}function*Cr(){yield Te(Ce.STREAMING_STOP,function*(){try{const e=yield re(De);yield X([ee(rt,"POST","/media/stop",{room:e.id}),K(Yt.setStreamingState(u.STOPPING))])}catch(e){console.error(e)}})}function*Rr(){yield X([Cr(),br()])}function*Ir(){yield}function*Ar(){yield X([Ir(),Tr(),ar(),Rr()])}var Or=n("./node_modules/lodash-es/_freeGlobal.js"),Pr="object"==typeof self&&self&&self.Object===Object&&self,wr=(Or.a||Pr||Function("return this")()).Symbol,Nr=Object.prototype;Nr.hasOwnProperty,Nr.toString,wr&&wr.toStringTag;Object.prototype.toString;wr&&wr.toStringTag;Object.getPrototypeOf,Object;var Dr=Function.prototype,kr=Object.prototype,Mr=Dr.toString;kr.hasOwnProperty,Mr.call(Object);n("./node_modules/symbol-observable/es/index.js");var xr={INIT:"@@redux/INIT"};function Lr(e,t){var n=t&&t.type;return"Given action "+(n&&'"'+n.toString()+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function Ur(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var i=t[r];0,"function"==typeof e[i]&&(n[i]=e[i])}var o=Object.keys(n);var a=void 0;try{!function(e){Object.keys(e).forEach(function(t){var n=e[t];if(void 0===n(void 0,{type:xr.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===n(void 0,{type:"@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".")}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+xr.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(n)}catch(e){a=e}return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];if(a)throw a;for(var r=!1,i={},s=0;s<o.length;s++){var c=o[s],d=n[c],u=e[c],l=d(u,t);if(void 0===l){var p=Lr(c,t);throw new Error(p)}i[c]=l,r=r||l!==u}return r?i:e}}function jr(e,t){return function(){return t(e.apply(void 0,arguments))}}Object.assign;n.d(t,"actionTypes",function(){return Br}),n.d(t,"actions",function(){return Vr}),n.d(t,"moderationActions",function(){return Gr});const Br=Object.assign({},r,o,Ce,zt),Vr=Object.assign({},Je,Vt,Yt,Qt),Gr=Ze;const Fr=new class{constructor(e=3){Sn.a.Logger.setLogLevel(e),window.TeeVidSdk=this}getStream(e){const{remoteParticipants:t,streams:n}=this.store.getState().teevid.meeting,r=cn()(t,`${e}.streams.mediaStreamId`,null);return r?cn()(n,r,null):null}get localStream(){const{participant:e,streams:t,connectionState:n}=this.store.getState().teevid.meeting;if(n===l.DISCONNECTED)return null;const r=cn()(e,"streams.mediaStreamId",null);return r?cn()(t,r,null):null}get presenterStream(){const{lecturerId:e,participant:t,streams:n,remoteParticipants:r,connectionState:i}=this.store.getState().teevid.meeting;if(i===l.DISCONNECTED)return null;if(!e)return null;if(t&&t._id===e)return this.localStream;const o=r[e];if(o){const e=cn()(o,"streams.mediaStreamId",null);if(e)return cn()(n,e,null)}return null}get actionTypes(){return Br}get logo(){const{serverUrl:e}=this.store.getState().teevid.user;return`https://${e}/api/v1/system/logo`}get reducer(){return Ur({api:y,user:Bt,meeting:hn,viewer:$t})}get saga(){return function*(){yield X([Ut(),qt(),Ar(),an()])}}get profile(){if(this.store){const e=this.store.getState();return cn()(e,"teevid.user.profile",null)}return null}get userToken(){if(this.store){const e=this.store.getState();return cn()(e,"teevid.user.userToken",null)}return null}get remoteStreams(){const e=this.store.getState().teevid.meeting.connection,t={};return e&&e.remoteStreams&&e.remoteStreams.forEach(e=>{e.local||(t[e.getID()]=e)}),t}sendModerationMessage(e){const t=this.store.getState(),n=cn()(t,"teevid.meeting.moderationSocket"),r=cn()(t,"teevid.meeting.participantToken");if(!n||!r||1!==n.readyState)throw new Error({message:"error-connect-socket"});e.token=r,n.send(JSON.stringify(e))}isCurrentParticipant(e){return e===cn()(this.store.getState(),"teevid.meeting.participant._id",null)}get canModerate(){const e=this.store.getState(),t=cn()(e,"teevid.meeting.participant.role",null);return-1!==[Ie.MODERATOR,Ie.OWNER].indexOf(t)}get isRoomOwner(){const e=this.store.getState();return cn()(e,"teevid.meeting.participant.isRoomOwner",!1)}hasOwnerPin(){const e=this.store.getState();return cn()(e,"teevid.meeting.roomOptions.hasOwnerPin",!1)}Stream(e,t){const n=Sn.a.UnboundStream(t,e),r=n.getAttributes()||{};return n.updateLocalAttributes(r),it(n),n.setAttribute=function(e,t){const r=n.getAttributes()||{};return r[e]!==t&&(r[e]=t,n.setAttributes(r)),r},n}get serverUrl(){const{serverUrl:e}=this.store.getState().teevid.user;return e}verifyDeveloperKey(){}init(e,t){this.store=t,this.actions=function(e,t){if("function"==typeof e)return jr(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var n=Object.keys(e),r={},i=0;i<n.length;i++){var o=n[i],a=e[o];"function"==typeof a&&(r[o]=jr(a,t))}return r}(Vr,t.dispatch),this.cleanActions=Vr,this.actions.setServerUrl(e),this.actions.refreshMediaDevices(),tt(e,null,"get","/system/configurations/public").then(e=>{this.actions.setGlobalConfig(e.payload)})}login(e,t){this.actions.login(e,t)}_call(e,t,n,r){const{serverUrl:i,userToken:o}=this.store.getState().teevid.user;let a=o;if(!a){const{participantToken:e}=this.store.getState().teevid.meeting;a=e}return tt(i,a,e,t,n).then(e=>{if(r)return e;if(e.token){const t=at(e.token);["Participant","Moderator"].includes(t.role)||this.actions.updateToken(e.token)}return e.payload})}prepareUploadOptions(e){const t=new FormData;t.append("file",e);const n={method:"POST",headers:{Accept:"application/json","cache-control":"no-store"},body:t},{userToken:r}=this.store.getState().teevid.user;return r&&(n.headers.Authorization="Bearer "+r),n}_upload(e,t){const{serverUrl:n}=this.store.getState().teevid.user;if(t){const r=this.prepareUploadOptions(t);return fetch(`https://${n}/api/v1${e}`,r)}return Promise.resolve(!1)}get translator(){return{languages:()=>rt("get","/translator/languages"),translate:(e,t,n)=>{if(!t||!n)throw Error("400 Bad Request");return this._call("post",`/translator/?from=${encodeURIComponent(e||"")}&to=${encodeURIComponent(t)}`,{message:n})}}}get configuration(){return this.filterDevices=((e=[],t="videoinput")=>e.filter(e=>e.kind===t)),this.configuration={_items:!1},{get:()=>this._call("get","/systems/configurations/public").then(e=>(this.configuration._items={},e.forEach(e=>this.configuration._items[e._id]=e.value),this.configuration._items)),getMcuVersion:()=>this._call("get","/system/version"),listMediaDevices:()=>navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(e=>{const t=this.filterDevices(e,"videoinput");return{audioIn:this.filterDevices(e,"audioinput"),videoIn:t,audioOut:this.filterDevices(e,"audiooutput")}}):Promise.resolve({audioIn:[],videoIn:[],audioOut:[]}),listVideoInputs:()=>navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(e=>this.filterDevices(e,"videoinput")):Promise.resolve([]),listAudioInputs:()=>navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(e=>this.filterDevices(e,"audioinput")):Promise.resolve([]),listAudioOutputs:()=>navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then(e=>this.filterDevices(e,"audiooutput")):Promise.resolve([])}}get user(){return{guest:()=>this._call("get","/token/guest",null,!0).then(({payload:e,token:t})=>(this.actions.loginSuccess(e,t),e)),editProfile:e=>this._call("patch","/users/me",e),refreshProfile:()=>this._call("get","/users/me").then(e=>(e&&this.actions.setProfile(e),e)),setAvatar:e=>this._upload("/users/avatar",e),requestPasswordRecovery:e=>this._call("post","/users/password-recovery",{email:e}),resetPassword:(e,t)=>this._call("post","/users/password-reset",{recoveryToken:e,password:t,type:"password-recovery"}),editPersonalRoom:e=>{if(this.profile&&this.profile.room)return this._call("patch","/rooms/my",e);throw Error("You don't have a personal room")}}}get media(){return{requestStats:e=>{if(!e)throw Error("You have to provide server ID");return this._call("get",`/media/stats/${e}`)},getServers:()=>this._call("get","/media/servers"),getServer:e=>this._call("get",`/media/server/${e}`),checkStatus:e=>this._call("get",`/media/check/${e}`),startStreaming:e=>{if(!e)throw Error("You must provide proper server and room IDs");return this._call("post",`/media/start/${e}`)},stopStreaming:e=>{if(!e)throw Error("You must provide proper room ID");return this._call("post","/media/stop",{room:e})},startRecording(e,t){if(!e)throw Error("You must provide proper room ID");return this._call("post","/record/start",{room:e,recordPath:t})},stopRecording(e){if(!e)throw Error("You must provide proper room ID");return this._call("post","/record/stop",{room:e})},callSip:(e,t)=>this._call("post","/media/call",{room:e,to:t})}}get users(){return{list:()=>this._call("get","/users"),create:e=>this._call("post","/users",e),edit:(e,t)=>{if(!e)throw Error("User does not exist");return this._call("patch",`/users/${encodeURIComponent(e)}`,t)},remove:e=>this._call("delete",`/users/${encodeURIComponent(e)}`),changePassword:e=>this._call("put",`/users/${encodeURIComponent(e.name)}/password`,e),deleteChosen:e=>this._call("post","/users/remove",e)}}get storyboards(){return{list:()=>this._call("get","/storyboard"),get:e=>{if(!e)throw Error("Storyboard does not exist");return this._call("get",`/storyboard/${encodeURIComponent(e)}`)},listThemes:()=>this._call("get","/themes"),edit:(e,t)=>{if(!e)throw Error("Storyboard does not exist");return this._call("post",`/storyboard/${encodeURIComponent(e)}`,t)},clone:e=>{if(!e)throw Error("Storyboard does not exist");return this._call("patch",`/storyboard/${encodeURIComponent(e)}/clone`)},remove:e=>{if(!e)throw Error("Storyboard does not exist");return this._call("delete",`/storyboard/${encodeURIComponent(e)}`)},getLayouts:()=>this._call("get","/layouts"),create:e=>this._call("post","/storyboard",e),upload:e=>this._upload("/upload",e),uploadWithProgress:(e,t)=>{const{serverUrl:n}=this.store.getState().teevid.user;if(e){const r=this.prepareUploadOptions(e);return new Promise((e,i)=>{const o=new XMLHttpRequest;o.open("post","https://"+n+"/api/v1/upload");for(let e in r.headers||{})o.setRequestHeader(e,r.headers[e]);o.onload=(()=>{e({body:o.responseText,status:o.status,json:function(){return new Promise((e,t)=>{try{e(JSON.parse(this.body))}catch(e){t(e)}})}})}),o.onerror=i,o.upload&&t&&(o.upload.onprogress=t),o.send(r.body)})}return Promise.resolve(!1)},uploadImage:e=>this._upload("/upload/image",e),scenesList:e=>{if(!e)throw Error("Storyboard does not exist");return this._call("get",`/storyboard/${encodeURIComponent(e)}/scenes`)},sceneEdit:(e,t,n)=>{if(!e)throw Error("Storyboard does not exist");if(!t)throw Error("Scene does not exist");return this._call("patch",`/storyboard/${encodeURIComponent(e)}/scenes/${encodeURIComponent(t)}`,n)},sceneRemove:(e,t)=>{if(!e)throw Error("Storyboard does not exist");if(!t)throw Error("Scene does not exist");return this._call("delete",`/storyboard/${encodeURIComponent(e)}/scenes/${encodeURIComponent(t)}`)},sceneCreate:(e,t)=>{if(!e)throw Error("Storyboard does not exist");return this._call("post",`/storyboard/${encodeURIComponent(e)}/scenes`,t)}}}get rooms(){return{get:e=>{if(!e)throw Error("Room does not exist");return this._call("get",`/rooms/${encodeURIComponent(e)}`)},getInviteToken:e=>{if(!e)throw Error("Room does not exist");return this._call("get",`/rooms/${encodeURIComponent(e)}/tokens`).then(e=>e.token)},list:()=>this._call("get","/rooms"),create:e=>this._call("post","/rooms",e),edit:(e,t)=>{if(!e)throw Error("Room does not exist");return this._call("patch",`/rooms/${encodeURIComponent(e)}`,t)},delete:e=>{if(!e)throw Error("Room does not exist");return this._call("delete",`/rooms/${encodeURIComponent(e)}`)},deleteChosen:e=>this._call("post","/rooms/remove",e)}}get participants(){return{list:e=>{if(!e)throw Error("Room does not exist");return this._call("get",`/rooms/${encodeURIComponent(e)}/participants`)},delete:(e,t)=>{if(!e)throw Error("Room does not exist");if(!t)throw Error("Participant does not exist");if(0===t.indexOf("local_"))throw Error("Paricipant does not exist");return this._call("delete",`/rooms/${encodeURIComponent(e)}/participants/${encodeURIComponent(t)}`)},deleteAll:e=>{if(!e)throw Error("Room does not exist");return this._call("delete",`/rooms/${encodeURIComponent(e)}/participants`)},updateRole:(e,t,n)=>{if(!e)throw Error("Room does not exist");if(!t)throw Error("Participant duplicated");if(!n)throw Error("Bad pin");return this._call("patch",`/rooms/${encodeURIComponent(e)}/participants/${encodeURIComponent(t)}`,{pin:n}).then(e=>{if("Paricipant"===e.role)throw Error("Bad pin");return e.role})},updateName:(e,t,n)=>{if(!e)throw Error("Room does not exist");if(!t)throw Error("Participant duplicated");return this._call("patch",`/rooms/${encodeURIComponent(e)}/participants/${encodeURIComponent(t)}`,{name:n})}}}get license(){return{get:()=>this._call("get","/system/license"),update:e=>this._call("put","/system/license",{license:e})}}get system(){return{servers:()=>this._call("get","/system/servers"),liveMeetings:()=>this._call("get","/live-meetings"),status:()=>this._call("get","/system/status"),setLogo:e=>this._upload("/system/logo",e)}}get reports(){return{meetings:e=>this._call("get",`/meetings?from=${e.from}&to=${e.to}`),participants:e=>this._call("get",`/meetings-participants?from=${e.from}&to=${e.to}`)}}get mcu(){return{list:()=>this._call("get","/system/mcu/list"),start:e=>this._call("put",`/system/mcu/start/${encodeURIComponent(e)}`),stop:e=>this._call("put",`/system/mcu/stop/${encodeURIComponent(e)}`),kill:e=>this._call("put",`/system/mcu/kill/${encodeURIComponent(e)}`),restart:e=>this._call("put",`/system/mcu/restart/${encodeURIComponent(e)}`),remove:e=>this._call("delete",`/system/mcu/${encodeURIComponent(e)}`)}}get mediaServers(){return{list:()=>this._call("get","/system/servers"),add:e=>this._call("post","/system/servers",e),delete:e=>Array.isArray(e)?this._call("delete",`/system/servers/${e.join("&")}`):this._call("delete",`/system/servers/${e}`)}}get kurentoServers(){return{list:()=>this._call("get","/media/servers")}}};window.TeeVidSdk=Fr;t.default=Fr},"./sdk/libs/erizo.js":
/*!***************************!*\
  !*** ./sdk/libs/erizo.js ***!
  \***************************/
/*! no static exports found */
/*! exports used: default */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){(function(t){var n=n||{};n.scope={},n.inherits=function(e,t){function n(){}for(var r in n.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new n,e.prototype.constructor=e,t)if(Object.defineProperties){var i=Object.getOwnPropertyDescriptor(t,r);i&&Object.defineProperty(e,r,i)}else e[r]=t[r]},n.ASSUME_ES5=!1,n.ASSUME_NO_NATIVE_MAP=!1,n.ASSUME_NO_NATIVE_SET=!1,n.defineProperty=n.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)},n.getGlobal=function(e){return"undefined"!=typeof window&&window===e?e:void 0!==t&&null!=t?t:e},n.global=n.getGlobal(this),n.SYMBOL_PREFIX="jscomp_symbol_",n.initSymbol=function(){n.initSymbol=function(){},n.global.Symbol||(n.global.Symbol=n.Symbol)},n.symbolCounter_=0,n.Symbol=function(e){return n.SYMBOL_PREFIX+(e||"")+n.symbolCounter_++},n.initSymbolIterator=function(){n.initSymbol();var e=n.global.Symbol.iterator;e||(e=n.global.Symbol.iterator=n.global.Symbol("iterator")),"function"!=typeof Array.prototype[e]&&n.defineProperty(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return n.arrayIterator(this)}}),n.initSymbolIterator=function(){}},n.arrayIterator=function(e){var t=0;return n.iteratorPrototype(function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}})},n.iteratorPrototype=function(e){return n.initSymbolIterator(),(e={next:e})[n.global.Symbol.iterator]=function(){return this},e},n.makeIterator=function(e){n.initSymbolIterator();var t=e[Symbol.iterator];return t?t.call(e):n.arrayIterator(e)},n.arrayFromIterator=function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n},n.arrayFromIterable=function(e){return e instanceof Array?e:n.arrayFromIterator(n.makeIterator(e))},n.polyfill=function(e,t,r,i){if(t){for(r=n.global,e=e.split("."),i=0;i<e.length-1;i++){var o=e[i];o in r||(r[o]={}),r=r[o]}(t=t(i=r[e=e[e.length-1]]))!=i&&null!=t&&n.defineProperty(r,e,{configurable:!0,writable:!0,value:t})}},n.polyfill("Array.from",function(e){return e||function(e,t,r){n.initSymbolIterator(),t=null!=t?t:function(e){return e};var i=[];if("function"==typeof(o=e[Symbol.iterator]))for(e=o.call(e);!(o=e.next()).done;)i.push(t.call(r,o.value));else for(var o=e.length,a=0;a<o;a++)i.push(t.call(r,e[a]));return i}},"es6-impl","es3"),n.iteratorFromArray=function(e,t){n.initSymbolIterator(),e instanceof String&&(e+="");var r=0,i={next:function(){if(r<e.length){var n=r++;return{value:t(n,e[n]),done:!1}}return i.next=function(){return{done:!0,value:void 0}},i.next()}};return i[Symbol.iterator]=function(){return i},i},n.polyfill("Array.prototype.keys",function(e){return e||function(){return n.iteratorFromArray(this,function(e){return e})}},"es6-impl","es3"),n.FORCE_POLYFILL_PROMISE=!1,n.polyfill("Promise",function(e){function t(){this.batch_=null}function r(e){return e instanceof o?e:new o(function(t,n){t(e)})}if(e&&!n.FORCE_POLYFILL_PROMISE)return e;t.prototype.asyncExecute=function(e){return null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_()),this.batch_.push(e),this},t.prototype.asyncExecuteBatch_=function(){var e=this;this.asyncExecuteFunction(function(){e.executeBatch_()})};var i=n.global.setTimeout;t.prototype.asyncExecuteFunction=function(e){i(e,0)},t.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var e=this.batch_;this.batch_=[];for(var t=0;t<e.length;++t){var n=e[t];delete e[t];try{n()}catch(e){this.asyncThrow_(e)}}}this.batch_=null},t.prototype.asyncThrow_=function(e){this.asyncExecuteFunction(function(){throw e})};var o=function(e){this.state_=0,this.result_=void 0,this.onSettledCallbacks_=[];var t=this.createResolveAndReject_();try{e(t.resolve,t.reject)}catch(e){t.reject(e)}};o.prototype.createResolveAndReject_=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.resolveTo_),reject:e(this.reject_)}},o.prototype.resolveTo_=function(e){if(e===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof o)this.settleSameAsPromise_(e);else{e:switch(typeof e){case"object":var t=null!=e;break e;case"function":t=!0;break e;default:t=!1}t?this.resolveToNonPromiseObj_(e):this.fulfill_(e)}},o.prototype.resolveToNonPromiseObj_=function(e){var t=void 0;try{t=e.then}catch(e){return void this.reject_(e)}"function"==typeof t?this.settleSameAsThenable_(t,e):this.fulfill_(e)},o.prototype.reject_=function(e){this.settle_(2,e)},o.prototype.fulfill_=function(e){this.settle_(1,e)},o.prototype.settle_=function(e,t){if(0!=this.state_)throw Error("Cannot settle("+e+", "+t|"): Promise already settled in state"+this.state_);this.state_=e,this.result_=t,this.executeOnSettledCallbacks_()},o.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var e=this.onSettledCallbacks_,t=0;t<e.length;++t)e[t].call(),e[t]=null;this.onSettledCallbacks_=null}};var a=new t;return o.prototype.settleSameAsPromise_=function(e){var t=this.createResolveAndReject_();e.callWhenSettled_(t.resolve,t.reject)},o.prototype.settleSameAsThenable_=function(e,t){var n=this.createResolveAndReject_();try{e.call(t,n.resolve,n.reject)}catch(e){n.reject(e)}},o.prototype.then=function(e,t){function n(e,t){return"function"==typeof e?function(t){try{r(e(t))}catch(e){i(e)}}:t}var r,i,a=new o(function(e,t){r=e,i=t});return this.callWhenSettled_(n(e,r),n(t,i)),a},o.prototype.catch=function(e){return this.then(void 0,e)},o.prototype.callWhenSettled_=function(e,t){function n(){switch(r.state_){case 1:e(r.result_);break;case 2:t(r.result_);break;default:throw Error("Unexpected state: "+r.state_)}}var r=this;null==this.onSettledCallbacks_?a.asyncExecute(n):this.onSettledCallbacks_.push(function(){a.asyncExecute(n)})},o.resolve=r,o.reject=function(e){return new o(function(t,n){n(e)})},o.race=function(e){return new o(function(t,i){for(var o=n.makeIterator(e),a=o.next();!a.done;a=o.next())r(a.value).callWhenSettled_(t,i)})},o.all=function(e){var t=n.makeIterator(e),i=t.next();return i.done?r([]):new o(function(e,n){function o(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).callWhenSettled_(o(a.length-1),n),i=t.next()}while(!i.done)})},o},"es6-impl","es3"),n.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.polyfill("WeakMap",function(e){function t(e){n.owns(e,i)||n.defineProperty(e,i,{value:{}})}function r(e){var n=Object[e];n&&(Object[e]=function(e){return t(e),n(e)})}if(function(){if(!e||!Object.seal)return!1;try{var t=Object.seal({}),n=Object.seal({}),r=new e([[t,2],[n,3]]);return 2==r.get(t)&&3==r.get(n)&&(r.delete(t),r.set(n,4),!r.has(t)&&4==r.get(n))}catch(e){return!1}}())return e;var i="$jscomp_hidden_"+Math.random().toString().substring(2);r("freeze"),r("preventExtensions"),r("seal");var o=0,a=function(e){if(this.id_=(o+=Math.random()+1).toString(),e){n.initSymbol(),n.initSymbolIterator(),e=n.makeIterator(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}};return a.prototype.set=function(e,r){if(t(e),!n.owns(e,i))throw Error("WeakMap key fail: "+e);return e[i][this.id_]=r,this},a.prototype.get=function(e){return n.owns(e,i)?e[i][this.id_]:void 0},a.prototype.has=function(e){return n.owns(e,i)&&n.owns(e[i],this.id_)},a.prototype.delete=function(e){return!(!n.owns(e,i)||!n.owns(e[i],this.id_))&&delete e[i][this.id_]},a},"es6-impl","es3"),n.MapEntry=function(){},n.polyfill("Map",function(e){if(!n.ASSUME_NO_NATIVE_MAP&&function(){if(!e||!e.prototype.entries||"function"!=typeof Object.seal)return!1;try{var t=Object.seal({x:4}),r=new e(n.makeIterator([[t,"s"]]));if("s"!=r.get(t)||1!=r.size||r.get({x:4})||r.set({x:4},"t")!=r||2!=r.size)return!1;var i=r.entries(),o=i.next();return!o.done&&o.value[0]==t&&"s"==o.value[1]&&!((o=i.next()).done||4!=o.value[0].x||"t"!=o.value[1]||!i.next().done)}catch(e){return!1}}())return e;n.initSymbol(),n.initSymbolIterator();var t=new WeakMap,r=function(e){if(this.data_={},this.head_=a(),this.size=0,e){e=n.makeIterator(e);for(var t;!(t=e.next()).done;)t=t.value,this.set(t[0],t[1])}};r.prototype.set=function(e,t){var n=i(this,e);return n.list||(n.list=this.data_[n.id]=[]),n.entry?n.entry.value=t:(n.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:e,value:t},n.list.push(n.entry),this.head_.previous.next=n.entry,this.head_.previous=n.entry,this.size++),this},r.prototype.delete=function(e){return!(!(e=i(this,e)).entry||!e.list)&&(e.list.splice(e.index,1),e.list.length||delete this.data_[e.id],e.entry.previous.next=e.entry.next,e.entry.next.previous=e.entry.previous,e.entry.head=null,this.size--,!0)},r.prototype.clear=function(){this.data_={},this.head_=this.head_.previous=a(),this.size=0},r.prototype.has=function(e){return!!i(this,e).entry},r.prototype.get=function(e){return(e=i(this,e).entry)&&e.value},r.prototype.entries=function(){return o(this,function(e){return[e.key,e.value]})},r.prototype.keys=function(){return o(this,function(e){return e.key})},r.prototype.values=function(){return o(this,function(e){return e.value})},r.prototype.forEach=function(e,t){for(var n,r=this.entries();!(n=r.next()).done;)n=n.value,e.call(t,n[1],n[0],this)},r.prototype[Symbol.iterator]=r.prototype.entries;var i=function(e,r){var i=r&&typeof r;"object"==i||"function"==i?t.has(r)?i=t.get(r):(i=""+ ++s,t.set(r,i)):i="p_"+r;var o=e.data_[i];if(o&&n.owns(e.data_,i))for(e=0;e<o.length;e++){var a=o[e];if(r!=r&&a.key!=a.key||r===a.key)return{id:i,list:o,index:e,entry:a}}return{id:i,list:o,index:-1,entry:void 0}},o=function(e,t){var r=e.head_;return n.iteratorPrototype(function(){if(r){for(;r.head!=e.head_;)r=r.previous;for(;r.next!=r.head;)return r=r.next,{done:!1,value:t(r)};r=null}return{done:!0,value:void 0}})},a=function(){var e={};return e.previous=e.next=e.head=e},s=0;return r},"es6-impl","es3"),n.polyfill("Array.prototype.values",function(e){return e||function(){return n.iteratorFromArray(this,function(e,t){return t})}},"es6","es3"),n.findInternal=function(e,t,n){e instanceof String&&(e=String(e));for(var r=e.length,i=0;i<r;i++){var o=e[i];if(t.call(n,o,i,e))return{i:i,v:o}}return{i:-1,v:void 0}},n.polyfill("Array.prototype.find",function(e){return e||function(e,t){return n.findInternal(this,e,t).v}},"es6-impl","es3"),n.polyfill("Object.is",function(e){return e||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},"es6-impl","es3"),n.polyfill("Array.prototype.includes",function(e){return e||function(e,t){var n=this;n instanceof String&&(n=String(n));var r=n.length;for(t=t||0;t<r;t++)if(n[t]==e||Object.is(n[t],e))return!0;return!1}},"es7","es3"),n.checkStringArgs=function(e,t,n){if(null==e)throw new TypeError("The 'this' value for String.prototype."+n+" must not be null or undefined");if(t instanceof RegExp)throw new TypeError("First argument to String.prototype."+n+" must not be a regular expression");return e+""},n.polyfill("String.prototype.includes",function(e){return e||function(e,t){return-1!==n.checkStringArgs(this,e,"includes").indexOf(e,t||0)}},"es6-impl","es3"),n.polyfill("Object.assign",function(e){return e||function(e,t){for(var r=1;r<arguments.length;r++){var i=arguments[r];if(i)for(var o in i)n.owns(i,o)&&(e[o]=i[o])}return e}},"es6-impl","es3"),n.polyfill("String.prototype.startsWith",function(e){return e||function(e,t){var r=n.checkStringArgs(this,e,"startsWith");e+="";var i=r.length,o=e.length;t=Math.max(0,Math.min(0|t,r.length));for(var a=0;a<o&&t<i;)if(r[t++]!=e[a++])return!1;return a>=o}},"es6-impl","es3"),n.polyfill("String.prototype.endsWith",function(e){return e||function(e,t){var r=n.checkStringArgs(this,e,"endsWith");e+="",void 0===t&&(t=r.length),t=Math.max(0,Math.min(0|t,r.length));for(var i=e.length;0<i&&0<t;)if(r[--t]!=e[--i])return!1;return 0>=i}},"es6-impl","es3"),e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=24)}([function(e,t,r){var i,o,a=(i="",o=function(e){console.log.apply(console,[].concat(n.arrayFromIterable(e)))},{DEBUG:0,TRACE:1,INFO:2,WARNING:3,ERROR:4,NONE:5,setLogLevel:function(e){var t=e;e>a.NONE?t=a.NONE:e<a.DEBUG&&(t=a.DEBUG),a.logLevel=t},setOutputFunction:function(e){o=e},setLogPrefix:function(e){i=e},log:function(e,t){for(var n=[],r=1;r<arguments.length;++r)n[r-1]=arguments[r];if(r=i,!(e<a.logLevel))if(e===a.DEBUG?r+="DEBUG":e===a.TRACE?r+="TRACE":e===a.INFO?r+="INFO":e===a.WARNING?r+="WARNING":e===a.ERROR&&(r+="ERROR"),n=[r+": "].concat(n),void 0!==a.panel){r="";for(var s=0;s<n.length;s+=1)r+=n[s];a.panel.value=a.panel.value+"\n"+r}else o.apply(a,[n])},debug:function(e){for(var t=[],r=0;r<arguments.length;++r)t[r-0]=arguments[r];a.log.apply(a,[].concat([a.DEBUG],n.arrayFromIterable(t)))},trace:function(e){for(var t=[],r=0;r<arguments.length;++r)t[r-0]=arguments[r];a.log.apply(a,[].concat([a.TRACE],n.arrayFromIterable(t)))},info:function(e){for(var t=[],r=0;r<arguments.length;++r)t[r-0]=arguments[r];a.log.apply(a,[].concat([a.INFO],n.arrayFromIterable(t)))},warning:function(e){for(var t=[],r=0;r<arguments.length;++r)t[r-0]=arguments[r];a.log.apply(a,[].concat([a.WARNING],n.arrayFromIterable(t)))},error:function(e){for(var t=[],r=0;r<arguments.length;++r)t[r-0]=arguments[r];a.log.apply(a,[].concat([a.ERROR],n.arrayFromIterable(t)))}});t.a=a},function(e,t,n){n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o}),n.d(t,"d",function(){return a}),n.d(t,"e",function(){return c}),n.d(t,"f",function(){return d}),n.d(t,"a",function(){return s});var r=n(0),i=function(){var e={},t={};return e.addEventListener=function(e,n){void 0===t[e]&&(t[e]=[]),t[e].push(n)},e.removeEventListener=function(e,n){t[e]&&(-1!==(n=t[e].indexOf(n))&&t[e].splice(n,1))},e.removeAllListeners=function(){t={}},e.dispatchEvent=function(e){if(!e||!e.type)throw Error("Undefined event");for(var n=(n=t[e.type]||[]).slice(0),i=0;i<n.length;i+=1)try{n[i](e)}catch(t){r.a.info("Error triggering event: "+e.type+", error: "+t)}},e.on=e.addEventListener,e.off=e.removeEventListener,e.emit=e.dispatchEvent,e},o=function(){this.emitter=i()};o.prototype.addEventListener=function(e,t){this.emitter.addEventListener(e,t)},o.prototype.removeEventListener=function(e,t){this.emitter.removeEventListener(e,t)},o.prototype.dispatchEvent=function(e){this.emitter.dispatchEvent(e)},o.prototype.on=function(e,t){this.addEventListener(e,t)},o.prototype.off=function(e,t){this.removeEventListener(e,t)},o.prototype.emit=function(e){this.dispatchEvent(e)};var a=function(e){var t={};return t.type=e.type,t},s=function(e){var t=a(e);return t.stream=e.stream,t.state=e.state,t},c=function(e){var t=a(e);return t.streams=e.streams,t.message=e.message,t},d=function(e){var t=a(e);return t.stream=e.stream,t.msg=e.msg,t.origin=e.origin,t.bandwidth=e.bandwidth,t.attrs=e.attrs,t}},function(e,t,n){var r=n(6)("ACTIVE","PASSIVE","ACTPASS","INACTIVE");r.byValue=function(e){return r[e.toUpperCase()]},r.toString=function(e){switch(e){case r.ACTIVE:return"active";case r.PASSIVE:return"passive";case r.ACTPASS:return"actpass";case r.INACTIVE:return"inactive";default:return null}},r.reverse=function(e){switch(e){case r.ACTIVE:return r.PASSIVE;case r.PASSIVE:return r.ACTIVE;case r.ACTPASS:return r.PASSIVE;case r.INACTIVE:return r.INACTIVE;default:return r.ACTIVE}},e.exports=r},function(e,t,n){var r=n(6)("SEND","RECV");r.byValue=function(e){return r[e.toUpperCase()]},r.toString=function(e){switch(e){case r.SEND:return"send";case r.RECV:return"recv";default:return"unknown"}},r.reverse=function(e){switch(e){case r.SEND:return r.RECV;case r.RECV:default:return r.SEND}},e.exports=r},function(e,t,n){var r=n(6)("SENDRECV","SENDONLY","RECVONLY","INACTIVE");r.byValue=function(e){return r[e.toUpperCase()]},r.toString=function(e){switch(e){case r.SENDRECV:return"sendrecv";case r.SENDONLY:return"sendonly";case r.RECVONLY:return"recvonly";case r.INACTIVE:return"inactive";default:return"unknown"}},r.reverse=function(e){switch(e){case r.SENDRECV:return r.SENDRECV;case r.SENDONLY:return r.RECVONLY;case r.RECVONLY:return r.SENDONLY;case r.INACTIVE:return r.INACTIVE;default:return r.SENDRECV}},e.exports=r},function(e,t,n){var r=n(1);t.a=function(){var e=Object(r.b)({});return e.url="",e}},function(e,t){e.exports=function e(t){for(var r=[],i=0;i<arguments.length;++i)r[i-0]=arguments[i];var o=this;if(!(this instanceof e))return new(Function.prototype.bind.apply(e,[null].concat(Array.prototype.slice.call(r))));Array.from(r).forEach(function(e){n.initSymbol(),o[e]=Symbol.for("LICODE_SEMANTIC_SDP_"+e)})}},function(e,t,n){t.a=function(){var e={},t={};return e.add=function(e,n){t[e]=n},e.get=function(e){return t[e]},e.has=function(e){return void 0!==t[e]},e.size=function(){return Object.keys(t).length},e.forEach=function(e){for(var n=Object.keys(t),r=0;r<n.length;r+=1){var i=n[r];e(t[i],i)}},e.keys=function(){return Object.keys(t)},e.remove=function(e){delete t[e]},e.clear=function(){t={}},e}},function(e,t,n){(function(e){var r=n(0),i=function(){var t="none";return void 0!==e&&e.exports?t="fake":null!==window.navigator.userAgent.match("Firefox")?t="mozilla":null!==window.navigator.userAgent.match("Chrome")?(t="chrome-stable",null!==window.navigator.userAgent.match("Electron")&&(t="electron")):null!==window.navigator.userAgent.match("Safari")?t="safari":null!==window.navigator.userAgent.match("AppleWebKit")&&(t="safari"),t};t.a={GetUserMedia:function(t,n,o){n=void 0===n?function(){}:n,o=void 0===o?function(){}:o;var a,s=function(e,t,n){navigator.mediaDevices.getUserMedia(e).then(t).catch(n)};t.screen?function(){switch(r.a.debug("Screen access requested"),i()){case"electron":r.a.debug("Screen sharing in Electron"),(a={}).video=t.video||{},a.video.mandatory=t.video.mandatory||{},a.video.mandatory.chromeMediaSource="desktop",a.video.mandatory.chromeMediaSourceId=t.desktopStreamId,s(a,n,o);break;case"mozilla":r.a.debug("Screen sharing in Firefox"),a={},void 0!==t.video?(a.video=t.video,a.video.mediaSource||(a.video.mediaSource="window")):a={audio:t.audio,video:{mediaSource:"window"}},s(a,n,o);break;case"chrome-stable":if(r.a.debug("Screen sharing in Chrome"),a={},t.desktopStreamId)a.video=t.video||{mandatory:{}},a.video.mandatory=a.video.mandatory||{},a.video.mandatory.chromeMediaSource="desktop",a.video.mandatory.chromeMediaSourceId=t.desktopStreamId,s(a,n,o);else{var e="okeephmleflklcdebijnponpabbmmgeo";t.extensionId&&(r.a.debug("extensionId supplied, using "+t.extensionId),e=t.extensionId),r.a.debug("Screen access on chrome stable, looking for extension");try{chrome.runtime.sendMessage(e,{getStream:!0},function(e){void 0===e?(r.a.error("Access to screen denied"),o({code:"Access to screen denied"})):(e=e.streamId,void 0!==t.video.mandatory?(a.video=t.video||{mandatory:{}},a.video.mandatory.chromeMediaSource="desktop",a.video.mandatory.chromeMediaSourceId=e):a={video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e}}},s(a,n,o))})}catch(e){r.a.debug("Screensharing plugin is not accessible "),o({code:"no_plugin_present"})}}break;default:r.a.error("This browser does not support ScreenSharing")}}():void 0!==e&&e.exports?r.a.error("Video/audio streams not supported in erizofc yet"):(r.a.debug("Calling getUserMedia with config",t),s(t,n,o))},getBrowser:i}}).call(t,n(41)(e))},function(e,t,n){var r=this;e=n(28);var i=n.n(e);e=n(2);var o=n.n(e);e=n(4);var a=n.n(e),s=n(36),c=n(21),d=n(0),u=n(38);t.a=function(e){var t,n,l,p,f={},h=new u.a,m=new u.a,y=!1,g=-1;d.a.info("Starting Base stack",e),f.pcConfig={iceServers:[],sdpSemantics:"plan-b"},f.con={},void 0!==e.iceServers&&(f.pcConfig.iceServers=e.iceServers),!0===e.forceTurn&&(f.pcConfig.iceTransportPolicy="relay"),f.audio=e.audio,f.video=e.video,void 0===f.audio&&(f.audio=!0),void 0===f.video&&(f.video=!0),e.remoteCandidates=[],e.localCandidates=[],e.remoteDescriptionSet=!1,f.mediaConstraints={offerToReceiveVideo:void 0!==f.video&&!1!==f.video,offerToReceiveAudio:void 0!==f.audio&&!1!==f.audio},f.peerConnection=new RTCPeerConnection(f.pcConfig,f.con);var v=0;f.peerConnection.onnegotiationneeded=function(){var e=(e=f.audio?1:0)+(f.video?1:0);0==v%e&&f.createOffer(!0,!0),v+=1};var E=function(e){f.peerConnectionFsm.error(e)},S=function(){t.sdp=f.enableSimulcast(t.sdp),t.type="answer",l=i.a.SDPInfo.processString(t.sdp),c.a.setMaxBW(l,e);var n=f.remoteSdp.getStreams().size,r=l.getStreams().size,o=a.a.reverse("sendrecv");o=0<n&&0<r?a.a.reverse("sendrecv"):0<n&&0===r?a.a.reverse("recvonly"):0===n&&0<r?a.a.reverse("sendonly"):a.a.reverse("inactive");l.getMedias().forEach(function(e){e.setDirection(o)}),t.sdp=l.toString(),f.localSdp=l},_=function(){t.sdp=f.enableSimulcast(t.sdp),t.type="offer",l=i.a.SDPInfo.processString(t.sdp),c.a.setMaxBW(l,e),l.medias.forEach(function(e){e.getSetup()!==o.a.ACTPASS&&e.setSetup(o.a.ACTPASS)}),t.sdp=l.toString(),f.localSdp=l},T=function(n,r){t=r,_(),e.callback({type:t.type,sdp:t.sdp,config:{maxVideoBW:e.maxVideoBW}})};return f.enqueuedCalls={negotiationQueue:{createOffer:h.protectFunction(function(e){(e=f.peerConnectionFsm.createOffer(void 0!==e&&e))&&e.catch(E.bind(r))}),processOffer:h.protectFunction(function(e){(e=f.peerConnectionFsm.processOffer(e))&&e.catch(E.bind(r))}),processAnswer:h.protectFunction(function(e){(e=f.peerConnectionFsm.processAnswer(e))&&e.catch(E.bind(r))}),negotiateMaxBW:h.protectFunction(function(e,t){(e=f.peerConnectionFsm.negotiateMaxBW(e,t))&&e.catch(E.bind(r))}),processNewCandidate:h.protectFunction(function(t){try{var n="object"==typeof t.candidate?t.candidate:JSON.parse(t.candidate);if("end"!==n.candidate){n.candidate=n.candidate.replace(/a=/g,""),n.sdpMLineIndex=parseInt(n.sdpMLineIndex,10);var i=new RTCIceCandidate(n);e.remoteDescriptionSet?(h.startEnqueuing(),f.peerConnectionFsm.addIceCandidate(i).catch(E.bind(r))):e.remoteCandidates.push(i)}}catch(e){d.a.error("Error parsing candidate",t.candidate)}}),addStream:h.protectFunction(function(e){h.startEnqueuing(),(e=f.peerConnectionFsm.addStream(e))?e.catch(E.bind(r)):(h.stopEnqueuing(),h.nextInQueue())}),removeStream:h.protectFunction(function(e){h.startEnqueuing(),(e=f.peerConnectionFsm.removeStream(e))?e.catch(E.bind(r)):(h.stopEnqueuing(),h.nextInQueue())}),close:h.protectFunction(function(){h.startEnqueuing();var e=f.peerConnectionFsm.close();e?e.catch(E.bind(r)):(h.stopEnqueuing(),h.nextInQueue())})},firstLocalDescriptionQueue:{createOffer:m.protectFunction(function(e,t){e=void 0!==e&&e,t=void 0!==t&&t,y||m.startEnqueuing(),e||t||(f.mediaConstraints={offerToReceiveVideo:!1,offerToReceiveAudio:!1}),f.enqueuedCalls.negotiationQueue.createOffer(e)}),sendOffer:m.protectFunction(function(){y?T(0,t):f.createOffer(!0,!0)}),processOffer:m.protectFunction(function(e){y||m.startEnqueuing(),f.enqueuedCalls.negotiationQueue.processOffer(e)})}},f.protectedCalls={protectedAddStream:function(e){return f.peerConnection.addStream(e),setTimeout(function(){h.stopEnqueuing(),h.nextInQueue()},0),Promise.resolve()},protectedRemoveStream:function(e){return f.peerConnection.removeStream(e),setTimeout(function(){h.stopEnqueuing(),h.nextInQueue()},0),Promise.resolve()},protectedCreateOffer:function(e){e=void 0!==e&&e,h.startEnqueuing(),d.a.debug("Creating offer",f.mediaConstraints);var t=[];return f.peerConnection.createOffer(f.mediaConstraints).then(T.bind(null,e)).catch(function(e){t.push("in protectedCreateOffer-createOffer, error: "+e)}).then(function(){return setTimeout(function(){h.stopEnqueuing(),h.nextInQueue()},0),0!==t.length?Promise.reject(t):Promise.resolve()})},protectedProcessOffer:function(n){d.a.info("Protected process Offer,",n,"localDesc",t);var o=(p=i.a.SDPInfo.processString(n.sdp))&&p.origin&&p.origin.sessionVersion;if(g>=o)return d.a.warning("message: processOffer discarding old sdp sessionVersion: "+o+", latestSessionVersion: "+g),e.callback({type:"answer",sdp:t.sdp,config:{maxVideoBW:e.maxVideoBW}}),Promise.resolve();h.startEnqueuing(),g=o,c.a.setMaxBW(p,e),n.sdp=p.toString(),f.remoteSdp=p;var a=[];return f.peerConnection.setRemoteDescription(n).then(function(){e.remoteDescriptionSet=!0}).then(function(){return f.peerConnection.createAnswer(f.mediaConstraints)}).catch(function(e){a.push("in: protectedProcessOffer-createAnswer, error: "+e)}).then(function(n){return t=n,S(),e.callback({type:t.type,sdp:t.sdp,config:{maxVideoBW:e.maxVideoBW}}),d.a.info("Setting local description",t),d.a.debug("processOffer - Local Description",t.type,t.sdp),f.peerConnection.setLocalDescription(t).then(function(){f.setSimulcastLayersBitrate()})}.bind(r)).catch(function(e){a.push("in: protectedProcessOffer-setLocalDescForAnswer, error: "+e)}).then(function(){return setTimeout(function(){y=!0,m.stopEnqueuing(),m.dequeueAll(),h.stopEnqueuing(),h.nextInQueue()},0),0!==a.length?Promise.reject(a):Promise.resolve()})},protectedProcessAnswer:function(o){var a=(p=i.a.SDPInfo.processString(o.sdp))&&p.origin&&p.origin.sessionVersion;if(g>=a)return d.a.warning("processAnswer discarding old sdp, sessionVersion: "+a+", latestSessionVersion: "+g),Promise.resolve();h.startEnqueuing(),g=a,d.a.info("Set remote and local description"),c.a.setMaxBW(p,e),f.setStartVideoBW(p),f.setHardMinVideoBW(p),o.sdp=p.toString(),_(),d.a.debug("processAnswer - Remote Description",o.type,o.sdp),d.a.debug("processAnswer - Local Description",o.type,t.sdp),f.remoteSdp=p,n=o;var s=[];return f.peerConnection.setLocalDescription(t).then(function(){f.setSimulcastLayersBitrate(),f.peerConnection.setRemoteDescription(new RTCSessionDescription(o))}).then(function(){for(e.remoteDescriptionSet=!0,d.a.info("Candidates to be added: ",e.remoteCandidates.length,e.remoteCandidates);0<e.remoteCandidates.length;)f.peerConnectionFsm.addIceCandidate(e.remoteCandidates.shift()).catch(E.bind(r));for(d.a.info("Local candidates to send:",e.localCandidates.length);0<e.localCandidates.length;)e.callback({type:"candidate",candidate:e.localCandidates.shift()})}).catch(function(e){s.push("in: protectedProcessAnswer, error: "+e)}).then(function(){return setTimeout(function(){y=!0,m.stopEnqueuing(),m.dequeueAll(),h.stopEnqueuing(),h.nextInQueue()},0),0!==s.length?Promise.reject(s):Promise.resolve()})},protectedNegotiateMaxBW:function(r,o){if(r.Sdp||r.maxAudioBW){h.startEnqueuing();var a=[];_(),f.peerConnection.setLocalDescription(t).then(function(){return f.setSimulcastLayersBitrate(),p=i.a.SDPInfo.processString(n.sdp),c.a.setMaxBW(p,e),n.sdp=p.toString(),f.remoteSdp=p,f.peerConnection.setRemoteDescription(new RTCSessionDescription(n))}).then(function(){e.remoteDescriptionSet=!0,e.callback({type:"offer-noanswer",sdp:t.sdp})}).catch(function(e){o("error","updateSpec"),a.push("in: protectedNegotiateMaxBW error: "+e)}).then(function(){return setTimeout(function(){h.stopEnqueuing(),h.nextInQueue()},0),0!==a.length?Promise.reject(a):Promise.resolve()})}},protectedAddIceCandiate:function(e){var t=[];return f.peerConnection.addIceCandidate(e).catch(function(e){t.push("in: protectedAddIceCandidate, error: "+e)}).then(function(){return setTimeout(function(){h.stopEnqueuing(),h.nextInQueue()},0),0!==t.length?Promise.reject(t):Promise.resolve()})},protectedClose:function(){return f.peerConnection.close(),setTimeout(function(){h.stopEnqueuing(),h.nextInQueue()},0),Promise.resolve()}},f.peerConnection.onicecandidate=function(t){(t=t.candidate)?(t={sdpMLineIndex:t.sdpMLineIndex,sdpMid:t.sdpMid,candidate:t.candidate}).candidate.match(/a=/)||(t.candidate="a="+t.candidate):(d.a.info("Gathered all candidates. Sending END candidate"),t={sdpMLineIndex:-1,sdpMid:"end",candidate:"end"}),e.remoteDescriptionSet?e.callback({type:"candidate",candidate:t}):(e.localCandidates.push(t),d.a.info("Storing candidate: ",e.localCandidates.length,t))},f.setStartVideoBW=function(e){return d.a.error("startVideoBW not implemented for this browser"),e},f.setHardMinVideoBW=function(e){return d.a.error("hardMinVideoBw not implemented for this browser"),e},f.enableSimulcast=function(e){return d.a.error("Simulcast not implemented"),e},f.setSimulcastLayersBitrate=function(){d.a.error("Simulcast not implemented")},f.setSimulcast=function(e){f.simulcast=e},f.setVideo=function(e){f.video=e},f.setAudio=function(e){f.audio=e},f.updateSpec=function(t,n,r){r=void 0===r?function(){}:r;var i=e.p2p&&t.maxVideoBW,o=!e.p2p&&t.maxVideoBW;t.maxVideoBW&&(d.a.debug("Maxvideo Requested:",t.maxVideoBW,"limit:",e.limitMaxVideoBW),t.maxVideoBW>e.limitMaxVideoBW&&(t.maxVideoBW=e.limitMaxVideoBW),e.maxVideoBW=t.maxVideoBW,d.a.debug("Result",e.maxVideoBW)),t.maxAudioBW&&(t.maxAudioBW>e.limitMaxAudioBW&&(t.maxAudioBW=e.limitMaxAudioBW),e.maxAudioBW=t.maxAudioBW),(i||t.maxAudioBW)&&f.enqueuedCalls.negotiationQueue.negotiateMaxBW(t,r),(o||t.minVideoBW||void 0!==t.slideShowMode||void 0!==t.muteStream||void 0!==t.qualityLayer||void 0!==t.slideShowBelowLayer||void 0!==t.video)&&(d.a.debug("MaxVideoBW Changed to ",t.maxVideoBW),d.a.debug("MinVideo Changed to ",t.minVideoBW),d.a.debug("SlideShowMode Changed to ",t.slideShowMode),d.a.debug("muteStream changed to ",t.muteStream),d.a.debug("Video Constraints",t.video),d.a.debug("Will activate slideshow when below layer",t.slideShowBelowLayer),e.callback({type:"updatestream",config:t},n))},f.createOffer=f.enqueuedCalls.firstLocalDescriptionQueue.createOffer,f.sendOffer=f.enqueuedCalls.firstLocalDescriptionQueue.sendOffer,f.addStream=f.enqueuedCalls.negotiationQueue.addStream,f.removeStream=f.enqueuedCalls.negotiationQueue.removeStream,f.close=f.enqueuedCalls.negotiationQueue.close,f.processSignalingMessage=function(e){"offer"===e.type?f.enqueuedCalls.firstLocalDescriptionQueue.processOffer(e):"answer"===e.type?f.enqueuedCalls.negotiationQueue.processAnswer(e):"candidate"===e.type?f.enqueuedCalls.negotiationQueue.processNewCandidate(e):"error"===e.type&&(d.a.error("Received error signaling message, state:",e.previousType,m.isEnqueueing()),"offer"===e.previousType&&m.isEnqueueing()&&(m.stopEnqueuing(),m.nextInQueue()))},f.peerConnectionFsm=new s.a(f.protectedCalls),f}},function(e,t){var n=e.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:"username sessionId sessionVersion netType ipVer address".split(" "),format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-\.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))? (\S*)(?: (\S*))?/,names:["value","direction","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+" %s"+(e.config?" %s":"")}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:"foundation component transport priority ip port type raddr rport tcptype generation network-id network-cost".split(" "),format:function(e){var t="candidate:%s %d %s %d %s %d typ %s"+(null!=e.raddr?" raddr %s rport %d":"%v%v");return t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),(t+=null!=e["network-id"]?" network-id %d":"%v")+(null!=e["network-cost"]?" network-cost %d":"%v")}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:/^imageattr:(\d+|\*)[\s\t]+(send|recv)[\s\t]+(\*|\[\S+\](?:[\s\t]+\[\S+\])*)(?:[\s\t]+(recv|send)[\s\t]+(\*|\[\S+\](?:[\s\t]+\[\S+\])*))?/,names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:/^simulcast:(send|recv) ([a-zA-Z0-9\-_~;,]+)(?:\s?(send|recv) ([a-zA-Z0-9\-_~;,]+))?$/,names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{push:"invalid",names:["value"]}]};Object.keys(n).forEach(function(e){n[e].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})})},function(e,t){var n=function(e,t,n,r,i,o,a,s,c,d){this.foundation=e,this.componentId=t,this.transport=n,this.priority=r,this.address=i,this.port=o,this.type=a,this.generation=s,this.relAddr=c,this.relPort=d};n.prototype.clone=function(){return new n(this.foundation,this.componentId,this.transport,this.priority,this.address,this.port,this.type,this.generation,this.relAddr,this.relPort)},n.prototype.plain=function(){var e={foundation:this.foundation,componentId:this.componentId,transport:this.transport,priority:this.priority,address:this.address,port:this.port,type:this.type,generation:this.generation};return this.relAddr&&(e.relAddr=this.relAddr),this.relPort&&(e.relPort=this.relPort),e},n.prototype.getFoundation=function(){return this.foundation},n.prototype.getComponentId=function(){return this.componentId},n.prototype.getTransport=function(){return this.transport},n.prototype.getPriority=function(){return this.priority},n.prototype.getAddress=function(){return this.address},n.prototype.getPort=function(){return this.port},n.prototype.getType=function(){return this.type},n.prototype.getGeneration=function(){return this.generation},n.prototype.getRelAddr=function(){return this.relAddr},n.prototype.getRelPort=function(){return this.relPort},e.exports=n},function(e,t){var n=function(e,t,n,r,i,o){this.codec=e,this.type=t,this.rate=n,this.encoding=r,this.params=i||{},this.feedback=o||[]};n.prototype.clone=function(){var e=new n(this.codec,this.type,this.rate,this.encoding,this.params,this.feedback);return this.rtx&&e.setRTX(this.rtx),e},n.prototype.plain=function(){return{codec:this.codec,type:this.type,rate:this.rate,encoding:this.encoding,params:this.params,feedback:this.feedback}},n.prototype.setRTX=function(e){this.rtx=e},n.prototype.getType=function(){return this.type},n.prototype.setType=function(e){this.type=e},n.prototype.getCodec=function(){return this.codec},n.prototype.getParams=function(){return this.params},n.prototype.setParam=function(e,t){this.params[e]=t},n.prototype.hasRTX=function(){return this.rtx},n.prototype.getRTX=function(){return this.rtx},n.prototype.getRate=function(){return this.rate},n.prototype.getEncoding=function(){return this.encoding},n.prototype.getFeedback=function(){return this.feedback},n.mapFromNames=function(e,t){var r=new Map,i=96;return e.forEach(function(e){var o="pcmu"===(e=e.toLowerCase())?0:"pcma"===e?8:i+=1;o=new n(e,o),t&&"ulpfec"!==e&&"flexfec-03"!==e&&"red"!==e&&(i+=1,o.setRTX(i)),r.set(o.getCodec().toLowerCase(),o)}),r},e.exports=n},function(e,t,n){var r=n(2),i=function(e,t,n){this.setup=e,this.hash=t,this.fingerprint=n};i.prototype.clone=function(){return new i(this.setup,this.hash,this.fingerprint)},i.prototype.plain=function(){return{setup:r.toString(this.setup),hash:this.hash,fingerprint:this.fingerprint}},i.prototype.getFingerprint=function(){return this.fingerprint},i.prototype.getHash=function(){return this.hash},i.prototype.getSetup=function(){return this.setup},i.prototype.setSetup=function(e){this.setup=e},e.exports=i},function(e,t){function n(e){e=new Uint8Array(e);for(var t=0;t<e.length;t+=1)e[t]=Math.floor(256*Math.random()+0);return e}function r(e){return Array.prototype.map.call(new Uint8Array(e),function(e){return("00"+e.toString(16)).slice(-2)}).join("")}var i=function(e,t,n){this.ufrag=e,this.pwd=t,this.opts=n,this.endOfCandidates=this.lite=!1};i.prototype.clone=function(){var e=new i(this.ufrag,this.pwd,this.opts);return e.setLite(this.lite),e.setEndOfCandidates(this.endOfCandidates),e},i.prototype.plain=function(){var e={ufrag:this.ufrag,pwd:this.pwd};return this.lite&&(e.lite=this.lite),this.endOfCandidates&&(e.endOfCandidates=this.endOfCandidates),e},i.prototype.getUfrag=function(){return this.ufrag},i.prototype.getPwd=function(){return this.pwd},i.prototype.isLite=function(){return this.lite},i.prototype.getOpts=function(){return this.opts},i.prototype.setLite=function(e){this.lite=e},i.prototype.isEndOfCandidates=function(){return this.endOfCandidates},i.prototype.setEndOfCandidates=function(e){this.endOfCandidates=e},i.generate=function(){var e=new i,t=n(8),o=n(24);return e.ufrag=r(t),e.pwd=r(o),e},e.exports=i},function(e,t,n){var r=n(16),i=n(4),o=n(3),a=function(e,t,n){this.id=e,this.type=n,this.port=t,this.direction=i.SENDRECV,this.extensions=new Map,this.codecs=new Map,this.rids=new Map,this.simulcast_03=this.simulcast=null,this.bitrate=0,this.connection=this.dtls=this.ice=null,this.candidates=[]};a.prototype.clone=function(){var e=new a(this.id,this.port,this.type);return e.setDirection(this.direction),e.setBitrate(this.bitrate),e.setConnection(this.connection),this.codecs.forEach(function(t){e.addCodec(t.clone())}),this.extensions.forEach(function(t,n){e.addExtension(n,t)}),this.rids.forEach(function(t,n){e.addRID(n,t.clone())}),this.simulcast&&e.setSimulcast(this.simulcast.clone()),this.xGoogleFlag&&e.setXGoogleFlag(this.xGoogleFlag),this.ice&&e.setICE(this.ice.clone()),this.dtls&&e.setDTLS(this.dtls.clone()),this.candidates.forEach(function(t){e.addCandidate(t.clone())}),this.setup&&e.setSetup(this.setup),e},a.prototype.plain=function(){var e={id:this.id,port:this.port,type:this.type,connection:this.connection,direction:i.toString(this.direction),xGoogleFlag:this.xGoogleFlag,extensions:{},rids:[],codecs:[],candidates:[]};return this.bitrate&&(e.bitrate=this.bitrate),this.codecs.forEach(function(t){e.codecs.push(t.plain())}),this.extensions.forEach(function(t){e.extensions.push(t.plain())}),this.rids.forEach(function(t){e.rids.push(t.plain())}),this.simulcast&&(e.simulcast=this.simulcast.plain()),this.candidates.forEach(function(t){e.candidates.push(t.plain())}),e.ice=this.ice&&this.ice.plain(),e.dtls=this.dtls&&this.dtls.plain(),e},a.prototype.getType=function(){return this.type},a.prototype.getPort=function(){return this.port},a.prototype.getId=function(){return this.id},a.prototype.addExtension=function(e,t){this.extensions.set(e,t)},a.prototype.addRID=function(e){this.rids.set(e.getId(),e)},a.prototype.addCodec=function(e){this.codecs.set(e.getType(),e)},a.prototype.getCodecForType=function(e){return this.codecs.get(e)},a.prototype.getCodec=function(e){var t;return this.codecs.forEach(function(n){n.getCodec().toLowerCase()===e.toLowerCase()&&(t=n)}),t},a.prototype.hasCodec=function(e){return null!==this.getCodec(e)},a.prototype.getCodecs=function(){return this.codecs},a.prototype.getExtensions=function(){return this.extensions},a.prototype.getRIDs=function(){return this.rids},a.prototype.getRID=function(e){return this.rids.get(e)},a.prototype.getBitrate=function(){return this.bitrate},a.prototype.setBitrate=function(e){this.bitrate=e},a.prototype.getDirection=function(){return this.direction},a.prototype.setDirection=function(e){this.direction=e},a.prototype.getDTLS=function(){return this.dtls},a.prototype.setDTLS=function(e){this.dtls=e},a.prototype.getICE=function(){return this.ice},a.prototype.setICE=function(e){this.ice=e},a.prototype.addCandidate=function(e){this.candidates.push(e)},a.prototype.addCandidates=function(e){var t=this;e.forEach(function(e){t.addCandidate(e)})},a.prototype.getCandidates=function(){return this.candidates},a.prototype.setXGoogleFlag=function(e){this.xGoogleFlag=e},a.prototype.getXGoogleFlag=function(){return this.xGoogleFlag},a.prototype.getConnection=function(){return this.connection},a.prototype.setConnection=function(e){this.connection=e},a.prototype.answer=function(e){var t=new a(this.id,this.port,this.type);if(t.setDirection(i.reverse(this.direction)),e.codecs&&this.codecs.forEach(function(n){if(e.codecs.has(n.getCodec().toLowerCase())){var r=e.codecs.get(n.getCodec().toLowerCase()).clone();r.setType(n.getType()),r.hasRTX()&&r.setRTX(n.getRTX()),t.addCodec(r)}}),this.extensions.forEach(function(n,r){e.extensions.has(r)&&t.addExtension(r,n)}),e.simulcast&&this.simulcast){var n=new r,s=this.simulcast.getSimulcastStreams(o.SEND);s&&s.forEach(function(e){var t=[];e.forEach(function(e){t.push(e.clone())}),n.addSimulcastAlternativeStreams(o.RECV,t)}),(s=this.simulcast.getSimulcastStreams(o.RECV))&&s.forEach(function(e){var t=[];e.forEach(function(e){t.push(e.clone())}),n.addSimulcastAlternativeStreams(o.SEND,t)}),this.rids.forEach(function(e){var n=e.clone();n.setDirection(o.reverse(e.getDirection())),t.addRID(n)}),t.setSimulcast(n)}return t},a.prototype.getSimulcast=function(){return this.simulcast},a.prototype.setSimulcast=function(e){this.simulcast=e},a.prototype.getSimulcast03=function(){return this.simulcast_03},a.prototype.setSimulcast03=function(e){this.simulcast_03=e},a.prototype.getSetup=function(){return this.setup},a.prototype.setSetup=function(e){this.setup=e},e.exports=a},function(e,t,n){var r=n(3),i=function(){this.send=[],this.recv=[],this.plainString=null};i.prototype.clone=function(){var e=new i;return this.send.forEach(function(t){var n=[];t.forEach(function(e){n.push(e.clone())}),e.addSimulcastAlternativeStreams(n)}),this.recv.forEach(function(t){var n=[];t.forEach(function(e){n.push(e.clone())}),e.addSimulcastAlternativeStreams(n)}),e},i.prototype.plain=function(){var e={send:[],recv:[]};return this.send.forEach(function(t){var n=[];t.forEach(function(e){n.push(e.plain())}),e.send.push(n)}),this.recv.forEach(function(t){var n=[];t.forEach(function(e){n.push(e.plain())}),e.recv.push(n)}),e},i.prototype.addSimulcastAlternativeStreams=function(e,t){return e===r.SEND?this.send.push(t):this.recv.push(t)},i.prototype.addSimulcastStream=function(e,t){return e===r.SEND?this.send.push([t]):this.recv.push([t])},i.prototype.getSimulcastStreams=function(e){return e===r.SEND?this.send:this.recv},i.prototype.setSimulcastPlainString=function(e){this.plainString=e},i.prototype.getSimulcastPlainString=function(){return this.plainString},e.exports=i},function(e,t){var n=function(e,t){var n=this;this.semantics=e,this.ssrcs=[],t.forEach(function(e){n.ssrcs.push(parseInt(e,10))})};n.prototype.clone=function(){return new n(this.semantics,this.ssrcs)},n.prototype.plain=function(){var e={semantics:this.semantics,ssrcs:[]};return e.ssrcs=this.ssrcs,e},n.prototype.getSemantics=function(){return this.semantics},n.prototype.getSSRCs=function(){return this.ssrcs},e.exports=n},function(e,t){var n=function(e){this.ssrc=e};n.prototype.clone=function(){var e=new n(this.ssrc);e.setCName(this.cname),e.setStreamId(this.streamId),this.setTrackId(this.trackId)},n.prototype.plain=function(){var e={ssrc:this.ssrc};return this.cname&&(e.cname=this.cname),this.label&&(e.label=this.label),this.mslabel&&(e.mslabel=this.mslabel),this.streamId&&(e.streamId=this.streamId),this.trackId&&(e.trackid=this.trackId),e},n.prototype.getCName=function(){return this.cname},n.prototype.setCName=function(e){this.cname=e},n.prototype.getStreamId=function(){return this.streamId},n.prototype.setStreamId=function(e){this.streamId=e},n.prototype.getTrackId=function(){return this.trackId},n.prototype.setTrackId=function(e){this.trackId=e},n.prototype.getMSLabel=function(){return this.mslabel},n.prototype.setMSLabel=function(e){this.mslabel=e},n.prototype.getLabel=function(){return this.label},n.prototype.setLabel=function(e){this.label=e},n.prototype.getSSRC=function(){return this.ssrc},e.exports=n},function(e,t){var n=function(e){this.id=e,this.tracks=new Map};n.prototype.clone=function(){var e=new n(this.id);return this.tracks.forEach(function(t){e.addTrack(t.clone())}),e},n.prototype.plain=function(){var e={id:this.id,tracks:[]};return this.tracks.forEach(function(t){e.tracks.push(t.plain())}),e},n.prototype.getId=function(){return this.id},n.prototype.addTrack=function(e){this.tracks.set(e.getId(),e)},n.prototype.getFirstTrack=function(e){var t;return this.tracks.forEach(function(n){n.getMedia().toLowerCase()===e.toLowerCase()&&(t=n)}),t},n.prototype.getTracks=function(){return this.tracks},n.prototype.removeAllTracks=function(){this.tracks.clear()},n.prototype.getTrack=function(e){return this.tracks.get(e)},e.exports=n},function(e,t){var n=function(e,t){this.media=e,this.id=t,this.ssrcs=[],this.groups=[],this.encodings=[]};n.prototype.clone=function(){var e=new n(this.media,this.id);return this.mediaId&&e.setMediaId(this.mediaId),this.ssrcs.forEach(function(t){e.addSSRC(t)}),this.groups.forEach(function(t){e.addSourceGroup(t.clone())}),this.encodings.forEach(function(t){var n=[];t.forEach(function(e){n.push(e.cloned())}),e.addAlternativeEncoding(n)}),e},n.prototype.plain=function(){var e={media:this.media,id:this.id,ssrcs:[],groups:[],encodings:[]};return this.mediaId&&(e.mediaId=this.mediaId),this.ssrcs.forEach(function(t){e.ssrcs.push(t)}),this.groups.forEach(function(t){e.groups.push(t.plain())}),this.encodings.forEach(function(t){var n=[];t.forEach(function(e){n.push(e.plain())}),e.encodings.push(n)}),e},n.prototype.getMedia=function(){return this.media},n.prototype.setMediaId=function(e){this.mediaId=e},n.prototype.getMediaId=function(){return this.mediaId},n.prototype.getId=function(){return this.id},n.prototype.addSSRC=function(e){this.ssrcs.push(e)},n.prototype.getSSRCs=function(){return this.ssrcs},n.prototype.addSourceGroup=function(e){this.groups.push(e)},n.prototype.getSourceGroup=function(e){var t;return this.groups.forEach(function(n){n.getSemantics().toLowerCase()===e.toLowerCase()&&(t=n)}),t},n.prototype.getSourceGroups=function(){return this.groups},n.prototype.hasSourceGroup=function(e){var t=!1;return this.groups.forEach(function(n){n.getSemantics().toLowerCase()===e.toLowerCase()&&(t=!0)}),t},n.prototype.getEncodings=function(){return this.encodings},n.prototype.addAlternaticeEncodings=function(e){this.encodings.push(e)},n.prototype.setEncodings=function(e){this.encodings=e},e.exports=n},function(e,t,n){t.a={addSim:function(e){var t="a=ssrc-group:SIM";return e.forEach(function(e){t+=" "+e}),t+"\r\n"},addGroup:function(e,t){return"a=ssrc-group:FID "+e+" "+t+"\r\n"},addSpatialLayer:function(e,t,n,r,i,o){return"a=ssrc:"+i+" cname:"+e+"\r\na=ssrc:"+i+" msid:"+t+"\r\na=ssrc:"+i+" mslabel:"+n+"\r\na=ssrc:"+i+" label:"+r+"\r\na=ssrc:"+o+" cname:"+e+"\r\na=ssrc:"+o+" msid:"+t+"\r\na=ssrc:"+o+" mslabel:"+n+"\r\na=ssrc:"+o+" label:"+r+"\r\n"},setMaxBW:function(e,t){if(t.p2p){if(t.video&&t.maxVideoBW){var n=e.getMedia("video");n&&n.setBitrate(t.maxVideoBW)}t.audio&&t.maxAudioBW&&(e=e.getMedia("audio"))&&e.setBitrate(t.maxAudioBW)}},enableOpusNacks:function(e){var t=e.match(/a=rtpmap:(.*)opus.*\r\n/);return null!==t&&(e=e.replace(t[0],t[0]+"a=rtcp-fb:"+t[1]+"nack\r\n")),e},setParamForCodecs:function(e,t,n,r){e.medias.forEach(function(e){e.id===t&&e.codecs.forEach(function(e){e.setParam(n,r)})})}}},function(e,t,n){var r=this,i=n(1),o=n(8),a=n(7),s=n(44),c=n(46),d=n(0);t.a=function(e,t){var n=Object(i.b)(t);n.stream=t.stream,n.url=t.url,n.recording=t.recording,n.room=void 0,n.showing=!1,n.local=!1,n.video=t.video,n.audio=t.audio,n.screen=t.screen,n.videoSize=t.videoSize,n.videoFrameRate=t.videoFrameRate,n.extensionId=t.extensionId,n.desktopStreamId=t.desktopStreamId,n.audioMuted=!1,n.videoMuted=!1,n.unsubscribing={callbackReceived:!1,pcEventReceived:!1},n.p2p=!1,n.ConnectionHelpers=void 0===e?o.a:e;var u=function(e){e.stream.id===n.getLabel()&&n.emit(Object(i.f)({type:"added",stream:e.stream}))},l=function(e){e.stream.id===n.getLabel()&&n.emit(Object(i.f)({type:"removed",stream:n}))},p=function(e){n.emit(Object(i.f)({type:"icestatechanged",msg:e}))};if(!(void 0===n.videoSize||n.videoSize instanceof Array&&4===n.videoSize.length))throw Error("Invalid Video Size");void 0!==t.local&&!0!==t.local||(n.local=!0),n.getID=function(){return n.local&&!t.streamID?"local":t.streamID},n.getLabel=function(){return n.stream&&n.stream.id?n.stream.id:t.label},n.getAttributes=function(){return t.attributes},n.setAttributes=function(e){n.local?n.emit(Object(i.f)({type:"internal-set-attributes",stream:n,attrs:e})):d.a.error("Failed to set attributes data. This Stream object has not been published.")},n.updateLocalAttributes=function(e){t.attributes=e},n.hasAudio=function(){return!1!==t.audio&&void 0!==t.audio},n.hasVideo=function(){return!1!==t.video&&void 0!==t.video},n.hasData=function(){return!1!==t.data&&void 0!==t.data},n.hasScreen=function(){return t.screen},n.hasMedia=function(){return t.audio||t.video||t.screen},n.isExternal=function(){return void 0!==n.url||void 0!==n.recording},n.addPC=function(e,t){t?(n.p2p=!0,void 0===n.pc&&(n.pc=Object(a.a)()),n.pc.add(t,e),e.on("ice-state-change",p)):(n.pc&&(n.pc.off("add-stream",u),n.pc.off("remove-stream",l),n.pc.off("ice-state-change",p)),n.pc=e,n.pc.on("add-stream",u),n.pc.on("remove-stream",l),n.pc.on("ice-state-change",p))},n.sendData=function(e){n.local&&n.hasData()?n.emit(Object(i.f)({type:"internal-send-data",stream:n,msg:e})):d.a.error("Failed to send data. This Stream object has not been published.")},n.init=function(){try{if((t.audio||t.video||t.screen)&&void 0===t.url){d.a.info("Requested access to local media");var e=t.video;!0===e||!0===t.screen?(e=!0===e||null===e?{}:e,void 0!==n.videoSize&&(e.width={min:n.videoSize[0],max:n.videoSize[2]},e.height={min:n.videoSize[1],max:n.videoSize[3]}),void 0!==n.videoFrameRate&&(e.frameRate={min:n.videoFrameRate[0],max:n.videoFrameRate[1]})):!0===t.screen&&void 0===e&&(e=!0),n.ConnectionHelpers.GetUserMedia({video:e,audio:t.audio,fake:t.fake,screen:t.screen,extensionId:n.extensionId,desktopStreamId:n.desktopStreamId},function(e){d.a.info("User has granted access to local media."),n.stream=e,n.dispatchEvent(Object(i.f)({type:"access-accepted"})),n.stream.getTracks().forEach(function(e){d.a.info("getTracks",e),e.onended=function(){n.stream.getTracks().forEach(function(e){e.onended=null});var t=Object(i.f)({type:"stream-ended",stream:n,msg:e.kind});n.dispatchEvent(t)}})},function(e){d.a.error("Failed to get access to local media. Error code was "+e.code+"."),e=Object(i.f)({type:"access-denied",msg:e}),n.dispatchEvent(e)})}else{var r=Object(i.f)({type:"access-accepted"});n.dispatchEvent(r)}}catch(t){d.a.error("Failed to get access to local media. Error was "+t+"."),e=Object(i.f)({type:"access-denied",msg:t}),n.dispatchEvent(e)}},n.close=function(){n.local&&(void 0!==n.room&&n.room.unpublish(n),n.hide(),void 0!==n.stream&&n.stream.getTracks().forEach(function(e){e.onended=null,e.stop()}),n.stream=void 0),n.pc&&!n.p2p?(n.pc.off("add-stream",u),n.pc.off("remove-stream",l),n.pc.off("ice-state-change",p)):n.pc&&n.p2p&&n.pc.forEach(function(e){e.off("add-stream",u),e.off("remove-stream",l),e.off("ice-state-change",p)}),n.removeAllListeners()},n.play=function(e,t){t=t||{},n.elementID=e,n.hasVideo()||n.hasScreen()?void 0!==e&&(e=Object(s.a)({id:n.getID(),stream:n,elementID:e,options:t}),n.player=e,n.showing=!0):n.hasAudio()&&(e=Object(c.a)({id:n.getID(),stream:n,elementID:e,options:t}),n.player=e,n.showing=!0)},n.stop=function(){n.showing&&void 0!==n.player&&(n.player.destroy(),n.showing=!1)},n.show=n.play,n.hide=n.stop;var f=function(){if(void 0!==n.player&&void 0!==n.stream){var e=n.player.video,t=document.defaultView.getComputedStyle(e),r=parseInt(t.getPropertyValue("width"),10),i=parseInt(t.getPropertyValue("height"),10),o=parseInt(t.getPropertyValue("left"),10),a=(t=parseInt(t.getPropertyValue("top"),10),"object"==typeof n.elementID&&"function"==typeof n.elementID.appendChild?n.elementID:document.getElementById(n.elementID)),s=document.defaultView.getComputedStyle(a);a=parseInt(s.getPropertyValue("width"),10);s=parseInt(s.getPropertyValue("height"),10);var c=document.createElement("canvas");return c.id="testing",c.width=a,c.height=s,c.setAttribute("style","display: none"),c.getContext("2d").drawImage(e,o,t,r,i),c}return null};n.getVideoFrameURL=function(e){var t=f();return null!==t?e?t.toDataURL(e):t.toDataURL():null},n.getVideoFrame=function(){var e=f();return null!==e?e.getContext("2d").getImageData(0,0,e.width,e.height):null},n.checkOptions=function(e,t){!0===t?(e.audio||e.screen)&&(d.a.warning("Cannot update type of subscription"),e.audio=void 0,e.screen=void 0):!1===n.local&&(!0===e.video&&!1===n.hasVideo()&&(d.a.warning("Trying to subscribe to video when there is no video, won't subscribe to video"),e.video=!1),!0===e.audio&&!1===n.hasAudio()&&(d.a.warning("Trying to subscribe to audio when there is no audio, won't subscribe to audio"),e.audio=!1)),!1!==n.local||n.hasVideo()||!0!==e.slideShowMode||(d.a.warning("Cannot enable slideShowMode if it is not a video subscription, please check your parameters"),e.slideShowMode=!1)};var h=function(e){if(e=void 0===e?function(){}:e,n.room&&n.room.p2p)d.a.warning("muteAudio/muteVideo are not implemented in p2p streams"),e("error");else{if(n.stream)for(var t=0;t<n.stream.getVideoTracks().length;t+=1)n.stream.getVideoTracks()[t].enabled=!n.videoMuted;t={muteStream:{audio:n.audioMuted,video:n.videoMuted}},n.checkOptions(t,!0),n.pc&&n.pc.updateSpec(t,n.getID(),e)}};n.muteAudio=function(e,t){n.audioMuted=e,h(void 0===t?function(){}:t)},n.muteVideo=function(e,t){n.videoMuted=e,h(void 0===t?function(){}:t)},n._setStaticQualityLayer=function(e,t,r){r=void 0===r?function(){}:r,n.room&&n.room.p2p?(d.a.warning("setStaticQualityLayer is not implemented in p2p streams"),r("error")):(e={qualityLayer:{spatialLayer:e,temporalLayer:t}},n.checkOptions(e,!0),n.pc.updateSpec(e,n.getID(),r))},n._setDynamicQualityLayer=function(e){if(n.room&&n.room.p2p)d.a.warning("setDynamicQualityLayer is not implemented in p2p streams"),e("error");else{var t={qualityLayer:{spatialLayer:-1,temporalLayer:-1}};n.checkOptions(t,!0),n.pc.updateSpec(t,n.getID(),e)}},n._enableSlideShowBelowSpatialLayer=function(e,t,r){t=void 0===t?0:t,r=void 0===r?function(){}:r,n.room&&n.room.p2p?(d.a.warning("enableSlideShowBelowSpatialLayer is not implemented in p2p streams"),r("error")):(e={slideShowBelowLayer:{enabled:e,spatialLayer:t}},n.checkOptions(e,!0),d.a.debug("Calling updateSpec with config",e),n.pc.updateSpec(e,n.getID(),r))},n._setMinSpatialLayer=n._enableSlideShowBelowSpatialLayer.bind(r,!0);var m=function(e,t,r){!0!==t&&(t=!1),0<(e=(e="string"==typeof e?[e]:e)instanceof Array?e:[]).length&&n.room.sendControlMessage(n,"control",{name:"controlhandlers",enable:r,publisherSide:t,handlers:e})};return n.disableHandlers=function(e,t){m(e,t,!1)},n.enableHandlers=function(e,t){m(e,t,!0)},n.updateConfiguration=function(e,t){if(t=void 0===t?function(){}:t,void 0!==e)if(n.pc)if(n.checkOptions(e,!0),n.local)if(n.room.p2p)for(var r=0;r<n.pc.length;r+=1)n.pc[r].updateSpec(e,n.getID(),t);else n.pc.updateSpec(e,n.getID(),t);else n.pc.updateSpec(e,n.getID(),t);else t("This stream has no peerConnection attached, ignoring")},n}},function(e,t,n){var r=n(5),i=n(45);t.a=function(e){var t,n=Object(r.a)({});n.elementID=e.elementID,n.id=e.id,n.div=document.createElement("div"),n.div.setAttribute("id","bar_"+n.id),n.div.setAttribute("class","licode_bar"),n.bar=document.createElement("div"),n.bar.setAttribute("style","width: 100%; height: 15%; max-height: 30px; position: absolute; bottom: 0; right: 0; background-color: rgba(255,255,255,0.62)"),n.bar.setAttribute("id","subbar_"+n.id),n.bar.setAttribute("class","licode_subbar"),n.link=document.createElement("a"),n.link.setAttribute("href","http://www.lynckia.com/"),n.link.setAttribute("class","licode_link"),n.link.setAttribute("target","_blank"),n.logo=document.createElement("img"),n.logo.setAttribute("style","width: 100%; height: 100%; max-width: 30px; position: absolute; top: 0; left: 2px;"),n.logo.setAttribute("class","licode_logo"),n.logo.setAttribute("alt","Lynckia"),n.logo.setAttribute("src",n.url+"/assets/star.svg");var o=function(e){var r=e;"block"!==e?r="none":clearTimeout(t),n.div.setAttribute("style","width: 100%; height: 100%; position: relative; bottom: 0; right: 0; display: "+r)};return n.display=function(){o("block")},n.hide=function(){t=setTimeout(o,1e3)},document.getElementById(n.elementID).appendChild(n.div),n.div.appendChild(n.bar),n.bar.appendChild(n.link),n.link.appendChild(n.logo),e.stream.screen||void 0!==e.options&&void 0!==e.options.speaker&&!0!==e.options.speaker||(n.speaker=Object(i.a)({elementID:"subbar_"+n.id,id:n.id,stream:e.stream,media:e.media})),n.display(),n.hide(),n}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),e=n(25);var r=n(1),i=n(22),o=n(0);n(48),n(51),n={Room:e.a.bind(null,void 0,void 0,void 0),LicodeEvent:r.d,RoomEvent:r.e,StreamEvent:r.f,Stream:i.a.bind(null,void 0),UnboundStream:i.a,Logger:o.a},t.default=n},function(e,t,r){var i=r(26),o=r(8),a=r(1),s=r(42),c=r(22),d=r(7),u=r(47),l=r(0);t.a=function(e,t,r,p){var f=Object(a.b)(p);f.remoteStreams=Object(d.a)(),f.localStreams=Object(d.a)(),f.roomID="",f.state=0,f.p2p=!1,f.ConnectionHelpers=void 0===t?o.a:t,f.erizoConnectionManager=void 0===r?new i.a:new r.ErizoConnectionManager;var h=Object(s.a)(e);f.socket=h;var m=f.remoteStreams,y=f.localStreams,g=function(e){e.removeAllListeners(),e.pc&&!f.p2p&&e.pc.removeStream(e),l.a.debug("Removed stream"),e.stream&&(e.hide(),e.stop(),e.close(),delete e.stream),e.pc&&(e.local&&f.p2p?e.pc.forEach(function(t,n){t.close(),e.pc.remove(n)}):(f.erizoConnectionManager.maybeCloseConnection(e.pc),delete e.pc))},v=function(e,t){l.a.info("Stream subscribed"),e.stream=t.stream,f.p2p||e.pc.addStream(e),e.state="subscribed",e=Object(a.f)({type:"stream-subscribed",stream:e}),f.dispatchEvent(e)},E=function(e){l.a.debug("maybeDispatchStreamUnsubscribed - unsubscribe id "+e.getID(),e.unsubscribing),e&&e.unsubscribing.callbackReceived&&(e.unsubscribing.pcEventReceived||e.failed)?(l.a.info("Dispatching Stream unsubscribed "+e.getID()),e.unsubscribing.callbackReceived=!1,e.unsubscribing.pcEventReceived=!1,g(e),delete e.failed,e.state="unsubscribed",e=Object(a.f)({type:"stream-unsubscribed",stream:e}),f.dispatchEvent(e)):l.a.debug("Not dispatching stream unsubscribed yet "+e.getID())},S=function(e,t,n){0!==f.state&&e&&!e.failed&&(e.failed=!0,t=Object(a.f)({type:"stream-failed",msg:t||"Stream failed after connection",stream:e,origin:void 0===n?"unknown":n}),f.dispatchEvent(t),t=e.pc,e.local?f.unpublish(e):e.unsubscribing.callbackReceived?E(e):f.unsubscribe(e),t&&p.singlePC&&f.erizoConnectionManager.maybeCloseConnection(t,!0))},_=function(e,t){return{callback:function(n,r){h.sendSDP("streamMessageP2P",{streamId:e.getID(),streamIds:r,peerSocket:t,msg:n})},audio:e.hasAudio(),video:e.hasVideo(),iceServers:f.iceServers,maxAudioBW:e.maxAudioBW,maxVideoBW:e.maxVideoBW,limitMaxAudioBW:p.maxAudioBW,limitMaxVideoBW:p.maxVideoBW,forceTurn:e.forceTurn,p2p:!0}},T=function(e){f.remoteStreams.forEach(function(t){t.local||t.getLabel()!==e||(t.unsubscribing.pcEventReceived=!0,E(t))})},b=function(e,t,n,r,i){var o={callback:function(r,i){i=void 0===i?e.getID():i,l.a.info("Sending message",r,e.getID(),i),r&&r.type&&"updatestream"===r.type?h.sendSDP("streamMessage",{streamId:i,erizoId:n,msg:r,browser:e.pc&&e.pc.browser},void 0,function(){}):h.sendSDP("connectionMessage",{connectionId:t,erizoId:n,msg:r,browser:e.pc&&e.pc.browser},void 0,function(){})},connectionId:t,nop2p:!0,audio:r.audio&&e.hasAudio(),video:r.video&&e.hasVideo(),maxAudioBW:r.maxAudioBW,maxVideoBW:r.maxVideoBW,limitMaxAudioBW:p.maxAudioBW,limitMaxVideoBW:p.maxVideoBW,label:e.getLabel(),iceServers:f.iceServers,forceTurn:e.forceTurn,p2p:!1,streamRemovedListener:T};return i||(o.simulcast=r.simulcast,o.startVideoBW=r.startVideoBW,o.hardMinVideoBW=r.hardMinVideoBW),o},C=function(e,t,n,r){var i=b(e,t,n,r,!0);e.addPC(f.erizoConnectionManager.getOrBuildErizoConnection(i,n,p.singlePC)),e.on("added",v.bind(null,e)),e.on("icestatechanged",function(t){l.a.info(e.getID()+" - iceConnectionState: "+t.msg.state),"failed"===t.msg.state&&(S(e,"ICE Connection Failed","ice-client"),p.singlePC&&i.callback({type:"failed"}))})},R=function(e){var t=e.stream;e=e.msg,t.local?h.sendMessage("sendDataStream",{id:t.getID(),msg:e}):l.a.error("You can not send data through a remote stream")},I=function(e){var t=e.stream;e=e.attrs,t.local?(t.updateLocalAttributes(e),h.sendMessage("updateStreamAttributes",{id:t.getID(),attrs:e})):l.a.error("You can not update attributes in a remote stream")};e=function(e,t){t.args?e.apply(null,[].concat(n.arrayFromIterable(t.args))):e()};var A=function(e,t,n){return{state:e,data:t.hasData(),audio:t.hasAudio(),video:t.hasVideo(),label:t.getLabel(),screen:t.hasScreen(),attributes:t.getAttributes(),metadata:n.metadata,createOffer:n.createOffer,muteStream:n.muteStream}},O=function(e,t,n,r){r=void 0===r?function(){}:r,null===e?(l.a.error("Error when publishing the stream",n),r(void 0,n)):(l.a.info("Stream published"),t.getID=function(){return e},t.on("internal-send-data",R),t.on("internal-set-attributes",I),y.add(e,t),t.room=f,r(e))},P=function(e,t,n){n=void 0===n?function(){}:n,l.a.info("Publishing to Erizo Normally, is createOffer",t.createOffer);var r=A("erizo",e,t);r.minVideoBW=t.minVideoBW,r.maxVideoBW=t.maxVideoBW,r.scheme=t.scheme,h.sendSDP("publish",r,void 0,function(r,i,o,a){null===r?(l.a.error("Error publishing stream",a),n(void 0,a)):(O(r,e,a,void 0),function(e,t,n,r){var i=b(e,t,n,r);e.addPC(f.erizoConnectionManager.getOrBuildErizoConnection(i,n,p.singlePC)),e.on("icestatechanged",function(t){l.a.info(e.getID()+" - iceConnectionState: "+t.msg.state),"failed"===t.msg.state&&(S(e,"ICE Connection Failed","ice-client"),p.singlePC&&i.callback({type:"failed"}))}),e.pc.addStream(e)}(e,o,i,t),n(r))})},w=function(e,t){e=t&&e.hasVideo();var n=t&&t.width,r=t&&t.height;return t=t&&t.frameRate,n||r||t?{width:n,height:r,frameRate:t}:e};return f.connect=function(e){e=void 0===e?{}:e;var t=u.a.decodeBase64(p.token);0!==f.state&&l.a.warning("Room already connected, roomId: "+f.roomID),f.state=1,h.connect(JSON.parse(t),e,function(e){var t=[],n=e.streams||[],r=e.id;f.p2p=e.p2p,f.iceServers=e.iceServers,f.state=2,p.singlePC=e.singlePC,p.defaultVideoBW=e.defaultVideoBW,p.maxVideoBW=e.maxVideoBW;for(var i=Object.keys(n),o=0;o<i.length;o+=1){var s=n[i[o]];(e=Object(c.a)(f.ConnectionHelpers,{streamID:s.id,local:!1,audio:s.audio,video:s.video,data:s.data,label:s.label,screen:s.screen,attributes:s.attributes})).room=f,e.state="unsubscribed",t.push(e),m.add(s.id,e)}f.roomID=r,l.a.info("Connected to room, roomId "+f.roomID),t=Object(a.e)({type:"room-connected",streams:t}),f.dispatchEvent(t)},function(e){l.a.error("Error connecting to room, roomId: "+f.roomID+", Error:",e),e=Object(a.e)({type:"room-error",message:e}),f.dispatchEvent(e)})},f.disconnect=function(){l.a.debug("Disconnection requested");var e=Object(a.e)({type:"room-disconnected",message:"expected-disconnection"});f.dispatchEvent(e)},f.publish=function(e,t,n){n=void 0===n?function(){}:n,(t=void 0===t?{}:t).maxVideoBW=t.maxVideoBW||p.defaultVideoBW,t.maxVideoBW>p.maxVideoBW&&(t.maxVideoBW=p.maxVideoBW),void 0===t.minVideoBW&&(t.minVideoBW=0),t.minVideoBW>p.defaultVideoBW&&(t.minVideoBW=p.defaultVideoBW),e.forceTurn=t.forceTurn,t.simulcast=t.simulcast||!1,t.muteStream={audio:e.audioMuted,video:e.videoMuted},e&&e.local&&!e.failed&&!y.has(e.getID())?e.hasMedia()?e.isExternal()?function(e,t,n){if(n=void 0===n?function(){}:n,e.url)var r="url",i=e.url;else r="recording",i=e.recording;l.a.info("Checking publish options for",e.getID()),e.checkOptions(t),h.sendSDP("publish",A(r,e,t),i,function(t,r){O(t,e,r,n)})}(e,t,n):f.p2p?function(e,t,n){n=void 0===n?function(){}:n,e.maxAudioBW=t.maxAudioBW,e.maxVideoBW=t.maxVideoBW,h.sendSDP("publish",A("p2p",e,t),void 0,function(t,r){O(t,e,r,n)})}(e,t,n):P(e,t,n):e.hasData()&&function(e,t,n){n=void 0===n?function(){}:n,h.sendSDP("publish",A("data",e,t),void 0,function(t,r){O(t,e,r,n)})}(e,t,n):(l.a.error("Trying to publish invalid stream, stream:",e),n(void 0,"Invalid Stream"))},f.startRecording=function(e,t){t=void 0===t?function(){}:t,void 0===e?(l.a.error("Trying to start recording on an invalid stream, stream:",e),t(void 0,"Invalid Stream")):(l.a.debug("Start Recording stream, streamId: "+e.getID()),h.sendMessage("startRecorder",{to:e.getID()},function(n,r){null===n?(l.a.error("Error on start recording, streamId: "+e.getID()+", error:",r),t(void 0,r)):(l.a.info("Start recording",n),t(n))}))},f.stopRecording=function(e,t){t=void 0===t?function(){}:t,h.sendMessage("stopRecorder",{id:e},function(n,r){null===n?(l.a.error("Error on stop recording, recordingId: "+e+", error:",r),t(void 0,r)):(l.a.info("Stop recording",e),t(!0))})},f.unpublish=function(e,t){if(t=void 0===t?function(){}:t,e&&e.local){if(h.sendMessage("unpublish",e.getID(),function(n,r){null===n?(l.a.error("Error unpublishing stream, streamId: "+e.getID()+", error:",r),t(void 0,r)):(delete e.failed,t(!0))}),l.a.info("Stream unpublished, streamId: "+e.getID()),e.room=void 0,e.hasMedia()&&!e.isExternal()){var n=y.has(e.getID())?y.get(e.getID()):e;g(n)}y.remove(e.getID()),e.getID=function(){},e.off("internal-send-data",R),e.off("internal-set-attributes",I)}else l.a.error("Cannot unpublish, stream does not exist or is not local"),t(void 0,"Cannot unpublish, stream does not exist or is not local")},f.sendControlMessage=function(e,t,n){e&&e.getID()&&(t={type:"control",action:n},h.sendSDP("streamMessage",{streamId:e.getID(),msg:t}))},f.subscribe=function(e,t,n){if(t=void 0===t?{}:t,n=void 0===n?function(){}:n,!e||e.local||e.failed)t="Error on subscribe",e.state="unsubscribed",e?e.local?(l.a.warning("Cannot subscribe to local stream, you should subscribe to the remote version of your local stream"),t="Local copy of stream"):e.failed&&(l.a.warning("Cannot subscribe to failed stream, streamId: "+e.getID()+", unsubscribing:",e.unsubscribing," failed: ",e.failed),t="Failed stream"):(l.a.warning("Cannot subscribe to invalid stream, streamId: "+e.getID()),t="Invalid or undefined stream"),n(void 0,t);else if("unsubscribed"!==e.state)l.a.warning("Cannot subscribe to a subscribed stream, streamId: "+e.getID()),n(void 0,"Stream already subscribed");else{if(e.state="subscribing",e.hasMedia())if(e.hasVideo()||e.hasScreen()||(t.video=!1),e.hasAudio()||(t.audio=!1),t.muteStream={audio:e.audioMuted,video:e.videoMuted},e.forceTurn=t.forceTurn,f.p2p){var r=m.get(e.getID());r.maxAudioBW=t.maxAudioBW,r.maxVideoBW=t.maxVideoBW,h.sendSDP("subscribe",{streamId:e.getID(),metadata:t.metadata}),n(!0)}else!function(e,t,n){n=void 0===n?function(){}:n,t.maxVideoBW=t.maxVideoBW||p.defaultVideoBW,t.maxVideoBW>p.maxVideoBW&&(t.maxVideoBW=p.maxVideoBW),t.audio=void 0===t.audio||t.audio,t.video=void 0===t.video||t.video,t.data=void 0===t.data||t.data,e.checkOptions(t);var r={streamId:e.getID(),audio:t.audio&&e.hasAudio(),video:w(e,t.video),maxVideoBW:t.maxVideoBW,data:t.data&&e.hasData(),browser:f.ConnectionHelpers.getBrowser(),createOffer:t.createOffer,metadata:t.metadata,muteStream:t.muteStream,slideShowMode:t.slideShowMode};h.sendSDP("subscribe",r,void 0,function(r,i,o,a){null===r?(l.a.error("Error subscribing to stream, streamId: "+e.getID()+", error:",a),e.state="unsubscribed",n(void 0,a)):(l.a.info("Subscriber added",i,o),C(e,o,i,t),e.pc.sendOffer(),n(!0))})}(e,t,n);else{if(!e.hasData()||!1===t.data)return l.a.warning("There is nothing to subscribe to in stream, streamId: "+e.getID()),e.state="unsubscribed",void n(void 0,"Nothing to subscribe to");!function(e,t,n){n=void 0===n?function(){}:n,h.sendSDP("subscribe",{streamId:e.getID(),data:t.data,metadata:t.metadata},void 0,function(t,r){null===t?(l.a.error("Error subscribing to stream, streamId: "+e.getID()+", error:",r),e.state="unsubscribed",n(void 0,r)):(l.a.info("Stream subscribed"),t=Object(a.f)({type:"stream-subscribed",stream:e}),f.dispatchEvent(t),n(!0))})}(e,t,n)}l.a.info("Subscribing to: "+e.getID())}},f.unsubscribe=function(e,t){t=void 0===t?function(){}:t,void 0!==h&&(e&&!e.local?"subscribed"!==e.state?(l.a.warning("Cannot unsubscribe to a stream that is not subscribed, streamId: "+e.getID()),t(void 0,"Stream not subscribed")):(e.state="unsubscribing",h.sendMessage("unsubscribe",e.getID(),function(n,r){null===n?(e.state="subscribed",t(void 0,r)):(t(!0),e.unsubscribing.callbackReceived=!0,E(e))},function(){e.state="subscribed",l.a.error("Error calling unsubscribe, streamId: "+e.getID())})):(e.state="unsubscribed",t(void 0,"Error unsubscribing, stream does not exist or is not local")))},f.autoSubscribe=function(e,t,n,r){h&&h.sendMessage("autoSubscribe",{selectors:e,negativeSelectors:t,options:n},function(e){e&&r(e)})},f.getStreamStats=function(e,t){return t=void 0===t?function(){}:t,h?e?void h.sendMessage("getStreamStats",e.getID(),function(e){e&&t(e)}):"Error getting stats - no stream":"Error getting stats - no socket"},f.getStreamsByAttribute=function(e,t){var n=[];return m.forEach(function(r){void 0!==r.getAttributes()&&r.getAttributes()[e]===t&&n.push(r)}),n},f.on("room-disconnected",function(){f.state=0,h.state=h.DISCONNECTED,m.forEach(function(e,t){g(e),m.remove(t),e&&!e.failed&&(e=Object(a.f)({type:"stream-removed",stream:e}),f.dispatchEvent(e))}),m=Object(d.a)(),y.forEach(function(e,t){g(e),y.remove(t)}),y=Object(d.a)();try{h.disconnect()}catch(e){l.a.debug("Socket already disconnected")}h=void 0}),h.on("onAddStream",e.bind(null,function(e){if(!m.has(e.id)){var t=Object(c.a)(f.Connection,{streamID:e.id,local:y.has(e.id),audio:e.audio,video:e.video,data:e.data,label:e.label,screen:e.screen,attributes:e.attributes});t.room=f,t.state="unsubscribed",m.add(e.id,t),e=Object(a.f)({type:"stream-added",stream:t}),f.dispatchEvent(e)}})),h.on("stream_message_erizo",e.bind(null,function(e){"auto-streams-subscription"===e.context?function(e){var t,n=e.streamIds,r=e.erizoId,i=e.connectionId,o=e.options;switch(e.type){case"multiple-initializing":n.forEach(function(e){t=m.get(e),C(t,i,r,o)})}}(e.mess):"auto-streams-unsubscription"===e.context?function(e){var t;(e=e.streamIds).forEach(function(e){t=m.get(e)}),e.forEach(function(e){t=m.get(e),g(t),delete t.failed})}(e.mess):l.a.debug("Failed applying a stream message from erizo",e)})),h.on("stream_message_p2p",e.bind(null,function(e){var t=y.get(e.streamId);t&&!t.failed?t.pc.get(e.peerSocket).processSignalingMessage(e.msg):((t=m.get(e.streamId)).pc||function(e,t){e.addPC(f.erizoConnectionManager.getOrBuildErizoConnection(_(e,t))),e.on("added",v.bind(null,e)),e.on("icestatechanged",function(t){l.a.info(e.getID()+" - iceConnectionState: "+t.msg.state),"failed"===t.msg.state&&S(e,"ICE Connection Failed","ice-client")})}(t,e.peerSocket),t.pc.processSignalingMessage(e.msg))})),h.on("connection_message_erizo",e.bind(null,function(e){var t=!1;y.forEach(function(n){t||n.failed||!n.pc||n.pc.connectionId!==e.connectionId||(n.pc.processSignalingMessage(e.evt),t=!0)}),t||(m.forEach(function(n){t||n.failed||!n.pc||n.pc.connectionId!==e.connectionId||(n.pc.processSignalingMessage(e.evt),t=!0)}),t||l.a.warning("Received signaling message to unknown connectionId",e.connectionId))})),h.on("publish_me",e.bind(null,function(e){!function(e,t){var n=f.erizoConnectionManager.getOrBuildErizoConnection(_(e,t));e.addPC(n,t),e.on("icestatechanged",function(n){l.a.info(e.getID()+" - iceConnectionState: "+n.msg.state),"failed"===n.msg.state&&(e.pc.get(t).close(),e.pc.remove(t))}),n.addStream(e)}(y.get(e.streamId),e.peerSocket)})),h.on("unpublish_me",e.bind(null,function(e){var t=y.get(e.streamId);t&&(e=e.peerSocket,void 0!==t.pc&&t.pc.has(e)&&(t.pc.get(e).close(),t.pc.remove(e)))})),h.on("onBandwidthAlert",e.bind(null,function(e){if(l.a.info("Bandwidth Alert on",e.streamID,"message",e.message,"BW:",e.bandwidth),e.streamID){var t=m.get(e.streamID);t&&!t.failed&&(e=Object(a.f)({type:"bandwidth-alert",stream:t,msg:e.message,bandwidth:e.bandwidth}),t.dispatchEvent(e))}})),h.on("onDataStream",e.bind(null,function(e){var t=m.get(e.id);e=Object(a.f)({type:"stream-data",msg:e.msg,stream:t}),t.dispatchEvent(e)})),h.on("onUpdateAttributeStream",e.bind(null,function(e){var t=m.get(e.id),n=Object(a.f)({type:"stream-attributes-update",attrs:e.attrs,stream:t});t.updateLocalAttributes(e.attrs),t.dispatchEvent(n)})),h.on("onRemoveStream",e.bind(null,function(e){var t=y.get(e.id);t?S(t,"Stream removed from server","server"):(t=m.get(e.id))&&(g(t),m.remove(e.id),e=Object(a.f)({type:"stream-removed",stream:t}),f.dispatchEvent(e))})),h.on("disconnect",e.bind(null,function(){if(l.a.info("Socket disconnected, lost connection to ErizoController"),0!==f.state){l.a.error("Unexpected disconnection from ErizoController");var e=Object(a.e)({type:"room-disconnected",message:"unexpected-disconnection"});f.dispatchEvent(e)}})),h.on("connection_failed",e.bind(null,function(e){if(e.streamId){var t="ICE Connection Failed on "+e.type+" "+e.streamId+" "+f.state;l.a.error(t),e="publish"===e.type?y.get(e.streamId):m.get(e.streamId),S(e,t,"ice-server")}})),h.on("error",e.bind(null,function(e){l.a.error("Cannot connect to erizo Controller"),e=Object(a.e)({type:"room-error",message:e}),f.dispatchEvent(e)})),f}},function(e,t,r){var i=r(27),o=r(39),a=r(40),s=r(0),c=r(1),d=r(7),u=r(8),l=c.c,p=103,f=function(e,t){var n=l.call(this)||this;if(s.a.debug("Building a new Connection"),n.stack={},n.erizoId=t,n.streamsMap=Object(d.a)(),p+=1,e.sessionId=p,n.sessionId=p,n.connectionId=e.connectionId,e.streamRemovedListener||(e.streamRemovedListener=function(){}),n.streamRemovedListener=e.streamRemovedListener,n.browser=u.a.getBrowser(),"fake"===n.browser)s.a.warning("Publish/subscribe video/audio streams not supported in erizofc yet"),n.stack=Object(a.a)(e);else if("mozilla"===n.browser)s.a.debug("Firefox Stack"),n.stack=Object(o.a)(e);else if("safari"===n.browser)s.a.debug("Safari using Chrome Stable Stack"),n.stack=Object(i.a)(e);else{if("chrome-stable"!==n.browser&&"electron"!==n.browser)throw s.a.error("No stack available for this browser"),Error("WebRTC stack not available");s.a.debug("Chrome Stable Stack"),n.stack=Object(i.a)(e)}return n.stack.updateSpec||(n.stack.updateSpec=function(e,t){t=void 0===t?function(){}:t,s.a.error("Update Configuration not implemented in this browser"),t("unimplemented")}),n.stack.setSignallingCallback||(n.stack.setSignallingCallback=function(){s.a.error("setSignallingCallback is not implemented in this stack")}),n.stack.peerConnection&&(n.peerConnection=n.stack.peerConnection,n.stack.peerConnection.onaddstream=function(e){n.emit(Object(c.a)({type:"add-stream",stream:e.stream}))},n.stack.peerConnection.onremovestream=function(e){n.emit(Object(c.a)({type:"remove-stream",stream:e.stream})),n.streamRemovedListener(e.stream.id)},n.stack.peerConnection.oniceconnectionstatechange=function(){n.emit(Object(c.a)({type:"ice-state-change",state:n.stack.peerConnection.iceConnectionState}))}),n};n.inherits(f,l),f.prototype.close=function(){s.a.debug("Closing ErizoConnection"),this.streamsMap.clear(),this.stack.close()},f.prototype.createOffer=function(e,t){this.stack.createOffer(e,t)},f.prototype.sendOffer=function(){this.stack.sendOffer()},f.prototype.addStream=function(e){s.a.debug("message: Adding stream to Connection, streamId: "+e.getID()),this.streamsMap.add(e.getID(),e),e.local&&this.stack.addStream(e.stream)},f.prototype.removeStream=function(e){var t=e.getID();this.streamsMap.has(t)?(this.streamsMap.remove(t),e.local?this.stack.removeStream(e.stream):0===this.streamsMap.size()&&this.streamRemovedListener(e.getLabel())):s.a.debug("message: Cannot remove stream not in map, streamId: "+t)},f.prototype.processSignalingMessage=function(e){this.stack.processSignalingMessage(e)},f.prototype.sendSignalingMessage=function(e){this.stack.sendSignalingMessage(e)},f.prototype.setSimulcast=function(e){this.stack.setSimulcast(e)},f.prototype.setVideo=function(e){this.stack.setVideo(e)},f.prototype.setAudio=function(e){this.stack.setAudio(e)},f.prototype.updateSpec=function(e,t,n){this.stack.updateSpec(e,t,n)},(e=function(){this.ErizoConnectionsMap=new Map}).prototype.getOrBuildErizoConnection=function(e,t,n){if(n=void 0!==n&&n,s.a.debug("message: getOrBuildErizoConnection, erizoId: "+t),void 0===t)return new f(e);if(n)this.ErizoConnectionsMap.has(t)?n=this.ErizoConnectionsMap.get(t):(n={},this.ErizoConnectionsMap.set(t,n)),n["single-pc"]||(n["single-pc"]=new f(e,t)),n=n["single-pc"];else if(n=new f(e,t),this.ErizoConnectionsMap.has(t))this.ErizoConnectionsMap.get(t)[n.sessionId]=n;else{var r={};r[n.sessionId]=n,this.ErizoConnectionsMap.set(t,r)}return e.simulcast&&n.setSimulcast(e.simulcast),e.video&&n.setVideo(e.video),e.audio&&n.setVideo(e.audio),n},e.prototype.maybeCloseConnection=function(e,t){t=void 0!==t&&t,s.a.debug("Trying to remove connection "+e.sessionId+"\n       with erizoId "+e.erizoId),(0===e.streamsMap.size()||t)&&(s.a.debug("No streams in connection "+e.sessionId+", erizoId: "+e.erizoId),void 0!==this.ErizoConnectionsMap.get(e.erizoId)&&this.ErizoConnectionsMap.get(e.erizoId)["single-pc"]&&!t?s.a.debug("Will not remove empty connection "+e.erizoId+" - it is singlePC"):(e.close(),void 0!==this.ErizoConnectionsMap.get(e.erizoId)&&(delete this.ErizoConnectionsMap.get(e.erizoId)["single-pc"],delete this.ErizoConnectionsMap.get(e.erizoId)[e.sessionId])))},t.a=e},function(e,t,n){var r=n(9),i=n(21),o=n(0);t.a=function(e){o.a.info("Starting Chrome stable stack",e);var t=Object(r.a)(e);t.mediaConstraints={offerToReceiveVideo:!0,offerToReceiveAudio:!0},t.enableSimulcast=function(e){var n=e;if(!t.simulcast||null!==n.match(/a=ssrc-group:SIM/g))return n;if(!(e=n.match(/a=ssrc-group:FID ([0-9]*) ([0-9]*)\r?\n/))||0>=e.length)return n;var r=t.simulcast.numSpatialLayers||2,o=parseInt(e[1],10),a=parseInt(e[2],10),s=n.match(new RegExp("a=ssrc:"+e[1]+" cname:(.*)\r?\n"))[1],c=n.match(new RegExp("a=ssrc:"+e[1]+" msid:(.*)\r?\n"))[1],d=n.match(new RegExp("a=ssrc:"+e[1]+" mslabel:(.*)\r?\n"))[1],u=n.match(new RegExp("a=ssrc:"+e[1]+" label:(.*)\r?\n"))[1];n.match(new RegExp("a=ssrc:"+e[1]+".*\r?\n","g")).forEach(function(e){n=n.replace(e,"")}),n.match(new RegExp("a=ssrc:"+e[2]+".*\r?\n","g")).forEach(function(e){n=n.replace(e,"")});for(var l=[o],p=[a],f=1;f<r;f+=1)l.push(o+1e3*f),p.push(a+1e3*f);for(r=i.a.addSim(l),f=0;f<l.length;f+=1)o=l[f],a=p[f],r+=i.a.addGroup(o,a);for(f=0;f<l.length;f+=1)o=l[f],a=p[f],r+=i.a.addSpatialLayer(s,c,d,u,o,a);return n.replace(e[0],r+"a=x-google-flag:conference\r\n")};return t.setSimulcastLayersBitrate=function(){o.a.debug("Maybe set simulcast Layers bitrate",t.simulcast),t.simulcast&&t.simulcast.spatialLayerBitrates&&t.peerConnection.getSenders().forEach(function(e){"video"===e.track.kind&&function(e){if("function"!=typeof e.getParameters||"function"!=typeof e.setParameters)o.a.warning("Cannot set simulcast layers bitrate: getParameters or setParameters is not available");else{var n=e.getParameters();Object.keys(t.simulcast.spatialLayerBitrates).forEach(function(e){void 0!==n.encodings[e]&&(o.a.debug("Setting bitrate for layer "+e+", bps: "+t.simulcast.spatialLayerBitrates[e]),n.encodings[e].maxBitrate=t.simulcast.spatialLayerBitrates[e])}),e.setParameters(n).then(function(e){o.a.debug("Success setting simulcast layer bitrates",e)}).catch(function(e){o.a.warning("Error setting simulcast layer bitrates",e)})}}(e)})},t.setStartVideoBW=function(n){t.video&&e.startVideoBW&&(o.a.debug("startVideoBW requested: "+e.startVideoBW),i.a.setParamForCodecs(n,"video","x-google-start-bitrate",e.startVideoBW))},t.setHardMinVideoBW=function(n){t.video&&e.hardMinVideoBW&&(o.a.debug("hardMinVideoBW requested: "+e.hardMinVideoBW),i.a.setParamForCodecs(n,"video","x-google-min-bitrate",e.hardMinVideoBW))},t}},function(e,t,n){t=n(29);var r=n(11),i=n(12),o=n(13),a=n(14),s=n(15),c=n(2),d=n(17),u=n(18),l=n(19),p=n(20);n=n(4),e.exports={SDPInfo:t,CandidateInfo:r,CodecInfo:i,DTLSInfo:o,ICEInfo:a,MediaInfo:s,Setup:c,SourceGroupInfo:d,SourceInfo:u,StreamInfo:l,TrackInfo:p,Direction:n}},function(e,t,r){function i(e,t){var n=new Map;t.rtp.forEach(function(r){var i=r.payload,o=r.codec,a=r.rate;r=r.encoding;var s={},c=[];t.fmtp.forEach(function(e){e.payload===i&&e.config.split(";").forEach(function(e){e=e.split("="),s[e[0].trim()]=(e[1]||"").trim()})}),t.rtcpFb&&t.rtcpFb.forEach(function(e){e.payload===i&&c.push({type:e.type,subtype:e.subtype})}),"RTX"===o.toUpperCase()?n.set(parseInt(s.apt,10),i):e.addCodec(new l(o,i,a,r,s,c))}),n.forEach(function(t,n){(n=e.getCodecForType(n))&&n.setRTX(t)})}function o(e,t){(t=t.rids)&&t.forEach(function(t){var n=new R(t.id,g.byValue(t.direction)),r=[],i=new Map;if(t.params){var o=d.parseParams(t.params);Object.keys(o).forEach(function(e){"pt"===e?r=o[e].split(","):i.set(e,o[e])}),n.setFormats(r),n.setParams(i)}e.addRID(n)})}function a(e,t,n){var r=t.simulcast["dir"+e];if(e=t.simulcast["list"+e],r){var i=g.byValue(r);d.parseSimulcastStreamList(e).forEach(function(e){var t=[];e.forEach(function(e){t.push(new C(e.scid,e.paused))}),n.addSimulcastAlternativeStreams(i,t)})}}function s(e,t){var n=[];if(t.simulcast){var r=new b;a("1",t,r),a("2",t,r),r.getSimulcastStreams(g.SEND).forEach(function(t){var r=[];t.forEach(function(t){var n=new T(t.getId(),t.isPaused());(t=e.getRID(n.getId()))&&(t.getFormats().forEach(function(t){(t=e.getCodecForType(t))&&n.addCodec(t)}),n.setParams(t.getParams()),r.push(n))}),r.length&&n.push(r)}),e.setSimulcast(r)}return t.simulcast_03&&((r=new b).setSimulcastPlainString(t.simulcast_03.value),e.setSimulcast03(r)),n}function c(e,t,n){var r,i,o,a=new Map,s=n.type;n.ssrcs&&n.ssrcs.forEach(function(n){var c=n.id,d=n.attribute;n=n.value,(o=a.get(c))||(o=new E(c),a.set(o.getSSRC(),o)),"cname"===d.toLowerCase()?o.setCName(n):"mslabel"===d.toLowerCase()?o.setMSLabel(n):"label"===d.toLowerCase()?o.setLabel(n):"msid"===d.toLowerCase()&&(c=(d=n.split(" "))[0],d=d[1],o.setStreamId(c),o.setTrackId(d),(i=t.getStream(c))||(i=new S(c),t.addStream(i)),(r=i.getTrack(d))||((r=new _(s,d)).setEncodings(e),i.addTrack(r)),r.addSSRC(o))});if(n.msid){var c,d=(c=n.msid.split(" "))[0],u=c[1];(c=t.getStream(d))||(c=new S(d),t.addStream(c));var l=c.getTrack(u);l||((l=new _(s,u)).setMediaId(n.mid),l.setEncodings(e),c.addTrack(l)),a.forEach(function(e,t){(e=a.get(t)).getStreamId()||(e.setStreamId(d),e.setTrackId(u),l.addSSRC(e))})}n.ssrcGroups&&n.ssrcGroups.forEach(function(e){var n=e.ssrcs.split(" ");e=new v(e.semantics,n),n=a.get(parseInt(n[0],10)),t.getStream(n.getStreamId()).getTrack(n.getTrackId()).addSourceGroup(e)})}var d=r(30),u=r(11),l=r(12),p=r(13),f=r(14),h=r(15),m=r(2),y=r(4),g=r(3),v=r(17),E=r(18),S=r(19),_=r(20),T=r(33),b=r(16),C=r(34),R=r(35),I=function(e){this.version=e||1,this.name="sdp-semantic",this.streams=new Map,this.medias=[],this.candidates=[],this.dtls=this.ice=this.connection=null};I.prototype.clone=function(){var e=new I(this.version);return e.name=this.name,e.setConnection(this.connection),this.medias.forEach(function(t){e.addMedia(t.clone())}),this.streams.forEach(function(t){e.addStream(t.clone())}),this.candidates.forEach(function(t){e.addCandidate(t.clone())}),e.setICE(this.ice.clone()),e.setDTLS(this.dtls.clone()),e},I.prototype.plain=function(){var e={version:this.version,name:this.name,streams:[],medias:[],candidates:[],connection:this.connection};return this.medias.forEach(function(t){e.medias.push(t.plain())}),this.streams.forEach(function(t){e.streams.push(t.plain())}),this.candidates.forEach(function(t){e.candidates.push(t.plain())}),e.ice=this.ice&&this.ice.plain(),e.dtls=this.dtls&&this.dtls.plain(),e},I.prototype.setVersion=function(e){this.version=e},I.prototype.setOrigin=function(e){this.origin=e},I.prototype.setName=function(e){this.name=e},I.prototype.getConnection=function(){return this.connection},I.prototype.setConnection=function(e){this.connection=e},I.prototype.setTiming=function(e){this.timing=e},I.prototype.addMedia=function(e){this.medias.push(e)},I.prototype.getMedia=function(e){var t;return this.medias.forEach(function(n){n.getType().toLowerCase()===e.toLowerCase()&&(t=n)}),t},I.prototype.getMedias=function(e){if(!e)return this.medias;var t=[];return this.medias.forEach(function(n){n.getType().toLowerCase()===e.toLowerCase()&&t.push(n)}),t},I.prototype.getMediaById=function(e){var t;return this.medias.forEach(function(n){n.getId().toLowerCase()===e.toLowerCase()&&(t=n)}),t},I.prototype.getVersion=function(){return this.version},I.prototype.getDTLS=function(){return this.dtls},I.prototype.setDTLS=function(e){this.dtls=e},I.prototype.getICE=function(){return this.ice},I.prototype.setICE=function(e){this.ice=e},I.prototype.addCandidate=function(e){this.candidates.push(e)},I.prototype.addCandidates=function(e){var t=this;e.forEach(function(e){t.addCandidate(e)})},I.prototype.getCandidates=function(){return this.candidates},I.prototype.getStream=function(e){return this.streams.get(e)},I.prototype.getStreams=function(){return this.streams},I.prototype.getFirstStream=function(){return 0<this.streams.values().length?this.streams.values()[0]:null},I.prototype.addStream=function(e){this.streams.set(e.getId(),e)},I.prototype.removeStream=function(e){this.streams.delete(e.getId())},I.prototype.toJSON=function(){var e={version:0,media:[]};e.version=this.version||0,e.origin=this.origin||{username:"-",sessionId:(new Date).getTime(),sessionVersion:this.version,netType:"IN",ipVer:4,address:"127.0.0.1"},e.name=this.name||"semantic-sdp",e.connection=this.getConnection(),e.timing=this.timing||{start:0,stop:0};var t=this.getICE();t&&(t.isLite()&&(e.icelite="ice-lite"),e.iceOptions=t.getOpts(),e.iceUfrag=t.getUfrag(),e.icePwd=t.getPwd()),e.msidSemantic=this.msidSemantic||{semantic:"WMS",token:"*"},e.groups=[];var r={type:"BUNDLE",mids:[]},i=this.getDTLS();i&&(e.fingerprint={type:i.getHash(),hash:i.getFingerprint()},e.setup=m.toString(i.getSetup())),this.medias.forEach(function(n){var o={type:n.getType(),port:n.getPort(),protocol:"UDP/TLS/RTP/SAVPF",fmtp:[],rtp:[],rtcpFb:[],ext:[],bandwidth:[],candidates:[],ssrcGroups:[],ssrcs:[],rids:[]};o.direction=y.toString(n.getDirection()),o.rtcpMux="rtcp-mux",o.connection=n.getConnection(),o.xGoogleFlag=n.getXGoogleFlag(),o.mid=n.getId(),r.mids.push(n.getId()),o.rtcp=n.rtcp,0<n.getBitrate()&&o.bandwidth.push({type:"AS",limit:n.getBitrate()}),n.getCandidates().forEach(function(e){o.candidates.push({foundation:e.getFoundation(),component:e.getComponentId(),transport:e.getTransport(),priority:e.getPriority(),ip:e.getAddress(),port:e.getPort(),type:e.getType(),relAddr:e.getRelAddr(),relPort:e.getRelPort(),generation:e.getGeneration()})}),(t=n.getICE())&&(t.isLite()&&(o.icelite="ice-lite"),o.iceOptions=t.getOpts(),o.iceUfrag=t.getUfrag(),o.icePwd=t.getPwd(),t.isEndOfCandidates()&&(o.endOfCandidates=t.isEndOfCandidates())),(i=n.getDTLS())&&(o.fingerprint={type:i.getHash(),hash:i.getFingerprint()},o.setup=m.toString(i.getSetup())),n.setup&&(o.setup=m.toString(n.setup)),n.getCodecs().forEach(function(e){o.rtp.push({payload:e.getType(),codec:e.getCodec(),rate:e.getRate(),encoding:e.getEncoding()});var t=e.getParams();0<Object.keys(t).length&&o.fmtp.push({payload:e.getType(),config:Object.keys(t).map(function(e){return e+(t[e]?"="+t[e]:"")}).join(";")}),e.getFeedback().forEach(function(t){o.rtcpFb.push({payload:e.getType(),type:t.type,subtype:t.subtype})}),e.hasRTX()&&(o.rtp.push({payload:e.getRTX(),codec:"rtx",rate:e.getRate(),encoding:e.getEncoding()}),o.fmtp.push({payload:e.getRTX(),config:"apt="+e.getType()}))});var a=[];o.rtp.forEach(function(e){a.push(e.payload)}),o.payloads=a.join(" "),n.getExtensions().forEach(function(e,t){o.ext.push({value:t,uri:e})}),n.getRIDs().forEach(function(e){var t={id:e.getId(),direction:g.toString(e.getDirection()),params:""};e.getFormats().length&&(t.params="pt="+e.getFormats().join(",")),e.getParams().forEach(function(e,n){t.params+=(t.params.length?";":"")+n+"="+e}),o.rids.push(t)});var s=n.getSimulcast();if(n=n.getSimulcast03(),s){var c=1;o.simulcast={};var d=s.getSimulcastStreams(g.SEND);s=s.getSimulcastStreams(g.RECV);if(d&&d.length){var u="";d.forEach(function(e){var t="";e.forEach(function(e){t+=(t.length?",":"")+(e.isPaused()?"~":"")+e.getId()}),u+=(u.length?";":"")+t}),o.simulcast["dir"+c]="send",o.simulcast["list"+c]=u,c+=1}if(s&&s.length){var l=[];s.forEach(function(e){var t="";e.forEach(function(e){t+=(t.length?",":"")+(e.isPaused()?"~":"")+e.getId()}),l+=(l.length?";":"")+t}),o.simulcast["dir"+c]="recv",o.simulcast["list"+c]=l,c+=1}}n&&(o.simulcast_03={value:n.getSimulcastPlainString()}),e.media.push(o)}),r.mids.sort(),e.media.sort(function(e,t){return e.mid<t.mid?-1:e.mid>t.mid?1:0});for(var o=n.makeIterator(this.streams.values()),a=o.next();!a.done;a=o.next()){a=a.value;for(var s=n.makeIterator(a.getTracks().values()),c=s.next();!c.done;c=s.next()){c=c.value;for(var d={},u=n.makeIterator(e.media),l=u.next();!l.done;d={md:d.md},l=u.next())if(d.md=l.value,c.getMediaId()){if(c.getMediaId()===d.md.mid){c.getSourceGroups().forEach(function(e){return function(t){e.md.ssrcGroups.push({semantics:t.getSemantics(),ssrcs:t.getSSRCs().join(" ")})}}(d)),c.getSSRCs().forEach(function(e){return function(t){e.md.ssrcs.push({id:t.ssrc,attribute:"cname",value:t.getCName()})}}(d)),a.getId()&&c.getId()&&(d.md.msid=a.getId()+" "+c.getId());break}}else if(d.md.type.toLowerCase()===c.getMedia().toLowerCase()){c.getSourceGroups().forEach(function(e){return function(t){e.md.ssrcGroups.push({semantics:t.getSemantics(),ssrcs:t.getSSRCs().join(" ")})}}(d)),c.getSSRCs().forEach(function(e){return function(t){e.md.ssrcs.push({id:t.ssrc,attribute:"cname",value:t.getCName()}),t.getStreamId()&&t.getTrackId()&&e.md.ssrcs.push({id:t.ssrc,attribute:"msid",value:t.getStreamId()+" "+t.getTrackId()}),t.getMSLabel()&&e.md.ssrcs.push({id:t.ssrc,attribute:"mslabel",value:t.getMSLabel()}),t.getLabel()&&e.md.ssrcs.push({id:t.ssrc,attribute:"label",value:t.getLabel()})}}(d));break}}}return r.mids=r.mids.join(" "),e.groups.push(r),e},I.prototype.toString=function(){var e=this.toJSON();return d.write(e)},I.processString=function(e){return e=d.parse(e),I.process(e)},I.process=function(e){var t=new I;t.setVersion(e.version),t.setTiming(e.timing),t.setConnection(e.connection),t.setOrigin(e.origin),t.msidSemantic=e.msidSemantic,t.name=e.name;var n=e.iceUfrag,r=e.icePwd,a=e.iceOptions;(n||r||a)&&t.setICE(new f(n,r,a));var d=e.fingerprint;if(d){var l=d.type,g=d.hash,v=null;e.setup&&(v=m.byValue(e.setup)),t.setDTLS(new p(v,l,g))}return e.media.forEach(function(e){var l=new h(e.mid,e.port,e.type);if(l.setXGoogleFlag(e.xGoogleFlag),l.rtcp=e.rtcp,l.setConnection(e.connection),e.bandwidth&&0<e.bandwidth.length&&e.bandwidth.forEach(function(e){"AS"===e.type&&l.setBitrate(e.limit)}),n=e.iceUfrag,r=e.icePwd,a=e.iceOptions,n||r||a){var g=new f(n,r,a);e.endOfCandidates&&g.setEndOfCandidates("end-of-candidates"),l.setICE(g)}if(d=e.fingerprint){g=d.type;var v=d.hash,E=m.ACTPASS;e.setup&&(E=m.byValue(e.setup)),l.setDTLS(new p(E,g,v))}e.setup&&l.setSetup(m.byValue(e.setup)),g=y.SENDRECV,e.direction&&(g=y.byValue(e.direction.toUpperCase())),l.setDirection(g),(g=e.candidates)&&g.forEach(function(e){l.addCandidate(new u(e.foundation,e.component,e.transport,e.priority,e.ip,e.port,e.type,e.generation,e.relAddr,e.relPort))}),i(l,e),(g=e.ext)&&g.forEach(function(e){l.addExtension(e.value,e.uri)}),o(l,e),c(g=s(l,e),t,e),t.addMedia(l)}),t},e.exports=I},function(e,t,n){e=n(31),n=n(32),t.write=n,t.parse=e.parse,t.parseFmtpConfig=e.parseFmtpConfig,t.parseParams=e.parseParams,t.parsePayloads=e.parsePayloads,t.parseRemoteCandidates=e.parseRemoteCandidates,t.parseImageAttributes=e.parseImageAttributes,t.parseSimulcastStreamList=e.parseSimulcastStreamList},function(e,t,n){var r=function(e){return String(Number(e))===e?Number(e):e},i=n(10),o=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(e){var t={},n=[],a=t;return e.split(/(\r\n|\r|\n)/).filter(o).forEach(function(e){var t=e[0],o=e.slice(2);for("m"===t&&(n.push({rtp:[],fmtp:[]}),a=n[n.length-1]),e=0;e<(i[t]||[]).length;e+=1){if((s=i[t][e]).reg.test(o)){t=s,e=a,s=o,o=t.name&&t.names,t.push&&!e[t.push]?e[t.push]=[]:o&&!e[t.name]&&(e[t.name]={});o=t.push?{}:o?e[t.name]:e;var s=s.match(t.reg),c=o,d=t.names,u=t.name;if(u&&!d)c[u]=r(s[1]);else for(u=0;u<d.length;u+=1)null!=s[u+1]&&(c[d[u]]=r(s[u+1]));t.push&&e[t.push].push(o);break}}}),t.media=n,t};var a=function(e,t){return 2===(t=t.split(/=(.+)/,2)).length&&(e[t[0]]=r(t[1])),e};t.parseParams=function(e){return e.split(/\;\s?/).reduce(a,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(e){return e.split(" ").map(Number)},t.parseRemoteCandidates=function(e){var t=[];e=e.split(" ").map(r);for(var n=0;n<e.length;n+=3)t.push({component:e[n],ip:e[n+1],port:e[n+2]});return t},t.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(a,{})})},t.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var t=!1;return"~"!==e[0]?e=r(e):(e=r(e.substring(1,e.length)),t=!0),{scid:e,paused:t}})})}},function(e,t,n){var r=n(10),i=/%[sdv%]/g,o=function(e,t,n){var r=t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format;if(e=[e+"="+r],t.names)for(r=0;r<t.names.length;r+=1){var o=t.names[r];t.name?e.push(n[t.name][o]):e.push(n[t.names[r]])}else e.push(n[t.name]);return function(e){var t=1,n=arguments,r=n.length;return e.replace(i,function(e){if(t>=r)return e;var i=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}})}.apply(null,e)},a="vosiuepcbtrza".split(""),s=["i","c","b","a"];e.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var n=t.innerOrder||s,i=[];return(t.outerOrder||a).forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?i.push(o(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){i.push(o(t,n,e))})})}),e.media.forEach(function(e){i.push(o("m",r.m[0],e)),n.forEach(function(t){r[t].forEach(function(n){n.name in e&&null!=e[n.name]?i.push(o(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach(function(e){i.push(o(t,n,e))})})})}),i.join("\r\n")+"\r\n"}},function(e,t){var n=function(e,t){this.id=e,this.paused=t,this.codecs=new Map,this.params=new Map};n.prototype.clone=function(){var e=new n(this.id,this.paused);return this.codecs.forEach(function(t){e.addCodec(t.cloned())}),e.setParams(this.params),e},n.prototype.plain=function(){var e=this,t={id:this.id,paused:this.paused,codecs:{},params:{}};return this.codecs.keys().forEach(function(n){t.codecs[n]=e.codecs.get(n).plain()}),this.params.keys().forEach(function(n){t.params[n]=e.params.get(n).param}),t},n.prototype.getId=function(){return this.id},n.prototype.getCodecs=function(){return this.codecs},n.prototype.addCodec=function(e){this.codecs.set(e.getType(),e)},n.prototype.getParams=function(){return this.params},n.prototype.setParams=function(e){this.params=new Map(e)},n.prototype.isPaused=function(){return this.paused},e.exports=n},function(e,t){var n=function(e,t){this.paused=t,this.id=e};n.prototype.clone=function(){return new n(this.id,this.paused)},n.prototype.plain=function(){return{id:this.id,paused:this.paused}},n.prototype.isPaused=function(){return this.paused},n.prototype.getId=function(){return this.id},e.exports=n},function(e,t,n){var r=n(3),i=function(e,t){this.id=e,this.direction=t,this.formats=[],this.params=new Map};i.prototype.clone=function(){var e=new i(this.id,this.direction);return e.setFormats(this.formats),e.setParams(this.params),e},i.prototype.plain=function(){var e={id:this.id,direction:r.toString(this.direction),formats:this.formats,params:{}};return this.params.forEach(function(t,n){e.params[n]=t}),e},i.prototype.getId=function(){return this.id},i.prototype.getDirection=function(){return this.direction},i.prototype.setDirection=function(e){this.direction=e},i.prototype.getFormats=function(){return this.formats},i.prototype.setFormats=function(e){var t=this;this.formats=[],e.forEach(function(e){t.formats.push(parseInt(e,10))})},i.prototype.getParams=function(){return this.params},i.prototype.setParams=function(e){this.params=new Map(e)},e.exports=i},function(e,t,n){e=n(37),e=n.n(e);var r=n(0);n=["initial","failed","stable"],n=e.a.factory({init:"initial",transitions:[{name:"create-offer",from:n,to:"stable"},{name:"add-ice-candidate",from:n,to:function(){return this.state}},{name:"process-answer",from:n,to:"stable"},{name:"process-offer",from:n,to:"stable"},{name:"negotiate-max-bw",from:n,to:"stable"},{name:"add-stream",from:n,to:function(){return this.state}},{name:"remove-stream",from:n,to:function(){return this.state}},{name:"close",from:n,to:"closed"},{name:"error",from:"*",to:"failed"}],data:function(e){return{baseStackCalls:e,history:[]}},methods:{getHistory:function(){return this.history},onBeforeClose:function(e){return r.a.info("FSM onBeforeClose from: "+e.from+", to: "+e.to),this.baseStackCalls.protectedClose()},onBeforeAddIceCandidate:function(e,t){return r.a.info("FSM onBeforeAddIceCandidate, from "+e.from+", to: "+e.to),this.baseStackCalls.protectedAddIceCandidate(t)},onBeforeAddStream:function(e,t){return r.a.info("FSM onBeforeAddStream, from "+e.from+", to: "+e.to),this.baseStackCalls.protectedAddStream(t)},onBeforeRemoveStream:function(e,t){return r.a.info("FSM onBeforeRemoveStream, from "+e.from+", to: "+e.to),this.baseStackCalls.protectedRemoveStream(t)},onBeforeCreateOffer:function(e,t){return r.a.info("FSM onBeforeCreateOffer, from "+e.from+", to: "+e.to),this.baseStackCalls.protectedCreateOffer(t)},onBeforeProcessOffer:function(e,t){return r.a.info("FSM onBeforeProcessOffer, from "+e.from+", to: "+e.to),this.baseStackCalls.protectedProcessOffer(t)},onBeforeProcessAnswer:function(e,t){return r.a.info("FSM onBeforeProcessAnswer from: "+e.from+", to: "+e.to),this.baseStackCalls.protectedProcessAnswer(t)},onBeforeNegotiateMaxBW:function(e,t,n){return r.a.info("FSM onBeforeNegotiateMaxBW from: "+e.from+", to: "+e.to),this.baseStackCalls.protectedNegotiateMaxBW(t,n)},onStable:function(e){r.a.info("FSM reached STABLE, from "+e.from+", to: "+e.to)},onClosed:function(e){r.a.info("FSM reached close, from "+e.from+", to: "+e.to)},onTransition:function(e){r.a.debug("FSM onTransition, transition: "+e.transition+", from "+e.from+", to: "+e.to),this.history.push({from:e.from,to:e.to,transition:e.transition}),200<this.history.length&&this.history.shift()},onError:function(e,t){r.a.warning("FSM Error Transition Failed, message: "+t+", from: "+e.from+", to: "+e.to+", printing history:"),this.history.forEach(function(e){r.a.warning(e)})},onInvalidTransition:function(e,t,n){"closed"===t?r.a.info("Trying to transition a closed FSM, transition: "+e+", from: "+t+", to: "+n):r.a.warning("FSM Error Invalid transition: "+e+", from: "+t+", to: "+n)},onPendingTransition:function(e,t,n){r.a.warning("FSM Error Pending transition: "+e+", from: "+t+", to: "+n)}}}),t.a=n},function(e,t,n){e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=5)}([function(e,t,n){e.exports=function(e,t){var n,r;for(n=1;n<arguments.length;n++){var i=arguments[n];for(r in i)i.hasOwnProperty(r)&&(e[r]=i[r])}return e}},function(e,t,n){var r=n(0);e.exports={build:function(e,t){var n,i=t.plugins;for(t=0,n=i.length;t<n;t++){var o=i[t];o.methods&&r(e,o.methods),o.properties&&Object.defineProperties(e,o.properties)}},hook:function(e,t,n){var r,i,o=e.config.plugins;for(e=[e.context],n&&(e=e.concat(n)),n=0,r=o.length;n<r;n++){var a=o[n];(i=o[n][t])&&i.apply(a,e)}}}},function(e,t,n){function r(e){if(0===e.length)return e;var t=e.split(/[_-]/);if(1===t.length&&t[0][0].toLowerCase()===t[0][0])return e;var n=t[0].toLowerCase();for(e=1;e<t.length;e++)n=n+t[e].charAt(0).toUpperCase()+t[e].substring(1).toLowerCase();return n}r.prepended=function(e,t){return t=r(t),e+t[0].toUpperCase()+t.substring(1)},e.exports=r},function(e,t,n){function r(e,t){this.options=e=e||{},this.defaults=t.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(e.init),this.data=this.configureData(e.data),this.methods=this.configureMethods(e.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(e.transitions||[]),this.plugins=this.configurePlugins(e.plugins,t.plugin)}var i=n(0),o=n(2);i(r.prototype,{addState:function(e){this.map[e]||(this.states.push(e),this.addStateLifecycleNames(e),this.map[e]={})},addStateLifecycleNames:function(e){this.lifecycle.onEnter[e]=o.prepended("onEnter",e),this.lifecycle.onLeave[e]=o.prepended("onLeave",e),this.lifecycle.on[e]=o.prepended("on",e)},addTransition:function(e){0>this.transitions.indexOf(e)&&(this.transitions.push(e),this.addTransitionLifecycleNames(e))},addTransitionLifecycleNames:function(e){this.lifecycle.onBefore[e]=o.prepended("onBefore",e),this.lifecycle.onAfter[e]=o.prepended("onAfter",e),this.lifecycle.on[e]=o.prepended("on",e)},mapTransition:function(e){var t=e.name,n=e.from,r=e.to;return this.addState(n),"function"!=typeof r&&this.addState(r),this.addTransition(t),this.map[n][t]=e},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(e){return"string"==typeof e?this.mapTransition(i({},this.defaults.init,{to:e,active:!0})):"object"==typeof e?this.mapTransition(i({},this.defaults.init,e,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(e){return"function"==typeof e?e:"object"==typeof e?function(){return e}:function(){return{}}},configureMethods:function(e){return e||{}},configurePlugins:function(e,t){var n;for(t=0,n=(e=e||[]).length;t<n;t++){var r=e[t];"function"==typeof r&&(e[t]=r=r()),r.configure&&r.configure(this)}return e},configureTransitions:function(e){var t,n,r=this.defaults.wildcard;for(n=0;n<e.length;n++){var i=e[n],o=Array.isArray(i.from)?i.from:[i.from||r],a=i.to||r;for(t=0;t<o.length;t++)this.mapTransition({name:i.name,from:o[t],to:a})}},transitionFor:function(e,t){var n=this.defaults.wildcard;return this.map[e][t]||this.map[n][t]},transitionsFor:function(e){var t=this.defaults.wildcard;return Object.keys(this.map[e]).concat(Object.keys(this.map[t]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),e.exports=r},function(e,t,n){function r(e,t){this.context=e,this.config=t,this.state=t.init.from,this.observers=[e]}var i=n(0),o=n(6),a=n(1),s=[null,[]];i(r.prototype,{init:function(e){if(i(this.context,this.config.data.apply(this.context,e)),a.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(e){return Array.isArray(e)?0<=e.indexOf(this.state):this.state===e},isPending:function(){return this.pending},can:function(e){return!this.isPending()&&!!this.seek(e)},cannot:function(e){return!this.can(e)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(e,t){var n=this.config.defaults.wildcard;return"function"==typeof(e=(e=this.config.transitionFor(this.state,e))&&e.to)?e.apply(this.context,t):e===n?this.state:e},fire:function(e,t){return this.transit(e,this.state,this.seek(e,t),t)},transit:function(e,t,n,r){var i=this.config.lifecycle,o=this.config.options.observeUnchangedState||t!==n;return n?this.isPending()?this.context.onPendingTransition(e,t,n):(this.config.addState(n),this.beginTransit(),r.unshift({transition:e,from:t,to:n,fsm:this.context}),this.observeEvents([this.observersForEvent(i.onBefore.transition),this.observersForEvent(i.onBefore[e]),o?this.observersForEvent(i.onLeave.state):s,o?this.observersForEvent(i.onLeave[t]):s,this.observersForEvent(i.on.transition),o?["doTransit",[this]]:s,o?this.observersForEvent(i.onEnter.state):s,o?this.observersForEvent(i.onEnter[n]):s,o?this.observersForEvent(i.on[n]):s,this.observersForEvent(i.onAfter.transition),this.observersForEvent(i.onAfter[e]),this.observersForEvent(i.on[e])],r)):this.context.onInvalidTransition(e,t,n)},beginTransit:function(){this.pending=!0},endTransit:function(e){return this.pending=!1,e},failTransit:function(e){throw this.pending=!1,e},doTransit:function(e){this.state=e.to},observe:function(e){if(2===e.length){var t={};t[e[0]]=e[1],this.observers.push(t)}else this.observers.push(e[0])},observersForEvent:function(e){for(var t,n=0,r=this.observers.length,i=[];n<r;n++)(t=this.observers[n])[e]&&i.push(t);return[e,i,!0]},observeEvents:function(e,t,n,r){if(0===e.length)return this.endTransit(void 0===r||r);var i=e[0][0],o=e[0][1],s=e[0][2];return(t[0].event=i)&&s&&i!==n&&a.hook(this,"lifecycle",t),0===o.length?(e.shift(),this.observeEvents(e,t,i,r)):(n=(n=o.shift())[i].apply(n,t))&&"function"==typeof n.then?n.then(this.observeEvents.bind(this,e,t,i)).catch(this.failTransit.bind(this)):!1===n?this.endTransit(!1):this.observeEvents(e,t,i,n)},onInvalidTransition:function(e,t,n){throw new o("transition is invalid in current state",e,t,n,this.state)},onPendingTransition:function(e,t,n){throw new o("transition is invalid while previous transition is still in progress",e,t,n,this.state)}}),e.exports=r},function(e,t,n){function r(e){return i(this||{},e)}function i(e,t){return t=new d(t,r),o(e,t),e._fsm(),e}function o(e,t){if("object"!=typeof e||Array.isArray(e))throw Error("StateMachine can only be applied to objects");c.build(e,t),Object.defineProperties(e,p),a(e,l),a(e,t.methods),t.allTransitions().forEach(function(t){e[s(t)]=function(){return this._fsm.fire(t,[].slice.call(arguments))}}),e._fsm=function(){this._fsm=new u(this,t),this._fsm.init(arguments)}}var a=n(0),s=n(2),c=n(1),d=n(3),u=n(4),l={is:function(e){return this._fsm.is(e)},can:function(e){return this._fsm.can(e)},cannot:function(e){return this._fsm.cannot(e)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(e,t,n){return this._fsm.onInvalidTransition(e,t,n)},onPendingTransition:function(e,t,n){return this._fsm.onPendingTransition(e,t,n)}},p={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(e){throw Error("use transitions to change state")}}};r.version="3.0.1",r.factory=function(e,t){if("function"==typeof e){var n=e;e=t||{}}else n=function(){this._fsm.apply(this,arguments)},e=e||{};return e=new d(e,r),o(n.prototype,e),n.prototype._fsm.config=e,n},r.apply=i,r.defaults={wildcard:"*",init:{name:"init",from:"none"}},e.exports=r},function(e,t,n){e.exports=function(e,t,n,r,i){this.message=e,this.transition=t,this.from=n,this.to=r,this.current=i}}])},function(e,t,r){(e=function(){this._enqueuing=!1,this._queuedArgs=[]}).prototype.protectFunction=function(e){return this._protectedFunction.bind(this,e)},e.prototype.isEnqueueing=function(){return this._enqueuing},e.prototype.startEnqueuing=function(){this._enqueuing=!0},e.prototype.stopEnqueuing=function(){this._enqueuing=!1},e.prototype.nextInQueue=function(){if(0<this._queuedArgs.length){var e=this._queuedArgs.shift();e.protectedFunction.apply(null,[].concat(n.arrayFromIterable(e.args)))}},e.prototype.dequeueAll=function(){var e=this._queuedArgs;this._queuedArgs=[],e.forEach(function(e){e.protectedFunction.apply(null,[].concat(n.arrayFromIterable(e.args)))})},e.prototype._protectedFunction=function(e,t){for(var r=[],i=1;i<arguments.length;++i)r[i-1]=arguments[i];this.isEnqueueing()?this._enqueue.apply(this,[].concat([e],n.arrayFromIterable(r))):e.apply(null,[].concat(n.arrayFromIterable(r)))},e.prototype._enqueue=function(e,t){for(var n=[],r=1;r<arguments.length;++r)n[r-1]=arguments[r];this._queuedArgs.push({protectedFunction:e,args:n})},t.a=e},function(e,t,n){var r=n(0),i=n(9);t.a=function(e){r.a.info("Starting Firefox stack");var t=Object(i.a)(e),n=[{rid:"low",scaleResolutionDownBy:3},{rid:"med",scaleResolutionDownBy:2},{rid:"high"}],o=function(e){var r=t.simulcast.numSpatialLayers||2,i=n.length,o=(r=r<i?r:i,e.getParameters()||{});o.encodings=[];for(var a=i-1;a>=i-r;--a)o.encodings.push(n[a]);return e.setParameters(o)},a=function(){if(!t.simulcast)return[];var e=[];return t.peerConnection.getSenders().forEach(function(t){"video"===t.track.kind&&e.push(o(t))}),e};t.enableSimulcast=function(e){return e};var s=t.createOffer;return t.createOffer=function(e,t,n){t=void 0!==t&&t,n=void 0===n?"":n;var r=[];!0!==e&&(r=a()),Promise.all(r).then(function(){s(e,t,n)})},t}},function(e,t,n){var r=n(0);t.a=function(e){var t={pcConfig:{},peerConnection:{},desc:{},signalCallback:void 0,close:function(){r.a.info("Close FcStack")},createOffer:function(){r.a.debug("FCSTACK: CreateOffer")},addStream:function(e){r.a.debug("FCSTACK: addStream",e)},processSignalingMessage:function(e){r.a.debug("FCSTACK: processSignaling",e),void 0!==t.signalCallback&&t.signalCallback(e)},sendSignalingMessage:function(t){r.a.debug("FCSTACK: Sending signaling Message",t),e.callback(t)},setSignalingCallback:function(e){e=void 0===e?function(){}:e,r.a.debug("FCSTACK: Setting signalling callback"),t.signalCallback=e}};return t}},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,r){r.d(t,"a",function(){return c}),e=r(43);var i=r.n(e),o=r(0),a=r(1),s=function(e,t){return(e=Object(a.d)({type:e})).args=t.args,e},c=function(e){var t=Object(a.b)(),r=function(){},c=[];n.initSymbol(),t.CONNECTED=Symbol("connected"),n.initSymbol(),t.RECONNECTING=Symbol("reconnecting"),n.initSymbol(),t.DISCONNECTED=Symbol("disconnected"),t.state=t.DISCONNECTED,t.IO=void 0===e?i.a:e;var d,u=function(e,n){for(var r=[],i=1;i<arguments.length;++i)r[i-1]=arguments[i];t.emit(s(e,{args:r}))},l=function(){t.state===t.CONNECTED&&c.forEach(function(e){t.sendMessage.apply(t,[].concat(n.arrayFromIterable(e)))})};return t.connect=function(e,n,i,a){i=void 0===i?r:i,a=void 0===a?r:a,d=t.IO.connect((e.secure?"wss://":"ws://")+e.host,{reconnection:!0,reconnectionAttempts:3,secure:e.secure,forceNew:!0,transports:["websocket"],rejectUnauthorized:!1});var s=1e3,c=d.io.engine.transport.ws.onclose;d.io.engine.transport.ws.onclose=function(e){o.a.warning("WebSocket closed, code:",e.code),s=e.code,c(e)},t.socket=d,d.on("onAddStream",u.bind(t,"onAddStream")),d.on("stream_message_erizo",u.bind(t,"stream_message_erizo")),d.on("stream_message_p2p",u.bind(t,"stream_message_p2p")),d.on("connection_message_erizo",u.bind(t,"connection_message_erizo")),d.on("publish_me",u.bind(t,"publish_me")),d.on("unpublish_me",u.bind(t,"unpublish_me")),d.on("onBandwidthAlert",u.bind(t,"onBandwidthAlert")),d.on("onDataStream",u.bind(t,"onDataStream")),d.on("onUpdateAttributeStream",u.bind(t,"onUpdateAttributeStream")),d.on("onRemoveStream",u.bind(t,"onRemoveStream")),d.on("onAutomaticStreamsSubscription",u.bind(t,"onAutomaticStreamsSubscription")),d.on("disconnect",function(e){o.a.debug("disconnect",t.id,e),1e3!==s?t.state=t.RECONNECTING:(u("disconnect",e),d.close())}),d.on("connection_failed",function(e){o.a.error("connection failed, id:",t.id),u("connection_failed",e)}),d.on("error",function(e){o.a.warning("socket error, id:",t.id,", error:",e.message),u("error")}),d.on("connect_error",function(e){o.a.warning("connect error, id:",t.id,", error:",e.message)}),d.on("connect_timeout",function(e){o.a.warning("connect timeout, id:",t.id,", error:",e.message)}),d.on("reconnecting",function(e){o.a.debug("reconnecting, id:",t.id,", attempet:",e)}),d.on("reconnect",function(e){o.a.debug("reconnected, id:",t.id,", attempet:",e),t.state=t.CONNECTED,d.emit("reconnected",t.id),l()}),d.on("reconnect_attempt",function(e){o.a.debug("reconnect attempt, id:",t.id,", attempet:",e)}),d.on("reconnect_error",function(e){o.a.debug("error reconnecting, id:",t.id,", error:",e.message)}),d.on("reconnect_failed",function(){o.a.warning("reconnect failed, id:",t.id),t.state=t.DISCONNECTED,u("disconnect","reconnect failed")}),n.token=e,t.sendMessage("token",n,function(e){t.state=t.CONNECTED,t.id=e.clientId,i(e)},a)},t.disconnect=function(){t.state=t.DISCONNECTED,d.disconnect()},t.sendMessage=function(e,n,i,a){i=void 0===i?r:i,a=void 0===a?r:a,t.state===t.DISCONNECTED&&"token"!==e?o.a.error("Trying to send a message over a disconnected Socket"):t.state===t.RECONNECTING?c.push([e,n,i,a]):d.emit(e,n,function(e,t){"success"===e?i(t):"error"===e?a(t):i(e,t)})},t.sendSDP=function(e,i,a,s){s=void 0===s?r:s,t.state===t.DISCONNECTED?o.a.error("Trying to send a message over a disconnected Socket"):d.emit(e,i,a,function(e){for(var t=[],r=0;r<arguments.length;++r)t[r-0]=arguments[r];s.apply(null,[].concat(n.arrayFromIterable(t)))})},t}},function(e,t,r){e.exports=function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,r){function i(e,t){var n;"object"===(void 0===e?"undefined":o(e))&&(t=e,e=void 0),t=t||{};var r=(e=a(e)).source,i=e.id,s=e.path,s=u[i]&&s in u[i].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||s?(d("ignoring socket cache for %s",r),n=c(r,t)):(u[i]||(d("new io instance for %s",r),u[i]=c(r,t)),n=u[i]),e.query&&!t.query&&(t.query=e.query),n.socket(e.path,t)}n.initSymbol(),n.initSymbol(),n.initSymbolIterator();var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return n.initSymbol(),n.initSymbol(),n.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=r(1),s=r(7),c=r(13),d=r(3)("socket.io-client");e.exports=t=i;var u=t.managers={};t.protocol=s.protocol,t.connect=i,t.Manager=r(13),t.Socket=r(39)},function(e,t,n){(function(t){var r=n(2),i=n(3)("socket.io-client:url");e.exports=function(e,n){var o=e;return n=n||t.location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e=void 0!==n?n.protocol+"//"+e:"https://"+e),i("parse %s",e),o=r(e)),o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443")),o.path=o.path||"/",e=-1!==o.host.indexOf(":")?"["+o.host+"]":o.host,o.id=o.protocol+"://"+e+":"+o.port,o.href=o.protocol+"://"+e+(n&&n.port===o.port?"":":"+o.port),o}}).call(t,function(){return this}())},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r="source protocol authority userInfo user password host port relative path directory file query anchor".split(" ");e.exports=function(e){var t=e,i=e.indexOf("["),o=e.indexOf("]");-1!=i&&-1!=o&&(e=e.substring(0,i)+e.substring(i,o).replace(/:/g,";")+e.substring(o,e.length)),e=n.exec(e||"");for(var a={},s=14;s--;)a[r[s]]=e[s]||"";return-1!=i&&-1!=o&&(a.source=t,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(e,t,n){(function(r){function i(){try{var e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=r.env.DEBUG),e}(t=e.exports=n(5)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){n="color: "+this.color,e.splice(1,0,n,"color: inherit");var r=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(r++,"%c"===e&&(i=r))}),e.splice(i,0,n)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)};var o=t;if("undefined"!=typeof chrome&&void 0!==chrome.storage)var a=chrome.storage.local;else e:{try{a=window.localStorage;break e}catch(e){}a=void 0}o.storage=a,t.colors="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" "),t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())}).call(t,n(4))},function(e,t){function n(){throw Error("setTimeout has not been defined")}function r(){throw Error("clearTimeout has not been defined")}function i(e){if(u===setTimeout)return setTimeout(e,0);if((u===n||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function o(e){if(l===clearTimeout)return clearTimeout(e);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}function a(){h&&p&&(h=!1,p.length?f=p.concat(f):m=-1,f.length&&s())}function s(){if(!h){var e=i(a);h=!0;for(var t=f.length;t;){for(p=f,f=[];++m<t;)p&&p[m].run();m=-1,t=f.length}p=null,h=!1,o(e)}}function c(e,t){this.fun=e,this.array=t}function d(){}e=e.exports={};try{var u="function"==typeof setTimeout?setTimeout:n}catch(e){u=n}try{var l="function"==typeof clearTimeout?clearTimeout:r}catch(e){l=r}var p,f=[],h=!1,m=-1;e.nextTick=function(e){var t=Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new c(e,t)),1!==f.length||h||i(s)},c.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=d,e.addListener=d,e.once=d,e.off=d,e.removeListener=d,e.removeAllListeners=d,e.emit=d,e.prependListener=d,e.prependOnceListener=d,e.listeners=function(e){return[]},e.binding=function(e){throw Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw Error("process.chdir is not supported")},e.umask=function(){return 0}},function(e,t,n){function r(e){function n(){if(n.enabled){var e=+new Date;n.diff=e-(i||e),n.prev=i,i=n.curr=e;for(var r=Array(arguments.length),e=0;e<r.length;e++)r[e]=arguments[e];r[0]=t.coerce(r[0]),"string"!=typeof r[0]&&r.unshift("%O");var o=0;r[0]=r[0].replace(/%([a-zA-Z%])/g,function(e,i){return"%%"===e?e:(o++,"function"==typeof(i=t.formatters[i])&&(e=i.call(n,r[o]),r.splice(o,1),o--),e)}),t.formatArgs.call(n,r),(n.log||t.log||console.log.bind(console)).apply(n,r)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),"function"==typeof t.init&&t.init(n),n}var i;(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&("-"===(e=n[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var n,r=0;for(n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=n(6),t.names=[],t.skips=[],t.formatters={}},function(e,t){function n(e){if(!(100<(e=String(e)).length)&&(e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e))){var t=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return t*c;case"days":case"day":case"d":return t*s;case"hours":case"hour":case"hrs":case"hr":case"h":return t*a;case"minutes":case"minute":case"mins":case"min":case"m":return t*o;case"seconds":case"second":case"secs":case"sec":case"s":return t*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t}}}function r(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var i=1e3,o=60*i,a=60*o,s=24*a,c=365.25*s;e.exports=function(e,t){t=t||{};var c=typeof e;if("string"===c&&0<e.length)return n(e);if("number"===c&&!1===isNaN(e))return t.long?r(e,s,"day")||r(e,a,"hour")||r(e,o,"minute")||r(e,i,"second")||e+" ms":e>=s?Math.round(e/s)+"d":e>=a?Math.round(e/a)+"h":e>=o?Math.round(e/o)+"m":e>=i?Math.round(e/i)+"s":e+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){function r(){}function i(e){var n=""+e.type;return t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data&&(n+=JSON.stringify(e.data)),c("encoded %j as %s",e,n),n}function o(){this.reconstructor=null}function a(e){this.reconPack=e,this.buffers=[]}function s(){return{type:t.ERROR,data:"parser error"}}var c=n(3)("socket.io-parser");e=n(8);var d=n(9),u=n(11),l=n(12);t.protocol=4,t.types="CONNECT DISCONNECT EVENT ACK ERROR BINARY_EVENT BINARY_ACK".split(" "),t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=r,t.Decoder=o,r.prototype.encode=function(e,n){e.type!==t.EVENT&&e.type!==t.ACK||!d(e.data)||(e.type=e.type===t.EVENT?t.BINARY_EVENT:t.BINARY_ACK),c("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?function(e,t){u.removeBlobs(e,function(e){var n=u.deconstructPacket(e);e=i(n.packet),(n=n.buffers).unshift(e),t(n)})}(e,n):(e=i(e),n([e]))},e(o.prototype),o.prototype.add=function(e){if("string"==typeof e){var n,r=0,i={type:Number(e.charAt(0))};if(null==t.types[i.type])e=s();else{if(t.BINARY_EVENT===i.type||t.BINARY_ACK===i.type){for(n="";"-"!==e.charAt(++r)&&(n+=e.charAt(r),r!=e.length););if(n!=Number(n)||"-"!==e.charAt(r))throw Error("Illegal attachments");i.attachments=Number(n)}if("/"===e.charAt(r+1))for(i.nsp="";++r&&","!==(n=e.charAt(r))&&(i.nsp+=n,r!==e.length););else i.nsp="/";if(""!==(n=e.charAt(r+1))&&Number(n)==n){for(i.id="";++r;){if(null==(n=e.charAt(r))||Number(n)!=n){--r;break}if(i.id+=e.charAt(r),r===e.length)break}i.id=Number(i.id)}if(e.charAt(++r)){e:{r=e.substr(r);try{i.data=JSON.parse(r)}catch(e){r=s();break e}r=i}i=r}c("decoded %s as %j",e,i),e=i}t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?(this.reconstructor=new a(e),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",e)):this.emit("decoded",e)}else{if(!l(e)&&!e.base64)throw Error("Unknown type: "+e);if(!this.reconstructor)throw Error("got binary data when not reconstructing a packet");(e=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",e))}},o.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},a.prototype.takeBinaryData=function(e){return this.buffers.push(e),this.buffers.length===this.reconPack.attachments?(e=u.reconstructPacket(this.reconPack,this.buffers),this.finishedReconstruction(),e):null},a.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,n){function r(e){if(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks["$"+e];if(!n)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r,i=0;i<n.length;i++)if((r=n[i])===t||r.fn===t){n.splice(i,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var n=n.slice(0),r=0,i=n.length;r<i;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){(function(t){var r=n(10),i=Object.prototype.toString,o="function"==typeof t.Blob||"[object BlobConstructor]"===i.call(t.Blob),a="function"==typeof t.File||"[object FileConstructor]"===i.call(t.File);e.exports=function e(n){if(!n||"object"!=typeof n)return!1;if(r(n)){for(var i=0,s=n.length;i<s;i++)if(e(n[i]))return!0;return!1}if("function"==typeof t.Buffer&&t.Buffer.isBuffer&&t.Buffer.isBuffer(n)||"function"==typeof t.ArrayBuffer&&n instanceof ArrayBuffer||o&&n instanceof Blob||a&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return e(n.toJSON(),!0);for(i in n)if(Object.prototype.hasOwnProperty.call(n,i)&&e(n[i]))return!0;return!1}}).call(t,function(){return this}())},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){(function(e){var r=n(10),i=n(12),o=Object.prototype.toString,a="function"==typeof e.Blob||"[object BlobConstructor]"===o.call(e.Blob),s="function"==typeof e.File||"[object FileConstructor]"===o.call(e.File);t.deconstructPacket=function(e){var t=[];return e.data=function e(t,n){if(!t)return t;if(i(t)){var o={_placeholder:!0,num:n.length};return n.push(t),o}if(r(t)){o=Array(t.length);for(var a=0;a<t.length;a++)o[a]=e(t[a],n);return o}if("object"==typeof t&&!(t instanceof Date)){for(a in o={},t)o[a]=e(t[a],n);return o}return t}(e.data,t),e.attachments=t.length,{packet:e,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(r(t))for(var i=0;i<t.length;i++)t[i]=e(t[i],n);else if("object"==typeof t)for(i in t)t[i]=e(t[i],n);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,o=e;!function e(c,d,u){if(!c)return c;if(a&&c instanceof Blob||s&&c instanceof File){n++;var l=new FileReader;l.onload=function(){u?u[d]=this.result:o=this.result,--n||t(o)},l.readAsArrayBuffer(c)}else if(r(c))for(l=0;l<c.length;l++)e(c[l],l,c);else if("object"==typeof c&&!i(c))for(l in c)e(c[l],l,c)}(o),n||t(o)}}).call(t,function(){return this}())},function(e,t){(function(t){e.exports=function(e){return t.Buffer&&t.Buffer.isBuffer(e)||t.ArrayBuffer&&e instanceof ArrayBuffer}}).call(t,function(){return this}())},function(e,t,r){function i(e,t){if(!(this instanceof i))return new i(e,t);e&&"object"===(void 0===e?"undefined":o(e))&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new f({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[],e=t.parser||c,this.encoder=new e.Encoder,this.decoder=new e.Decoder,(this.autoConnect=!1!==t.autoConnect)&&this.open()}n.initSymbol(),n.initSymbol(),n.initSymbolIterator();var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return n.initSymbol(),n.initSymbol(),n.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=r(14),s=r(39);t=r(8);var c=r(7),d=r(41),u=r(42),l=r(3)("socket.io-client:manager"),p=r(37),f=r(43),h=Object.prototype.hasOwnProperty;e.exports=i,i.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)h.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},i.prototype.updateSocketIds=function(){for(var e in this.nsps)h.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},i.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},t(i.prototype),i.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},i.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},i.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},i.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},i.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},i.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},i.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},i.prototype.open=i.prototype.connect=function(e,t){if(l("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;l("opening %s",this.uri);var n=this.engine=a(this.uri,this.opts),r=this;this.readyState="opening",this.skipReconnect=!1;var i=d(n,"open",function(){r.onopen(),e&&e()});if(t=d(n,"error",function(t){if(l("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",t),e){var n=Error("Connection error");n.data=t,e(n)}else r.maybeReconnectOnOpen()}),!1!==this._timeout){var o=this._timeout;l("connect attempt will timeout after %d",o);var s=setTimeout(function(){l("connect attempt timed out after %d",o),i.destroy(),n.close(),n.emit("error","timeout"),r.emitAll("connect_timeout",o)},o);this.subs.push({destroy:function(){clearTimeout(s)}})}return this.subs.push(i),this.subs.push(t),this},i.prototype.onopen=function(){l("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(d(e,"data",u(this,"ondata"))),this.subs.push(d(e,"ping",u(this,"onping"))),this.subs.push(d(e,"pong",u(this,"onpong"))),this.subs.push(d(e,"error",u(this,"onerror"))),this.subs.push(d(e,"close",u(this,"onclose"))),this.subs.push(d(this.decoder,"decoded",u(this,"ondecoded")))},i.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},i.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},i.prototype.ondata=function(e){this.decoder.add(e)},i.prototype.ondecoded=function(e){this.emit("packet",e)},i.prototype.onerror=function(e){l("error",e),this.emitAll("error",e)},i.prototype.socket=function(e,t){function n(){~p(i.connecting,r)||i.connecting.push(r)}var r=this.nsps[e];if(!r){r=new s(this,e,t),this.nsps[e]=r;var i=this;r.on("connecting",n),r.on("connect",function(){r.id=i.generateId(e)}),this.autoConnect&&n()}return r},i.prototype.destroy=function(e){~(e=p(this.connecting,e))&&this.connecting.splice(e,1),this.connecting.length||this.close()},i.prototype.packet=function(e){l("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},i.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},i.prototype.cleanup=function(){l("cleanup");for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},i.prototype.close=i.prototype.disconnect=function(){l("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},i.prototype.onclose=function(e){l("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},i.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)l("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();l("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(l("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(l("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(l("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},i.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){e.exports=n(15)},function(e,t,n){e.exports=n(16),e.exports.parser=n(23)},function(e,t,n){(function(t){function r(e,n){if(!(this instanceof r))return new r(e,n);n=n||{},e&&"object"==typeof e&&(n=e,e=null),e?(e=d(e),n.hostname=e.host,n.secure="https"===e.protocol||"wss"===e.protocol,n.port=e.port,e.query&&(n.query=e.query)):n.host&&(n.hostname=d(n.host).host),this.secure=null!=n.secure?n.secure:t.location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.agent=n.agent||!1,this.hostname=n.hostname||(t.location?location.hostname:"localhost"),this.port=n.port||(t.location&&location.port?location.port:this.secure?443:80),this.query=n.query||{},"string"==typeof this.query&&(this.query=l.decode(this.query)),this.upgrade=!1!==n.upgrade,this.path=(n.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!n.forceJSONP,this.jsonp=!1!==n.jsonp,this.forceBase64=!!n.forceBase64,this.enablesXDR=!!n.enablesXDR,this.timestampParam=n.timestampParam||"t",this.timestampRequests=n.timestampRequests,this.transports=n.transports||["polling","websocket"],this.transportOptions=n.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=n.policyPort||843,this.rememberUpgrade=n.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=n.onlyBinaryUpgrades,this.perMessageDeflate=!1!==n.perMessageDeflate&&(n.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=n.pfx||null,this.key=n.key||null,this.passphrase=n.passphrase||null,this.cert=n.cert||null,this.ca=n.ca||null,this.ciphers=n.ciphers||null,this.rejectUnauthorized=void 0===n.rejectUnauthorized||n.rejectUnauthorized,this.forceNode=!!n.forceNode,(e="object"==typeof t&&t).global===e&&(n.extraHeaders&&0<Object.keys(n.extraHeaders).length&&(this.extraHeaders=n.extraHeaders),n.localAddress&&(this.localAddress=n.localAddress)),this.pingTimeoutTimer=this.pingIntervalTimer=this.pingTimeout=this.pingInterval=this.upgrades=this.id=null,this.open()}var i=n(17),o=n(8),a=n(3)("engine.io-client:socket"),s=n(37),c=n(23),d=n(2),u=n(38),l=n(31);e.exports=r,r.priorWebsocketSuccess=!1,o(r.prototype),r.protocol=c.protocol,r.Socket=r,r.Transport=n(22),r.transports=n(17),r.parser=n(23),r.prototype.createTransport=function(e){a('creating transport "%s"',e);var t,n=this.query,r={};for(t in n)n.hasOwnProperty(t)&&(r[t]=n[t]);return r.EIO=c.protocol,r.transport=e,n=this.transportOptions[e]||{},this.id&&(r.sid=this.id),new i[e]({query:r,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0})},r.prototype.open=function(){if(this.rememberUpgrade&&r.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))var e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},r.prototype.setTransport=function(e){a("setting transport %s",e.name);var t=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},r.prototype.probe=function(e){function t(){if(p.onlyBinaryUpgrades){var t=!this.supportsBinary&&p.transport.supportsBinary;l=l||t}l||(a('probe transport "%s" opened',e),u.send([{type:"ping",data:"probe"}]),u.once("packet",function(t){l||("pong"===t.type&&"probe"===t.data?(a('probe transport "%s" pong',e),p.upgrading=!0,p.emit("upgrading",u),u&&(r.priorWebsocketSuccess="websocket"===u.name,a('pausing current transport "%s"',p.transport.name),p.transport.pause(function(){l||"closed"!==p.readyState&&(a("changing transport and sending upgrade packet"),d(),p.setTransport(u),u.send([{type:"upgrade"}]),p.emit("upgrade",u),u=null,p.upgrading=!1,p.flush())}))):(a('probe transport "%s" failed',e),(t=Error("probe error")).transport=u.name,p.emit("upgradeError",t)))}))}function n(){l||(l=!0,d(),u.close(),u=null)}function i(t){var r=Error("probe error: "+t);r.transport=u.name,n(),a('probe transport "%s" failed because of error: %s',e,t),p.emit("upgradeError",r)}function o(){i("transport closed")}function s(){i("socket closed")}function c(e){u&&e.name!==u.name&&(a('"%s" works - aborting "%s"',e.name,u.name),n())}function d(){u.removeListener("open",t),u.removeListener("error",i),u.removeListener("close",o),p.removeListener("close",s),p.removeListener("upgrading",c)}a('probing transport "%s"',e);var u=this.createTransport(e,{probe:1}),l=!1,p=this;r.priorWebsocketSuccess=!1,u.once("open",t),u.once("error",i),u.once("close",o),this.once("close",s),this.once("upgrading",c),u.open()},r.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",r.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},r.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(a('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(u(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else a('packet received with socket readyState "%s"',this.readyState)},r.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},r.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},r.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){a("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},r.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},r.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},r.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},r.prototype.write=r.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},r.prototype.sendPacket=function(e,t,n,r){"function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState&&((n=n||{}).compress=!1!==n.compress,e={type:e,data:t,options:n},this.emit("packetCreate",e),this.writeBuffer.push(e),r&&this.once("flush",r),this.flush())},r.prototype.close=function(){function e(){r.onClose("forced close"),a("socket closing - telling transport to close"),r.transport.close()}function t(){r.removeListener("upgrade",t),r.removeListener("upgradeError",t),e()}function n(){r.once("upgrade",t),r.once("upgradeError",t)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var r=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}return this},r.prototype.onError=function(e){a("socket error %j",e),r.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},r.prototype.onClose=function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(a('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},r.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~s(this.transports,e[n])&&t.push(e[n]);return t}}).call(t,function(){return this}())},function(e,t,n){(function(e){var r=n(18),i=n(20),o=n(34),a=n(35);t.polling=function(t){var n=!1,a=!1,s=!1!==t.jsonp;if(e.location&&(a="https:"===location.protocol,(n=location.port)||(n=a?443:80),n=t.hostname!==location.hostname||n!==t.port,a=t.secure!==a),t.xdomain=n,t.xscheme=a,"open"in new r(t)&&!t.forceJSONP)return new i(t);if(!s)throw Error("JSONP disabled");return new o(t)},t.websocket=a}).call(t,function(){return this}())},function(e,t,n){(function(t){var r=n(19);e.exports=function(e){var n=e.xdomain,i=e.xscheme;e=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!n||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!i&&e)return new XDomainRequest}catch(e){}if(!n)try{return new(t[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}}).call(t,function(){return this}())},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,n){(function(t){function r(){}function i(e){if(c.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,t.location){var n="https:"===location.protocol,r=location.port;r||(r=n?443:80),this.xd=e.hostname!==t.location.hostname||r!==e.port,this.xs=e.secure!==n}}function o(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}function a(){for(var e in o.requests)o.requests.hasOwnProperty(e)&&o.requests[e].abort()}var s=n(18),c=n(21),d=n(8),u=n(32),l=n(3)("engine.io-client:polling-xhr");e.exports=i,e.exports.Request=o,u(i,c),i.prototype.supportsBinary=!0,i.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new o(e)},i.prototype.doWrite=function(e,t){e=this.request({method:"POST",data:e,isBinary:"string"!=typeof e&&void 0!==e});var n=this;e.on("success",t),e.on("error",function(e){n.onError("xhr post error",e)}),this.sendXhr=e},i.prototype.doPoll=function(){l("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},d(o.prototype),o.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var n=this.xhr=new s(e),r=this;try{l("xhr open %s: %s",this.method,this.uri),n.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&n.setRequestHeader(i,this.extraHeaders[i])}catch(e){}if("POST"===this.method)try{this.isBinary?n.setRequestHeader("Content-type","application/octet-stream"):n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{n.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in n&&(n.withCredentials=!0),this.requestTimeout&&(n.timeout=this.requestTimeout),this.hasXDR()?(n.onload=function(){r.onLoad()},n.onerror=function(){r.onError(n.responseText)}):n.onreadystatechange=function(){if(2===n.readyState){try{var e=n.getResponseHeader("Content-Type")}catch(e){}"application/octet-stream"===e&&(n.responseType="arraybuffer")}4===n.readyState&&(200===n.status||1223===n.status?r.onLoad():setTimeout(function(){r.onError(n.status)},0))},l("xhr data %s",this.data),n.send(this.data)}catch(e){return void setTimeout(function(){r.onError(e)},0)}t.document&&(this.index=o.requestsCount++,o.requests[this.index]=this)},o.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},o.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},o.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},o.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=r:this.xhr.onreadystatechange=r,e)try{this.xhr.abort()}catch(e){}t.document&&delete o.requests[this.index],this.xhr=null}},o.prototype.onLoad=function(){try{try{var e=this.xhr.getResponseHeader("Content-Type")}catch(e){}var t="application/octet-stream"===e&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=t&&this.onData(t)},o.prototype.hasXDR=function(){return void 0!==t.XDomainRequest&&!this.xs&&this.enablesXDR},o.prototype.abort=function(){this.cleanup()},o.requestsCount=0,o.requests={},t.document&&(t.attachEvent?t.attachEvent("onunload",a):t.addEventListener&&t.addEventListener("beforeunload",a,!1))}).call(t,function(){return this}())},function(e,t,n){function r(e){var t=e&&e.forceBase64;d&&!t||(this.supportsBinary=!1),i.call(this,e)}var i=n(22),o=n(31),a=n(23);t=n(32);var s=n(33),c=n(3)("engine.io-client:polling");e.exports=r;var d=null!=new(n(18))({xdomain:!1}).responseType;t(r,i),r.prototype.name="polling",r.prototype.doOpen=function(){this.poll()},r.prototype.pause=function(e){function t(){c("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(c("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){c("pre-pause polling complete"),--r||t()})),this.writable||(c("we are currently writing - waiting to pause"),r++,this.once("drain",function(){c("pre-pause writing complete"),--r||t()}))}else t()},r.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},r.prototype.onData=function(e){var t=this;c("polling got data %s",e),a.decodePayload(e,this.socket.binaryType,function(e,n,r){return"opening"===t.readyState&&t.onOpen(),"close"===e.type?(t.onClose(),!1):void t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},r.prototype.doClose=function(){function e(){c("writing close packet"),t.write([{type:"close"}])}var t=this;"open"===this.readyState?(c("transport open - closing"),e()):(c("transport not open - deferring close"),this.once("open",e))},r.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};a.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";!1!==this.timestampRequests&&(e[this.timestampParam]=s()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e);var r=-1!==this.hostname.indexOf(":");return t+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,n){function r(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}var i=n(23);t=n(8),e.exports=r,t(r.prototype),r.prototype.onError=function(e,t){return(e=Error(e)).type="TransportError",e.description=t,this.emit("error",e),this},r.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},r.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},r.prototype.send=function(e){if("open"!==this.readyState)throw Error("Transport not open");this.write(e)},r.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},r.prototype.onData=function(e){e=i.decodePacket(e,this.socket.binaryType),this.onPacket(e)},r.prototype.onPacket=function(e){this.emit("packet",e)},r.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){(function(e){function r(e,t,n){var r=Array(e.length);n=c(e.length,n);for(var i=function(e,n,i){t(n,function(t,n){r[e]=n,i(t,r)})},o=0;o<e.length;o++)i(o,e[o],n)}var i,o=n(24),a=n(9),s=n(25),c=n(26),d=n(27);e&&e.ArrayBuffer&&(i=n(29));var u="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),l="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),p=u||l;t.protocol=3;var f=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},h=o(f),m={type:"error",data:"parser error"},y=n(30);t.encodePacket=function(n,r,i,o){"function"==typeof r&&(o=r,r=!1),"function"==typeof i&&(o=i,i=null);var a=void 0===n.data?void 0:n.data.buffer||n.data;if(e.ArrayBuffer&&a instanceof ArrayBuffer){if(r){for(i=n.data,r=new Uint8Array(i),(i=new Uint8Array(1+i.byteLength))[0]=f[n.type],n=0;n<r.length;n++)i[n+1]=r[n];n=o(i.buffer)}else n=t.encodeBase64Packet(n,o);return n}return y&&a instanceof e.Blob?(r?p?n=function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=new FileReader;return i.onload=function(){e.data=i.result,t.encodePacket(e,n,!0,r)},i.readAsArrayBuffer(e.data)}(n,r,o):((r=new Uint8Array(1))[0]=f[n.type],n=new y([r.buffer,n.data]),n=o(n)):n=t.encodeBase64Packet(n,o),n):a&&a.base64?o("b"+t.packets[n.type]+n.data.data):(r=f[n.type],void 0!==n.data&&(r+=i?d.encode(String(n.data),{strict:!1}):String(n.data)),o(""+r))},t.encodeBase64Packet=function(n,r){var i="b"+t.packets[n.type];if(y&&n.data instanceof e.Blob){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];r(i+e)},o.readAsDataURL(n.data)}try{var a=String.fromCharCode.apply(null,new Uint8Array(n.data))}catch(e){n=new Uint8Array(n.data),a=Array(n.length);for(var s=0;s<n.length;s++)a[s]=n[s];a=String.fromCharCode.apply(null,a)}return i+=e.btoa(a),r(i)},t.decodePacket=function(e,n,r){if(void 0===e)return m;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(n=r){n=e;try{n=d.decode(n,{strict:!1})}catch(e){n=!1}n=!1===(e=n)}return n?m:(r=e.charAt(0),Number(r)==r&&h[r]?1<e.length?{type:h[r],data:e.substring(1)}:{type:h[r]}:m)}return r=new Uint8Array(e)[0],e=s(e,1),y&&"blob"===n&&(e=new y([e])),{type:h[r],data:e}},t.decodeBase64Packet=function(e,t){var n=h[e.charAt(0)];return i?(e=i.decode(e.substr(1)),"blob"===t&&y&&(e=new y([e])),{type:n,data:e}):{type:n,data:{base64:!0,data:e.substr(1)}}},t.encodePayload=function(e,n,i){"function"==typeof n&&(i=n,n=null);var o=a(e);return n&&o?y&&!p?t.encodePayloadAsBlob(e,i):t.encodePayloadAsArrayBuffer(e,i):e.length?void r(e,function(e,r){t.encodePacket(e,!!o&&n,!1,function(e){r(null,e.length+":"+e)})},function(e,t){return i(t.join(""))}):i("0:")},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);var i;if("function"==typeof n&&(r=n,n=null),""===e)return r(m,0,1);for(var o,a,s="",c=0,d=e.length;c<d;c++){var u=e.charAt(c);if(":"===u){if(""===s||s!=(o=Number(s))||(a=e.substr(c+1,o),s!=a.length))return r(m,0,1);if(a.length){if(i=t.decodePacket(a,n,!1),m.type===i.type&&m.data===i.data)return r(m,0,1);if(!1===r(i,c+o,d))return}c+=o,s=""}else s+=u}return""!==s?r(m,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){return e.length?void r(e,function(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})},function(e,t){e=t.reduce(function(e,t){var n;return n="string"==typeof t?t.length:t.byteLength,e+n.toString().length+n+2},0);var r=new Uint8Array(e),i=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var n=new Uint8Array(e.length),o=0;o<e.length;o++)n[o]=e.charCodeAt(o);n=n.buffer}for(r[i++]=t?0:1,e=n.byteLength.toString(),o=0;o<e.length;o++)r[i++]=parseInt(e[o]);for(r[i++]=255,n=new Uint8Array(n),o=0;o<n.length;o++)r[i++]=n[o]}),n(r.buffer)}):n(new ArrayBuffer(0))},t.encodePayloadAsBlob=function(e,n){r(e,function(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);e=r.buffer,t[0]=0}for(var r=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),o=new Uint8Array(r.length+1),i=0;i<r.length;i++)o[i]=parseInt(r[i]);o[r.length]=255,y&&(e=new y([t.buffer,o.buffer,e]),n(null,e))})},function(e,t){return n(new y(t))})},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var i=[];0<e.byteLength;){for(var o=new Uint8Array(e),a=0===o[0],c="",d=1;255!==o[d];d++){if(310<c.length)return r(m,0,1);c+=o[d]}if(e=s(e,2+c.length),c=parseInt(c),o=s(e,0,c),a)try{o=String.fromCharCode.apply(null,new Uint8Array(o))}catch(e){for(a=new Uint8Array(o),o="",d=0;d<a.length;d++)o+=String.fromCharCode(a[d])}i.push(o),e=s(e,c)}var u=i.length;i.forEach(function(e,i){r(t.decodePacket(e,n,!0),i,u)})}}).call(t,function(){return this}())},function(e,t){e.exports=Object.keys||function(e){var t,n=[],r=Object.prototype.hasOwnProperty;for(t in e)r.call(e,t)&&n.push(t);return n}},function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(0>t&&(t+=r),0>n&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);e=new Uint8Array(e);for(var r=new Uint8Array(n-t),i=0;t<n;t++,i++)r[i]=e[t];return r.buffer}},function(e,t){function n(){}e.exports=function(e,t,r){function i(e,n){if(0>=i.count)throw Error("after called too many times");--i.count,e?(o=!0,t(e),t=r):0!==i.count||o||t(null,n)}var o=!1;return r=r||n,i.count=e,0===e?t():i}},function(e,t,n){var r;(function(e,i){!function(i){function o(e){for(var t,n,r=[],i=0,o=e.length;i<o;)55296<=(t=e.charCodeAt(i++))&&56319>=t&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function a(e,t){if(55296<=e&&57343>=e){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function s(){if(l>=u)throw Error("Invalid byte index");var e=255&d[l];if(l++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function c(e){var t,n,r,i,o;if(l>u)throw Error("Invalid byte index");if(l==u)return!1;if(t=255&d[l],l++,0==(128&t))return t;if(192==(224&t)){if(n=s(),128<=(o=(31&t)<<6|n))return o;throw Error("Invalid continuation byte")}if(224==(240&t)){if(n=s(),r=s(),2048<=(o=(15&t)<<12|n<<6|r))return a(o,e)?o:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(n=s(),r=s(),i=s(),65536<=(o=(7&t)<<18|n<<12|r<<6|i)&&1114111>=o))return o;throw Error("Invalid UTF-8 detected")}"object"==typeof e&&e&&e.exports;var d,u,l,p=String.fromCharCode,f={version:"2.1.2",encode:function(e,t){t=!1!==(t=t||{}).strict;for(var n=(e=o(e)).length,r=-1,i="";++r<n;){var s=e[r],c=t;if(0==(4294967168&s))c=p(s);else{var d="";0==(4294965248&s)?d=p(s>>6&31|192):0==(4294901760&s)?(a(s,c)||(s=65533),d=p(s>>12&15|224),d+=p(s>>6&63|128)):0==(4292870144&s)&&(d=p(s>>18&7|240),d+=p(s>>12&63|128),d+=p(s>>6&63|128)),c=d+p(63&s|128)}i+=c}return i},decode:function(e,t){var n;for(t=!1!==(t=t||{}).strict,d=o(e),u=d.length,l=0,e=[];!1!==(n=c(t));)e.push(n);n=e.length;for(var r=-1,i="";++r<n;)65535<(t=e[r])&&(i+=p((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=p(t);return i}};void 0===(r=function(){return f}.call(t,n,t,e))||(e.exports=r)}()}).call(t,n(28)(e),function(){return this}())},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children=[],e.webpackPolyfill=1),e}},function(e,t){!function(){for(var e=new Uint8Array(256),n=0;64>n;n++)e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(n)]=n;t.encode=function(e){var t=new Uint8Array(e),n=t.length,r="";for(e=0;e<n;e+=3)r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[t[e]>>2],r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(3&t[e])<<4|t[e+1]>>4],r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[(15&t[e+1])<<2|t[e+2]>>6],r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&t[e+2]];return 2==n%3?r=r.substring(0,r.length-1)+"=":1==n%3&&(r=r.substring(0,r.length-2)+"=="),r},t.decode=function(t){var n=.75*t.length,r=t.length,i=0;"="===t[t.length-1]&&(n--,"="===t[t.length-2]&&n--);var o=new ArrayBuffer(n),a=new Uint8Array(o);for(n=0;n<r;n+=4){var s=e[t.charCodeAt(n)],c=e[t.charCodeAt(n+1)],d=e[t.charCodeAt(n+2)],u=e[t.charCodeAt(n+3)];a[i++]=s<<2|c>>4,a[i++]=(15&c)<<4|d>>2,a[i++]=(3&d)<<6|63&u}return o}}()},function(e,t){(function(t){function n(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var r=n.buffer;if(n.byteLength!==r.byteLength){var i=new Uint8Array(n.byteLength);i.set(new Uint8Array(r,n.byteOffset,n.byteLength)),r=i.buffer}e[t]=r}}}var r,i=t.BlobBuilder||t.WebKitBlobBuilder||t.MSBlobBuilder||t.MozBlobBuilder;try{var o=2===new Blob(["hi"]).size}catch(e){o=!1}if(r=o)try{r=2===new Blob([new Uint8Array([1,2])]).size}catch(e){r=!1}var a=i&&i.prototype.append&&i.prototype.getBlob;e.exports=o?r?t.Blob:function(e,t){return n(e),new Blob(e,t||{})}:a?function(e,t){t=t||{};var r=new i;n(e);for(var o=0;o<e.length;o++)r.append(e[o]);return t.type?r.getBlob(t.type):r.getBlob()}:void 0}).call(t,function(){return this}())},function(e,t){t.encode=function(e){var t,n="";for(t in e)e.hasOwnProperty(t)&&(n.length&&(n+="&"),n+=encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return n},t.decode=function(e){var t={};e=e.split("&");for(var n=0,r=e.length;n<r;n++){var i=e[n].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){function n(e){var t="";do{t=o[e%a]+t,e=Math.floor(e/a)}while(0<e);return t}function r(){var e=n(+new Date);return e!==i?(c=0,i=e):e+"."+n(c++)}for(var i,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a=64,s={},c=0,d=0;d<a;d++)s[o[d]]=d;r.encode=n,r.decode=function(e){var t=0;for(d=0;d<e.length;d++)t=t*a+s[e.charAt(d)];return t},e.exports=r},function(e,t,n){(function(t){function r(){}function i(e){o.call(this,e),this.query=this.query||{},s||(t.___eio||(t.___eio=[]),s=t.___eio),this.index=s.length;var n=this;s.push(function(e){n.onData(e)}),this.query.j=this.index,t.document&&t.addEventListener&&t.addEventListener("beforeunload",function(){n.script&&(n.script.onerror=r)},!1)}var o=n(21),a=n(32);e.exports=i;var s,c=/\n/g,d=/\\n/g;a(i,o),i.prototype.supportsBinary=!1,i.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o.prototype.doClose.call(this)},i.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},i.prototype.doWrite=function(e,t){function n(){r(),t()}function r(){if(o.iframe)try{o.form.removeChild(o.iframe)}catch(e){o.onError("jsonp polling iframe removal error",e)}try{i=document.createElement('<iframe src="javascript:0" name="'+o.iframeId+'">')}catch(e){(i=document.createElement("iframe")).name=o.iframeId,i.src="javascript:0"}i.id=o.iframeId,o.form.appendChild(i),o.iframe=i}var i,o=this;if(!this.form){var a=document.createElement("form"),s=document.createElement("textarea"),u=this.iframeId="eio_iframe_"+this.index;a.className="socketio",a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.target=u,a.method="POST",a.setAttribute("accept-charset","utf-8"),s.name="d",a.appendChild(s),document.body.appendChild(a),this.form=a,this.area=s}this.form.action=this.uri(),r(),e=e.replace(d,"\\\n"),this.area.value=e.replace(c,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===o.iframe.readyState&&n()}:this.iframe.onload=n}}).call(t,function(){return this}())},function(e,t,n){(function(t){function r(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=u&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(p=l),i.call(this,e)}var i=n(22),o=n(23),a=n(31),s=n(32),c=n(33),d=n(3)("engine.io-client:websocket"),u=t.WebSocket||t.MozWebSocket;if("undefined"==typeof window)try{var l=n(36)}catch(e){}var p=u;p||"undefined"!=typeof window||(p=l),e.exports=r,s(r,i),r.prototype.name="websocket",r.prototype.supportsBinary=!0,r.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?t?new p(e,t):new p(e):new p(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},r.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},r.prototype.write=function(e){var n=this;this.writable=!1;for(var r=e.length,i=0,a=r;i<a;i++)!function(e){o.encodePacket(e,n.supportsBinary,function(i){if(!n.usingBrowserWebSocket){var o={};e.options&&(o.compress=e.options.compress),n.perMessageDeflate&&("string"==typeof i?t.Buffer.byteLength(i):i.length)<n.perMessageDeflate.threshold&&(o.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(i):n.ws.send(i,o)}catch(e){d("websocket closed before onclose event")}--r||(n.emit("flush"),setTimeout(function(){n.writable=!0,n.emit("drain")},0))})}(e[i])},r.prototype.onClose=function(){i.prototype.onClose.call(this)},r.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},r.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=c()),this.supportsBinary||(e.b64=1),(e=a.encode(e)).length&&(e="?"+e);var r=-1!==this.hostname.indexOf(":");return t+"://"+(r?"["+this.hostname+"]":this.hostname)+n+this.path+e},r.prototype.check=function(){return!(!p||"__initialize"in p&&this.name===r.prototype.name)}}).call(t,function(){return this}())},function(e,t){},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t){(function(t){var n=/^[\],:{}\s]*$/,r=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,o=/(?:^|:|,)(?:\s*\[)+/g,a=/^\s+/,s=/\s+$/;e.exports=function(e){return"string"==typeof e&&e?(e=e.replace(a,"").replace(s,""),t.JSON&&JSON.parse?JSON.parse(e):n.test(e.replace(r,"@").replace(i,"]").replace(o,""))?new Function("return "+e)():void 0):null}}).call(t,function(){return this}())},function(e,t,r){function i(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}n.initSymbol(),n.initSymbol(),n.initSymbolIterator();var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return n.initSymbol(),n.initSymbol(),n.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=r(7);t=r(8);var s=r(40),c=r(41),d=r(42),u=r(3)("socket.io-client:socket"),l=r(31);e.exports=i;var p={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=t.prototype.emit;t(i.prototype),i.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[c(e,"open",d(this,"onopen")),c(e,"packet",d(this,"onpacket")),c(e,"close",d(this,"onclose"))]}},i.prototype.open=i.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},i.prototype.send=function(){var e=s(arguments);return e.unshift("message"),this.emit.apply(this,e),this},i.prototype.emit=function(e){if(p.hasOwnProperty(e))return f.apply(this,arguments),this;var t=s(arguments),n={type:a.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),delete this.flags,this},i.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},i.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"===o(this.query)?l.encode(this.query):this.query;u("sending connect packet with query %s",e),this.packet({type:a.CONNECT,query:e})}else this.packet({type:a.CONNECT})},i.prototype.onclose=function(e){u("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},i.prototype.onpacket=function(e){if(e.nsp===this.nsp)switch(e.type){case a.CONNECT:this.onconnect();break;case a.EVENT:case a.BINARY_EVENT:this.onevent(e);break;case a.ACK:case a.BINARY_ACK:this.onack(e);break;case a.DISCONNECT:this.ondisconnect();break;case a.ERROR:this.emit("error",e.data)}},i.prototype.onevent=function(e){var t=e.data||[];u("emitting event %j",t),null!=e.id&&(u("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?f.apply(this,t):this.receiveBuffer.push(t)},i.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var r=s(arguments);u("sending ack %j",r),t.packet({type:a.ACK,id:e,data:r})}}},i.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(u("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):u("bad ack %s",e.id)},i.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},i.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)f.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},i.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},i.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},i.prototype.close=i.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:a.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},i.prototype.compress=function(e){return this.flags=this.flags||{},this.flags.compress=e,this}},function(e,t){e.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},function(e,t){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=0<e.jitter&&1>=e.jitter?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter)var t=Math.random(),n=Math.floor(t*this.jitter*e),e=0==(1&Math.floor(10*t))?e-n:e+n;return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}}])},function(e,t,n){var r=n(5),i=n(23);t.a=function(e){var t=Object(r.a)({});t.id=e.id,t.stream=e.stream.stream,t.elementID=e.elementID;var n=function(e,n,r,i){(i?1/e*n>r:1/e*n<r)?(t.video.style.width=n+"px",t.video.style.height=1/e*n+"px",t.video.style.top=-(1/e*n/2-r/2)+"px",t.video.style.left="0px"):(t.video.style.height=r+"px",t.video.style.width=e*r+"px",t.video.style.left=-(e*r/2-n/2)+"px",t.video.style.top="0px")};return t.destroy=function(){t.video.pause(),delete t.resizer,t.parentNode.removeChild(t.div)},t.resize=function(){var r=t.container.offsetWidth,i=t.container.offsetHeight;e.stream.screen||!1===e.options.crop?n(16/9,r,i,!1):r===t.containerWidth&&i===t.containerHeight||n(4/3,r,i,!0),t.containerWidth=r,t.containerHeight=i},t.div=document.createElement("div"),t.div.setAttribute("id","player_"+t.id),t.div.setAttribute("class","licode_player"),t.div.setAttribute("style","width: 100%; height: 100%; position: relative; background-color: black; overflow: hidden;"),!1!==e.options.loader&&(t.loader=document.createElement("img"),t.loader.setAttribute("style","width: 16px; height: 16px; position: absolute; top: 50%; left: 50%; margin-top: -8px; margin-left: -8px"),t.loader.setAttribute("id","back_"+t.id),t.loader.setAttribute("class","licode_loader"),t.loader.setAttribute("src",t.url+"/assets/loader.gif")),t.video=document.createElement("video"),t.video.setAttribute("id","stream"+t.id),t.video.setAttribute("class","licode_stream"),t.video.setAttribute("style","width: 100%; height: 100%; position: absolute"),t.video.setAttribute("autoplay","autoplay"),t.video.setAttribute("playsinline","playsinline"),e.stream.local&&(t.video.volume=0),t.container=void 0!==t.elementID?"object"==typeof t.elementID&&"function"==typeof t.elementID.appendChild?t.elementID:document.getElementById(t.elementID):document.body,t.container.appendChild(t.div),t.parentNode=t.div.parentNode,t.loader&&t.div.appendChild(t.loader),t.div.appendChild(t.video),t.containerWidth=0,t.containerHeight=0,!1!==e.options.resizer&&(t.resizer=L.ResizeSensor(t.container,t.resize),t.resize()),!1!==e.options.bar?(t.bar=Object(i.a)({elementID:"player_"+t.id,id:t.id,stream:e.stream,media:t.video,options:e.options}),t.div.onmouseover=function(){t.bar.display()},t.div.onmouseout=function(){t.bar.hide()}):t.media=t.video,t.video.srcObject=t.stream,t}},function(e,t,n){var r=n(5);t.a=function(e){var t=Object(r.a)({}),n=50;if(t.elementID=e.elementID,t.media=e.media,t.id=e.id,t.stream=e.stream,t.div=document.createElement("div"),t.div.setAttribute("style","width: 40%; height: 100%; max-width: 32px; position: absolute; right: 0;z-index:0;"),t.icon=document.createElement("img"),t.icon.setAttribute("id","volume_"+t.id),t.icon.setAttribute("src",t.url+"/assets/sound48.png"),t.icon.setAttribute("style","width: 80%; height: 100%; position: absolute;"),t.div.appendChild(t.icon),t.icon.onclick=function(){t.media.muted?(t.media.muted=!1,t.icon.setAttribute("src",t.url+"/assets/sound48.png"),t.stream.local?t.stream.stream.getAudioTracks()[0].enabled=!0:(t.picker.value=n,t.media.volume=t.picker.value/100)):(t.media.muted=!0,t.icon.setAttribute("src",t.url+"/assets/mute48.png"),t.stream.local?t.stream.stream.getAudioTracks()[0].enabled=!1:(n=t.picker.value,t.picker.value=0,t.media.volume=0))},!t.stream.local){t.picker=document.createElement("input"),t.picker.setAttribute("id","picker_"+t.id),t.picker.type="range",t.picker.min=0,t.picker.max=100,t.picker.step=10,t.picker.value=n,t.picker.setAttribute("orient","vertical"),t.div.appendChild(t.picker),t.media.volume=t.picker.value/100,t.media.muted=!1,t.picker.oninput=function(){0<t.picker.value?(t.media.muted=!1,t.icon.setAttribute("src",t.url+"/assets/sound48.png")):(t.media.muted=!0,t.icon.setAttribute("src",t.url+"/assets/mute48.png")),t.media.volume=t.picker.value/100};var i=function(e){t.picker.setAttribute("style","background: transparent; width: 32px;\n                                         height: 100px; position: absolute; bottom: 90%;\n                                         z-index: 1; right: 0px; -webkit-appearance: slider-vertical;\n                                         bottom: "+t.div.offsetHeight+"px; display: "+e)};t.div.onmouseover=function(){i("block")},t.div.onmouseout=function(){i("none")},i("none")}return document.getElementById(t.elementID).appendChild(t.div),t}},function(e,t,n){var r=n(5),i=n(23);t.a=function(e){var t=Object(r.a)({});if(t.id=e.id,t.stream=e.stream.stream,t.elementID=e.elementID,t.audio=document.createElement("audio"),t.audio.setAttribute("id","stream"+t.id),t.audio.setAttribute("class","licode_stream"),t.audio.setAttribute("style","width: 100%; height: 100%; position: absolute"),t.audio.setAttribute("autoplay","autoplay"),e.stream.local&&(t.audio.volume=0),void 0!==t.elementID){t.destroy=function(){t.audio.pause(),t.parentNode.removeChild(t.div)};t.div=document.createElement("div"),t.div.setAttribute("id","player_"+t.id),t.div.setAttribute("class","licode_player"),t.div.setAttribute("style","width: 100%; height: 100%; position: relative; overflow: hidden;"),t.container="object"==typeof t.elementID&&"function"==typeof t.elementID.appendChild?t.elementID:document.getElementById(t.elementID),t.container.appendChild(t.div),t.parentNode=t.div.parentNode,t.div.appendChild(t.audio),!1!==e.options.bar?(t.bar=Object(i.a)({elementID:"player_"+t.id,id:t.id,stream:e.stream,media:t.audio,options:e.options}),t.div.onmouseover=function(){t.bar.display()},t.div.onmouseout=function(){t.bar.hide()}):t.media=t.audio}else t.destroy=function(){t.audio.pause(),t.parentNode.removeChild(t.audio)},document.body.appendChild(t.audio),t.parentNode=document.body;return t.audio.srcObject=t.stream,t}},function(e,t,n){e=function(){for(var e,t,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),r=[],i=0;i<n.length;i+=1)r[n[i]]=i;var o=function(){if(!e||t>=e.length)return-1;var n=255&e.charCodeAt(t);return t+=1,n},a=function(){if(!e)return-1;for(;;){if(t>=e.length)return-1;var n=e.charAt(t);if(t+=1,r[n])return r[n];if("A"===n)return 0}},s=function(e){return 1===(e=e.toString(16)).length&&(e="0"+e),unescape("%"+e)};return{encodeBase64:function(r){var i;e=r,t=0,r="";var a=Array(3),s=0;for(i=!1;!i&&-1!==(a[0]=o());)a[1]=o(),a[2]=o(),r+=n[a[0]>>2],-1!==a[1]?(r+=n[a[0]<<4&48|a[1]>>4],-1!==a[2]?(r+=n[a[1]<<2&60|a[2]>>6],r+=n[63&a[2]]):(r+=n[a[1]<<2&60],r+="=",i=!0)):(r+=n[a[0]<<4&48],r+="=",r+="=",i=!0),76<=(s+=4)&&(r+="\n",s=0);return r},decodeBase64:function(n){var r;e=n,t=0,n="";var i=Array(4);for(r=!1;!r&&-1!==(i[0]=a())&&-1!==(i[1]=a());)i[2]=a(),i[3]=a(),n+=s(i[0]<<2&255|i[1]>>4),-1!==i[2]?(n+=s(i[1]<<4&255|i[2]>>2),-1!==i[3]?n+=s(i[2]<<6&255|i[3]):r=!0):r=!0;return n}}}(),t.a=e},function(e,t,n){(function(t){e.exports=t.adapter=n(50)}).call(t,n(49))},function(e,t){t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,t,r){e.exports=function e(t,n,r){function i(a,s){if(!n[a]){if(!t[a]){if(o)return o(a,!0);throw(s=Error("Cannot find module '"+a+"'")).code="MODULE_NOT_FOUND",s}s=n[a]={exports:{}},t[a][0].call(s.exports,function(e){return i(t[a][1][e]||e)},s,s.exports,e,t,n,r)}return n[a].exports}for(var o=!1,a=0;a<r.length;a++)i(r[a]);return i}({1:[function(e,t,n){e=(0,(e=e("./adapter_factory.js")).adapterFactory)({window:window}),t.exports=e},{"./adapter_factory.js":2}],2:[function(e,t,n){function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function(){var e=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).window,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},n=i.log,r=i.detectBrowser(e),u={browserDetails:r,commonShim:d,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings};switch(r.browser){case"chrome":if(!o||!o.shimPeerConnection||!t.shimChrome){n("Chrome shim is not included in this adapter release.");break}n("adapter.js shimming chrome."),u.browserShim=o,o.shimGetUserMedia(e),o.shimMediaStream(e),o.shimPeerConnection(e),o.shimOnTrack(e),o.shimAddTrackRemoveTrack(e),o.shimGetSendersWithDtmf(e),o.shimGetStats(e),o.shimSenderReceiverGetStats(e),o.fixNegotiationNeeded(e),d.shimRTCIceCandidate(e),d.shimConnectionState(e),d.shimMaxMessageSize(e),d.shimSendThrowTypeError(e),d.removeAllowExtmapMixed(e);break;case"firefox":if(!s||!s.shimPeerConnection||!t.shimFirefox){n("Firefox shim is not included in this adapter release.");break}n("adapter.js shimming firefox."),u.browserShim=s,s.shimGetUserMedia(e),s.shimPeerConnection(e),s.shimOnTrack(e),s.shimRemoveStream(e),s.shimSenderGetStats(e),s.shimReceiverGetStats(e),s.shimRTCDataChannel(e),d.shimRTCIceCandidate(e),d.shimConnectionState(e),d.shimMaxMessageSize(e),d.shimSendThrowTypeError(e);break;case"edge":if(!a||!a.shimPeerConnection||!t.shimEdge){n("MS edge shim is not included in this adapter release.");break}n("adapter.js shimming edge."),u.browserShim=a,a.shimGetUserMedia(e),a.shimGetDisplayMedia(e),a.shimPeerConnection(e),a.shimReplaceTrack(e),d.shimMaxMessageSize(e),d.shimSendThrowTypeError(e);break;case"safari":if(!c||!t.shimSafari){n("Safari shim is not included in this adapter release.");break}n("adapter.js shimming safari."),u.browserShim=c,c.shimRTCIceServerUrls(e),c.shimCreateOfferLegacy(e),c.shimCallbacksAPI(e),c.shimLocalStreamsAPI(e),c.shimRemoteStreamsAPI(e),c.shimTrackEventTransceiver(e),c.shimGetUserMedia(e),d.shimRTCIceCandidate(e),d.shimMaxMessageSize(e),d.shimSendThrowTypeError(e),d.removeAllowExtmapMixed(e);break;default:n("Unsupported browser!")}return u};var i=r(e("./utils")),o=r(e("./chrome/chrome_shim")),a=r(e("./edge/edge_shim")),s=r(e("./firefox/firefox_shim")),c=r(e("./safari/safari_shim")),d=r(e=e("./common_shim"))},{"./chrome/chrome_shim":3,"./common_shim":6,"./edge/edge_shim":7,"./firefox/firefox_shim":11,"./safari/safari_shim":14,"./utils":15}],3:[function(e,t,r){function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(function(t){return e._shimmedLocalStreams[t][0]})};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(r)&&this._shimmedLocalStreams[n.id].push(r):this._shimmedLocalStreams[n.id]=[n,r],r};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(function(e){if(t.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")});var r=this.getSenders();n.apply(this,arguments);var i=this.getSenders().filter(function(e){return-1===r.indexOf(e)});this._shimmedLocalStreams[e.id]=[e].concat(i)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(function(n){var r=t._shimmedLocalStreams[n].indexOf(e);-1!==r&&t._shimmedLocalStreams[n].splice(r,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]}),i.apply(this,arguments)}}Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0,n.initSymbol(),n.initSymbol(),n.initSymbolIterator();var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return n.initSymbol(),n.initSymbol(),n.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return s.shimGetUserMedia}});var c=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return c.shimGetDisplayMedia}}),r.shimMediaStream=function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},r.shimOnTrack=function(e){if("object"!==(void 0===e?"undefined":a(e))||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)d.wrapPeerConnectionEvent(e,"track",function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e});else{Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",function(r){var i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(e){return e.track&&e.track.id===r.track.id}):{track:r.track},o=new Event("track");o.track=r.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)}),t.stream.getTracks().forEach(function(r){var i=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find(function(e){return e.track&&e.track.id===r.id}):{track:r},o=new Event("track");o.track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}},r.shimGetSendersWithDtmf=function(e){if("object"===(void 0===e?"undefined":a(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&(this._dtmf="audio"===t.kind?e.createDTMFSender(t):null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){r.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach(function(e){n._senders.push(t(n,e))})};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._senders=this._senders||[],o.apply(this,[e]),e.getTracks().forEach(function(e){var n=t._senders.find(function(t){return t.track===e});n&&t._senders.splice(t._senders.indexOf(n),1)})}}else if("object"===(void 0===e?"undefined":a(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var s=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=s.apply(this,[]);return t.forEach(function(t){return t._pc=e}),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&(this._dtmf="audio"===this.track.kind?this._pc.createDTMFSender(this.track):null),this._dtmf}})}},r.shimGetStats=function(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,n=(i=Array.prototype.slice.call(arguments))[0],r=i[1],i=i[2];if(0<arguments.length&&"function"==typeof n)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof n))return t.apply(this,[]);var o=function(e){var t={};return e.result().forEach(function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach(function(t){n[t]=e.stat(t)}),t[n.id]=n}),t},a=function(e){return new Map(Object.keys(e).map(function(t){return[t,e[t]]}))};return 2<=arguments.length?t.apply(this,[function(e){r(a(o(e)))},n]):new Promise(function(n,r){t.apply(e,[function(e){n(a(o(e)))},r])}).then(r,i)}}},r.shimSenderReceiverGetStats=function(e){if("object"===(void 0===e?"undefined":a(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach(function(t){return t._pc=e}),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return d.filterStats(t,e.track,!0)})}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=r.apply(this,[]);return t.forEach(function(t){return t._pc=e}),t}),d.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then(function(t){return d.filterStats(t,e.track,!1)})}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],n=void 0,r=void 0,o=void 0;return this.getSenders().forEach(function(e){e.track===t&&(n?o=!0:n=e)}),this.getReceivers().forEach(function(e){return e.track===t&&(r?o=!0:r=e),e.track===t}),o||n&&r?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():r?r.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}},r.shimAddTrackRemoveTrackWithNative=o,r.shimAddTrackRemoveTrack=function(e){function t(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(function(t){t=e._reverseStreams[t],n=n.replace(new RegExp(e._streams[t.id].id,"g"),t.id)}),new RTCSessionDescription({type:t.type,sdp:n})}if(e.RTCPeerConnection){var n=d.detectBrowser(e);if(e.RTCPeerConnection.prototype.addTrack&&65<=n.version)return o(e);var r=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=r.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map(function(t){return e._reverseStreams[t.id]})};var a=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(function(e){if(n.getSenders().find(function(t){return t.track===e}))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){var r=new e.MediaStream(t.getTracks());this._streams[t.id]=r,this._reverseStreams[r.id]=t,t=r}a.apply(this,[t])};var s=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(function(e){return e===t}))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(function(e){return e.track===t}))throw new DOMException("Track already exists.","InvalidAccessError");return this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},(i=this._streams[n.id])?(i.addTrack(t),Promise.resolve().then(function(){r.dispatchEvent(new Event("negotiationneeded"))})):(i=new e.MediaStream([t]),this._streams[n.id]=i,this._reverseStreams[i.id]=n,this.addStream(i)),this.getSenders().find(function(e){return e.track===t})},["createOffer","createAnswer"].forEach(function(n){var r=e.RTCPeerConnection.prototype[n],o=i({},n,function(){var e=this,n=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[function(r){r=t(e,r),n[0].apply(null,[r])},function(e){n[1]&&n[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then(function(n){return t(e,n)})});e.RTCPeerConnection.prototype[n]=o[n]});var c=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=(e=this,t=arguments[0],n=t.sdp,Object.keys(e._reverseStreams||[]).forEach(function(t){t=e._reverseStreams[t],n=n.replace(new RegExp(t.id,"g"),e._streams[t.id].id)}),new RTCSessionDescription({type:t.type,sdp:n})),c.apply(this,arguments)):c.apply(this,arguments);var e,t,n};var u=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=u.get.apply(this);return""===e.type?e:t(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var n=void 0;Object.keys(this._streams).forEach(function(r){t._streams[r].getTracks().find(function(t){return e.track===t})&&(n=t._streams[r])}),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}},r.shimPeerConnection=function(e){var t=d.detectBrowser(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){53>t.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t],r=i({},t,function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)});e.RTCPeerConnection.prototype[t]=r[t]});var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?78>t.version&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}}},r.fixNegotiationNeeded=function(e){d.wrapPeerConnectionEvent(e,"negotiationneeded",function(e){if("stable"===e.target.signalingState)return e})};var d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils.js"))},{"../utils.js":15,"./getdisplaymedia":4,"./getusermedia":5}],4:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||!e.navigator.mediaDevices||("function"!=typeof t?console.error("shimGetDisplayMedia: getSourceId argument is not a function"):e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then(function(t){var r=n.video&&n.video.width,i=n.video&&n.video.height;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:n.video&&n.video.frameRate||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)})})}},{}],5:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),n.initSymbol(),n.initSymbol(),n.initSymbolIterator();var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return n.initSymbol(),n.initSymbol(),n.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices){var n=o.detectBrowser(e),r=function(e){if("object"!==(void 0===e?"undefined":i(e))||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach(function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var r="object"===i(e[n])?e[n]:{ideal:e[n]};void 0!==r.exact&&"number"==typeof r.exact&&(r.min=r.max=r.exact);var o=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==r.ideal){t.optional=t.optional||[];var a={};"number"==typeof r.ideal?(a[o("min",n)]=r.ideal,t.optional.push(a),(a={})[o("max",n)]=r.ideal):a[o("",n)]=r.ideal,t.optional.push(a)}void 0!==r.exact&&"number"!=typeof r.exact?(t.mandatory=t.mandatory||{},t.mandatory[o("",n)]=r.exact):["min","max"].forEach(function(e){void 0!==r[e]&&(t.mandatory=t.mandatory||{},t.mandatory[o(e,n)]=r[e])})}}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},s=function(e,o){if(61<=n.version)return o(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===i(e.audio)&&((c=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])})((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),c(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)),e&&"object"===i(e.video)){var s=(s=e.video.facingMode)&&("object"===(void 0===s?"undefined":i(s))?s:{ideal:s}),c=66>n.version;if(!(!s||"user"!==s.exact&&"environment"!==s.exact&&"user"!==s.ideal&&"environment"!==s.ideal||t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!c)){delete e.video.facingMode;var d=void 0;if("environment"===s.exact||"environment"===s.ideal?d=["back","rear"]:"user"!==s.exact&&"user"!==s.ideal||(d=["front"]),d)return t.mediaDevices.enumerateDevices().then(function(t){var n=(t=t.filter(function(e){return"videoinput"===e.kind})).find(function(e){return d.some(function(t){return e.label.toLowerCase().includes(t)})});return!n&&t.length&&d.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=s.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=r(e.video),a("chrome: "+JSON.stringify(e)),o(e)})}e.video=r(e.video)}return a("chrome: "+JSON.stringify(e)),o(e)},c=function(e){return 64<=n.version?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(t.getUserMedia=function(e,n,r){s(e,function(e){t.webkitGetUserMedia(e,n,function(e){r&&r(c(e))})})}.bind(t),t.mediaDevices.getUserMedia){var d=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return s(e,function(e){return d(e).then(function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach(function(e){e.stop()}),new DOMException("","NotFoundError");return t},function(e){return Promise.reject(c(e))})})}}}};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils.js")),a=o.log},{"../utils.js":15}],6:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),n.initSymbol(),n.initSymbol(),n.initSymbolIterator();var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return n.initSymbol(),n.initSymbol(),n.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimRTCIceCandidate=function(e){if(e.RTCIceCandidate&&!(e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e);e=o.default.parseCandidate(e.candidate);var r=Object.assign(n,e);return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,a.wrapPeerConnectionEvent(e,"icecandidate",function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t})}},r.shimMaxMessageSize=function(e){if(e.RTCPeerConnection){var t=a.detectBrowser(e);"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=function(e){return!(!e||!e.sdp)&&((e=o.default.splitSections(e.sdp)).shift(),e.some(function(e){return(e=o.default.parseMLine(e))&&"application"===e.kind&&-1!==e.protocol.indexOf("SCTP")}))},r=function(e,n){var r=65536;return"firefox"===t.browser&&57===t.version&&(r=65535),0<(e=o.default.matchPrefix(e.sdp,"a=max-message-size:")).length?r=parseInt(e[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r},i=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&76<=t.version&&"plan-b"===this.getConfiguration().sdpSemantics&&Object.defineProperty(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0}),n(arguments[0])){var e=function(e){var n=65536;return"firefox"===t.browser&&(n=57>t.version?-1===e?16384:2147483637:60>t.version?57===t.version?65535:65536:2147483637),n}(o=function(e){return null===(e=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/))||2>e.length?-1:(e=parseInt(e[1],10))!=e?-1:e}(arguments[0])),o=r(arguments[0],o),a=0===e&&0===o?Number.POSITIVE_INFINITY:0===e||0===o?Math.max(e,o):Math.min(e,o);e={},Object.defineProperty(e,"maxMessageSize",{get:function(){return a}}),this._sctp=e}return i.apply(this,arguments)}}},r.shimSendThrowTypeError=function(e){function t(e,t){var n=e.send;e.send=function(){var r=(r=arguments[0]).length||r.size||r.byteLength;if("open"===e.readyState&&t.sctp&&r>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=n.apply(this,arguments);return t(e,this),e},a.wrapPeerConnectionEvent(e,"datachannel",function(e){return t(e.channel,e.target),e})}},r.shimConnectionState=function(e){if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}},r.removeAllowExtmapMixed=function(e){if(e.RTCPeerConnection){var t=a.detectBrowser(e);if(!("chrome"===t.browser&&71<=t.version)){var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){return e&&e.sdp&&-1!==e.sdp.indexOf("\na=extmap-allow-mixed")&&(e.sdp=e.sdp.split("\n").filter(function(e){return"a=extmap-allow-mixed"!==e.trim()}).join("\n")),n.apply(this,arguments)}}}};var o=(t=e("sdp"))&&t.__esModule?t:{default:t},a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./utils"))},{"./utils":15,sdp:17}],7:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var r=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function(){return r.shimGetUserMedia}});var i=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function(){return i.shimGetDisplayMedia}}),n.shimPeerConnection=function(e){var t=o.detectBrowser(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),15025>t.version)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var r=(0,s.default)(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=(0,a.filterIceServers)(e.iceServers,t.version),o.log("ICE servers after filtering:",e.iceServers)),new r(e)},e.RTCPeerConnection.prototype=r.prototype},n.shimReplaceTrack=function(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils")),a=e("./filtericeservers"),s=(e=e("rtcpeerconnection-shim"))&&e.__esModule?e:{default:e}},{"../utils":15,"./filtericeservers":8,"./getdisplaymedia":9,"./getusermedia":10,"rtcpeerconnection-shim":16}],8:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&r.deprecated("RTCIceServer.url","RTCIceServer.urls");var i="string"==typeof t;return i&&(t=[t]),t=t.filter(function(e){return 0!==e.indexOf("stun:")&&((e=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp"))&&!n?n=!0:e&&!n)}),delete e.url,e.urls=i?t[0]:t,!!t.length}})};var r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":15}],9:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e){"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&!(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)&&(e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator))}},{}],10:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function(e){var t=(e=e&&e.navigator).mediaDevices.getUserMedia.bind(e.mediaDevices);e.mediaDevices.getUserMedia=function(e){return t(e).catch(function(e){return Promise.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))})}}},{}],11:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.shimGetDisplayMedia=r.shimGetUserMedia=void 0,n.initSymbol(),n.initSymbol(),n.initSymbolIterator();var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return n.initSymbol(),n.initSymbol(),n.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=e("./getusermedia");Object.defineProperty(r,"shimGetUserMedia",{enumerable:!0,get:function(){return o.shimGetUserMedia}});var a=e("./getdisplaymedia");Object.defineProperty(r,"shimGetDisplayMedia",{enumerable:!0,get:function(){return a.shimGetDisplayMedia}}),r.shimOnTrack=function(e){"object"===(void 0===e?"undefined":i(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimPeerConnection=function(e){var t=s.detectBrowser(e);if("object"===(void 0===e?"undefined":i(e))&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),53>t.version&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){var n=e.RTCPeerConnection.prototype[t],r=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},t,function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)});e.RTCPeerConnection.prototype[t]=r[t]});var n=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?68>t.version&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())};var r={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),n=e[1],i=e[2];return o.apply(this,[e[0]||null]).then(function(e){if(53>t.version&&!n)try{e.forEach(function(e){e.type=r[e.type]||e.type})}catch(t){if("TypeError"!==t.name)throw t;e.forEach(function(t,n){e.set(n,Object.assign({},t,{type:r[t.type]||t.type}))})}return e}).then(n,i)}}},r.shimSenderGetStats=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return n.forEach(function(t){return t._pc=e}),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}},r.shimReceiverGetStats=function(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&!(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return n.forEach(function(t){return t._pc=e}),n}),s.wrapPeerConnectionEvent(e,"track",function(e){return e.receiver._pc=e.srcElement,e}),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}},r.shimRemoveStream=function(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;s.deprecated("removeStream","removeTrack"),this.getSenders().forEach(function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)})})},r.shimRTCDataChannel=function(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)};var s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":15,"./getdisplaymedia":12,"./getusermedia":13}],12:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||!e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=function(n){return n&&n.video?(!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)):((n=new DOMException("getDisplayMedia without video constraints is undefined")).name="NotFoundError",n.code=8,Promise.reject(n))})}},{}],13:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),n.initSymbol(),n.initSymbol(),n.initSymbolIterator();var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return n.initSymbol(),n.initSymbol(),n.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimGetUserMedia=function(e){var t=o.detectBrowser(e),n=e&&e.navigator;if(e=e&&e.MediaStreamTrack,n.getUserMedia=function(e,t,r){o.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(55<t.version&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var r=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":i(e))&&"object"===i(e.audio)&&(e=JSON.parse(JSON.stringify(e)),r(e.audio,"autoGainControl","mozAutoGainControl"),r(e.audio,"noiseSuppression","mozNoiseSuppression")),a(e)},e&&e.prototype.getSettings){var s=e.prototype.getSettings;e.prototype.getSettings=function(){var e=s.apply(this,arguments);return r(e,"mozAutoGainControl","autoGainControl"),r(e,"mozNoiseSuppression","noiseSuppression"),e}}if(e&&e.prototype.applyConstraints){var c=e.prototype.applyConstraints;e.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":i(e))&&(e=JSON.parse(JSON.stringify(e)),r(e,"autoGainControl","mozAutoGainControl"),r(e,"noiseSuppression","mozNoiseSuppression")),c.apply(this,[e])}}}};var o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":15}],14:[function(e,t,r){function i(e){return e&&void 0!==e.video?Object.assign({},e,{video:a.compactObject(e.video)}):e}Object.defineProperty(r,"__esModule",{value:!0}),n.initSymbol(),n.initSymbol(),n.initSymbolIterator();var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return n.initSymbol(),n.initSymbol(),n.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.shimLocalStreamsAPI=function(e){if("object"===(void 0===e?"undefined":o(e))&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach(function(r){return t.call(n,r,e)}),e.getVideoTracks().forEach(function(r){return t.call(n,r,e)})},e.RTCPeerConnection.prototype.addTrack=function(e){var n=arguments[1];return n&&(this._localStreams?this._localStreams.includes(n)||this._localStreams.push(n):this._localStreams=[n]),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var r=e.getTracks();this.getSenders().forEach(function(e){r.includes(e.track)&&t.removeTrack(e)})}})}},r.shimRemoteStreamsAPI=function(e){if("object"===(void 0===e?"undefined":o(e))&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}})})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(0<=e._remoteStreams.indexOf(t))){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}})}),t.apply(e,arguments)}}},r.shimCallbacksAPI=function(e){if("object"===(void 0===e?"undefined":o(e))&&e.RTCPeerConnection){var t=(e=e.RTCPeerConnection.prototype).createOffer,n=e.createAnswer,r=e.setLocalDescription,i=e.setRemoteDescription,a=e.addIceCandidate;e.createOffer=function(e,n){var r=t.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);return n?(r.then(e,n),Promise.resolve()):r},e.createAnswer=function(e,t){var r=n.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);return t?(r.then(e,t),Promise.resolve()):r};var s=function(e,t,n){return e=r.apply(this,[e]),n?(e.then(t,n),Promise.resolve()):e};e.setLocalDescription=s,s=function(e,t,n){return e=i.apply(this,[e]),n?(e.then(t,n),Promise.resolve()):e},e.setRemoteDescription=s,s=function(e,t,n){return e=a.apply(this,[e]),n?(e.then(t,n),Promise.resolve()):e},e.addIceCandidate=s}},r.shimGetUserMedia=function(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=(e=t.mediaDevices).getUserMedia.bind(e);t.mediaDevices.getUserMedia=function(e){return n(i(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,r){t.mediaDevices.getUserMedia(e).then(n,r)}.bind(t))},r.shimConstraints=i,r.shimRTCIceServerUrls=function(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var r=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(a.deprecated("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(JSON.stringify(o))).urls=o.url,delete o.url,r.push(o)):r.push(e.iceServers[i])}e.iceServers=r}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})},r.shimTrackEventTransceiver=function(e){"object"===(void 0===e?"undefined":o(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})},r.shimCreateOfferLegacy=function(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find(function(e){return"audio"===e.receiver.track.kind});!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo),n=this.getTransceivers().find(function(e){return"video"===e.receiver.track.kind}),!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":15}],15:[function(e,t,r){function i(e,t,n){return(e=e.match(t))&&e.length>=n&&parseInt(e[n],10)}function o(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach(function(r){r.endsWith("Id")?o(e,e.get(t[r]),n):r.endsWith("Ids")&&t[r].forEach(function(t){o(e,e.get(t),n)})}))}Object.defineProperty(r,"__esModule",{value:!0}),n.initSymbol(),n.initSymbol(),n.initSymbolIterator();var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return n.initSymbol(),n.initSymbol(),n.initSymbol(),e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.extractVersion=i,r.wrapPeerConnectionEvent=function(e,t,n){if(e.RTCPeerConnection){var r=(e=e.RTCPeerConnection.prototype).addEventListener;e.addEventListener=function(e,i){if(e!==t)return r.apply(this,arguments);var o=function(e){(e=n(e))&&i(e)};return this._eventMap=this._eventMap||{},this._eventMap[i]=o,r.apply(this,[e,o])};var i=e.removeEventListener;e.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return i.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],i.apply(this,[e,r])},Object.defineProperty(e,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}},r.disableLog=function(e){return"boolean"!=typeof e?Error("Argument type: "+(void 0===e?"undefined":a(e))+". Please use a boolean."):(s=e)?"adapter.js logging disabled":"adapter.js logging enabled"},r.disableWarnings=function(e){return"boolean"!=typeof e?Error("Argument type: "+(void 0===e?"undefined":a(e))+". Please use a boolean."):(c=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))},r.log=function(){"object"!==("undefined"==typeof window?"undefined":a(window))||s||"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)},r.deprecated=function(e,t){c&&console.warn(e+" is deprecated, please use "+t+" instead.")},r.detectBrowser=function(e){var t=e.navigator,n={browser:null,version:null};return void 0!==e&&e.navigator?(t.mozGetUserMedia?(n.browser="firefox",n.version=i(t.userAgent,/Firefox\/(\d+)\./,1)):t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer?(n.browser="chrome",n.version=i(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2)):t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/)?(n.browser="edge",n.version=i(t.userAgent,/Edge\/(\d+).(\d+)$/,2)):e.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./)?(n.browser="safari",n.version=i(t.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype):n.browser="Not a supported browser.",n):(n.browser="Not a browser.",n)},r.compactObject=function e(t){return"[object Object]"!==Object.prototype.toString.call(t)?t:Object.keys(t).reduce(function(n,r){var i=(o="[object Object]"===Object.prototype.toString.call(t[r]))?e(t[r]):t[r],o=o&&!Object.keys(i).length;return void 0===i||o?n:Object.assign(n,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},r,i))},{})},r.walkStats=o,r.filterStats=function(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",i=new Map;if(null===t)return i;var a=[];return e.forEach(function(e){"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)}),a.forEach(function(t){e.forEach(function(n){n.type===r&&n.trackId===t.id&&o(e,n,i)})}),i};var s=!0,c=!0},{}],16:[function(e,t,n){function r(e,t,n,r,i){return t=c.writeRtpDescription(e.kind,t),t+=c.writeIceParameters(e.iceGatherer.getLocalParameters()),t+=c.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":i||"active"),t+="a=mid:"+e.mid+"\r\n",t=e.rtpSender&&e.rtpReceiver?t+"a=sendrecv\r\n":e.rtpSender?t+"a=sendonly\r\n":e.rtpReceiver?t+"a=recvonly\r\n":t+"a=inactive\r\n",e.rtpSender&&(n=e.rtpSender._initialTrackId||e.rtpSender.track.id,e.rtpSender._initialTrackId=n,t=t+"a="+(r="msid:"+(r?r.id:"-")+" "+n+"\r\n")+"a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+r,e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+r,t+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")),t+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+c.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+c.localCName+"\r\n"),t}function i(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){return e=r(e.parameters.apt,n),t=r(t.parameters.apt,i),e&&t&&e.name.toLowerCase()===t.name.toLowerCase()};return e.codecs.forEach(function(r){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate&&("rtx"!==r.name.toLowerCase()||!r.parameters||!a.parameters.apt||i(r,a,e.codecs,t.codecs))){(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter(function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1});break}}}),e.headerExtensions.forEach(function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}}),n}function o(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function a(e,t){var n=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});return n||e.addRemoteCandidate(t),!n}function s(e,t){return(t=Error(t)).name=e,t.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],t}var c=e("sdp");t.exports=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function d(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout(function(){t._dispatchEvent("track",o)})}var u=function(n){var r=this,i=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){r[e]=i[e].bind(i)}),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._remoteDescription=this._localDescription=null,this.signalingState="stable",this.iceGatheringState=this.connectionState=this.iceConnectionState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw s("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter(function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter(function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&14393<=t&&-1===e.indexOf("?transport=udp"):n=!0}),delete e.url,e.urls=i?r[0]:r,!!r.length}})}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var o=n.iceCandidatePoolSize;0<o;o--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=c.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(u.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(u.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),u.prototype.onicecandidate=null,u.prototype.onaddstream=null,u.prototype.ontrack=null,u.prototype.onremovestream=null,u.prototype.onsignalingstatechange=null,u.prototype.oniceconnectionstatechange=null,u.prototype.onconnectionstatechange=null,u.prototype.onicegatheringstatechange=null,u.prototype.onnegotiationneeded=null,u.prototype.ondatachannel=null,u.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"!=typeof this["on"+e])||this["on"+e](t)},u.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},u.prototype.getConfiguration=function(){return this._config},u.prototype.getLocalStreams=function(){return this.localStreams},u.prototype.getRemoteStreams=function(){return this.remoteStreams},u.prototype._createTransceiver=function(e,t){var n=0<this.transceivers.length;return e={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0},this.usingBundle&&n?(e.iceTransport=this.transceivers[0].iceTransport,e.dtlsTransport=this.transceivers[0].dtlsTransport):(n=this._createIceAndDtlsTransports(),e.iceTransport=n.iceTransport,e.dtlsTransport=n.dtlsTransport),t||this.transceivers.push(e),e},u.prototype.addTrack=function(t,n){if(this._isClosed)throw s("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");if(this.transceivers.find(function(e){return e.track===t}))throw s("InvalidAccessError","Track already exists.");for(var r,i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},u.prototype.addStream=function(e){var n=this;if(15025<=t)e.getTracks().forEach(function(t){n.addTrack(t,e)});else{var r=e.clone();e.getTracks().forEach(function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",function(e){n.enabled=e.enabled})}),r.getTracks().forEach(function(e){n.addTrack(e,r)})}},u.prototype.removeTrack=function(t){if(this._isClosed)throw s("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find(function(e){return e.rtpSender===t});if(!n)throw s("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map(function(e){return e.stream}).indexOf(r)&&-1<this.localStreams.indexOf(r)&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},u.prototype.removeStream=function(e){var t=this;e.getTracks().forEach(function(e){var n=t.getSenders().find(function(t){return t.track===e});n&&t.removeTrack(n)})},u.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})},u.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})},u.prototype._createIceGatherer=function(t,n){var r=this;if(n&&0<t)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},u.prototype._gather=function(t,n){var r=this,i=this.transceivers[n].iceGatherer;if(!i.onlocalcandidate){var o=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,i.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),i.onlocalcandidate=function(e){if(!(r.usingBundle&&0<n)){var o=new Event("icecandidate");o.candidate={sdpMid:t,sdpMLineIndex:n};var a=e.candidate;(e=!a||0===Object.keys(a).length)?"new"!==i.state&&"gathering"!==i.state||(i.state="completed"):("new"===i.state&&(i.state="gathering"),a.component=1,a.ufrag=i.getLocalParameters().usernameFragment,a=c.writeCandidate(a),o.candidate=Object.assign(o.candidate,c.parseCandidate(a)),o.candidate.candidate=a,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}),(a=c.getMediaSections(r._localDescription.sdp))[o.candidate.sdpMLineIndex]=e?a[o.candidate.sdpMLineIndex]+"a=end-of-candidates\r\n":a[o.candidate.sdpMLineIndex]+"a="+o.candidate.candidate+"\r\n",r._localDescription.sdp=c.getDescription(r._localDescription.sdp)+a.join(""),a=r.transceivers.every(function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}),"gathering"!==r.iceGatheringState&&(r.iceGatheringState="gathering",r._emitGatheringStateChange()),e||r._dispatchEvent("icecandidate",o),a&&(r._dispatchEvent("icecandidate",new Event("icecandidate")),r.iceGatheringState="complete",r._emitGatheringStateChange())}},e.setTimeout(function(){o.forEach(function(e){i.onlocalcandidate(e)})},0)}},u.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},u.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer),(t=this.transceivers[e].iceTransport)&&(delete t.onicestatechange,delete this.transceivers[e].iceTransport),(t=this.transceivers[e].dtlsTransport)&&(delete t.ondtlsstatechange,delete t.onerror,delete this.transceivers[e].dtlsTransport)},u.prototype._transceive=function(e,n,r){var o=i(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(o.encodings=e.sendEncodingParameters,o.rtcp={cname:c.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(o.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(o)),r&&e.rtpReceiver&&0<o.codecs.length&&("video"===e.kind&&e.recvEncodingParameters&&15019>t&&e.recvEncodingParameters.forEach(function(e){delete e.rtx}),o.encodings=e.recvEncodingParameters.length?e.recvEncodingParameters:[{}],o.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(o.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(o.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(o))},u.prototype.setLocalDescription=function(e){var t=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(s("TypeError",'Unsupported type "'+e.type+'"'));if(!o("setLocalDescription",e.type,t.signalingState)||t._isClosed)return Promise.reject(s("InvalidStateError","Can not set local "+e.type+" in state "+t.signalingState));if("offer"===e.type){var n=c.splitSections(e.sdp),r=n.shift();n.forEach(function(e,n){e=c.parseRtpParameters(e),t.transceivers[n].localCapabilities=e}),t.transceivers.forEach(function(e,n){t._gather(e.mid,n)})}else if("answer"===e.type){n=c.splitSections(t._remoteDescription.sdp),r=n.shift();var a=0<c.matchPrefix(r,"a=ice-lite").length;n.forEach(function(e,n){var o=t.transceivers[n],s=o.iceGatherer,d=o.iceTransport,u=o.dtlsTransport,l=o.localCapabilities,p=o.remoteCapabilities;if(!(c.isRejected(e)&&0===c.matchPrefix(e,"a=bundle-only").length||o.rejected)){var f=c.getIceParameters(e,r);e=c.getDtlsParameters(e,r),a&&(e.role="server"),t.usingBundle&&0!==n||(t._gather(o.mid,n),"new"===d.state&&d.start(s,f,a?"controlling":"controlled"),"new"===u.state&&u.start(e)),n=i(l,p),t._transceive(o,0<n.codecs.length,!1)}})}return t._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?t._updateSignalingState("have-local-offer"):t._updateSignalingState("stable"),Promise.resolve()},u.prototype.setRemoteDescription=function(r){var u=this;if(-1===["offer","answer"].indexOf(r.type))return Promise.reject(s("TypeError",'Unsupported type "'+r.type+'"'));if(!o("setRemoteDescription",r.type,u.signalingState)||u._isClosed)return Promise.reject(s("InvalidStateError","Can not set remote "+r.type+" in state "+u.signalingState));var l={};u.remoteStreams.forEach(function(e){l[e.id]=e});var p=[],f=c.splitSections(r.sdp),h=f.shift(),m=0<c.matchPrefix(h,"a=ice-lite").length,y=0<c.matchPrefix(h,"a=group:BUNDLE ").length;u.usingBundle=y;var g=c.matchPrefix(h,"a=ice-options:")[0];return u.canTrickleIceCandidates=!!g&&0<=g.substr(14).split(" ").indexOf("trickle"),f.forEach(function(o,s){var d=c.splitLines(o),f=c.getKind(o),g=c.isRejected(o)&&0===c.matchPrefix(o,"a=bundle-only").length,v=d[0].substr(2).split(" ")[2],E=(d=c.getDirection(o,h),c.parseMsid(o)),S=c.getMid(o)||c.generateIdentifier();if(g||"application"===f&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))u.transceivers[s]={mid:S,kind:f,protocol:v,rejected:!0};else{!g&&u.transceivers[s]&&u.transceivers[s].rejected&&(u.transceivers[s]=u._createTransceiver(f,!0));var _=c.parseRtpParameters(o);if(!g){var T=c.getIceParameters(o,h),b=c.getDtlsParameters(o,h);b.role="client"}v=c.parseRtpEncodingParameters(o);var C=c.parseRtcpParameters(o),R=0<c.matchPrefix(o,"a=end-of-candidates",h).length,I=c.matchPrefix(o,"a=candidate:").map(function(e){return c.parseCandidate(e)}).filter(function(e){return 1===e.component});if(("offer"===r.type||"answer"===r.type)&&!g&&y&&0<s&&u.transceivers[s]&&(u._disposeIceAndDtlsTransports(s),u.transceivers[s].iceGatherer=u.transceivers[0].iceGatherer,u.transceivers[s].iceTransport=u.transceivers[0].iceTransport,u.transceivers[s].dtlsTransport=u.transceivers[0].dtlsTransport,u.transceivers[s].rtpSender&&u.transceivers[s].rtpSender.setTransport(u.transceivers[0].dtlsTransport),u.transceivers[s].rtpReceiver&&u.transceivers[s].rtpReceiver.setTransport(u.transceivers[0].dtlsTransport)),"offer"!==r.type||g)"answer"!==r.type||g||(P=(A=u.transceivers[s]).iceGatherer,f=A.iceTransport,S=A.dtlsTransport,O=A.rtpReceiver,g=A.sendEncodingParameters,o=A.localCapabilities,u.transceivers[s].recvEncodingParameters=v,u.transceivers[s].remoteCapabilities=_,u.transceivers[s].rtcpParameters=C,I.length&&"new"===f.state&&(!m&&!R||y&&0!==s?I.forEach(function(e){a(A.iceTransport,e)}):f.setRemoteCandidates(I)),y&&0!==s||("new"===f.state&&f.start(P,T,"controlling"),"new"===S.state&&S.start(b)),!i(A.localCapabilities,A.remoteCapabilities).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&A.sendEncodingParameters[0].rtx&&delete A.sendEncodingParameters[0].rtx,u._transceive(A,"sendrecv"===d||"recvonly"===d,"sendrecv"===d||"sendonly"===d),!O||"sendrecv"!==d&&"sendonly"!==d?delete A.rtpReceiver:(d=O.track,E?(l[E.stream]||(l[E.stream]=new e.MediaStream),n(d,l[E.stream]),p.push([d,O,l[E.stream]])):(l.default||(l.default=new e.MediaStream),n(d,l.default),p.push([d,O,l.default]))));else{var A=u.transceivers[s]||u._createTransceiver(f);if(A.mid=S,A.iceGatherer||(A.iceGatherer=u._createIceGatherer(s,y)),I.length&&"new"===A.iceTransport.state&&(!R||y&&0!==s?I.forEach(function(e){a(A.iceTransport,e)}):A.iceTransport.setRemoteCandidates(I)),o=e.RTCRtpReceiver.getCapabilities(f),15019>t&&(o.codecs=o.codecs.filter(function(e){return"rtx"!==e.name})),g=A.sendEncodingParameters||[{ssrc:1001*(2*s+2)}],T=!1,"sendrecv"===d||"sendonly"===d){T=!A.rtpReceiver;var O=A.rtpReceiver||new e.RTCRtpReceiver(A.dtlsTransport,f);if(T){if(d=O.track,!E||"-"!==E.stream)if(E){l[E.stream]||(l[E.stream]=new e.MediaStream,Object.defineProperty(l[E.stream],"id",{get:function(){return E.stream}})),Object.defineProperty(d,"id",{get:function(){return E.track}});var P=l[E.stream]}else l.default||(l.default=new e.MediaStream),P=l.default;P&&(n(d,P),A.associatedRemoteMediaStreams.push(P)),p.push([d,O,P])}}else A.rtpReceiver&&A.rtpReceiver.track&&(A.associatedRemoteMediaStreams.forEach(function(t){var n=t.getTracks().find(function(e){return e.id===A.rtpReceiver.track.id});n&&function(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(n,t)}),A.associatedRemoteMediaStreams=[]);A.localCapabilities=o,A.remoteCapabilities=_,A.rtpReceiver=O,A.rtcpParameters=C,A.sendEncodingParameters=g,A.recvEncodingParameters=v,u._transceive(u.transceivers[s],!1,T)}}}),void 0===u._dtlsRole&&(u._dtlsRole="offer"===r.type?"active":"passive"),u._remoteDescription={type:r.type,sdp:r.sdp},"offer"===r.type?u._updateSignalingState("have-remote-offer"):u._updateSignalingState("stable"),Object.keys(l).forEach(function(t){var n=l[t];if(n.getTracks().length){if(-1===u.remoteStreams.indexOf(n)){u.remoteStreams.push(n);var r=new Event("addstream");r.stream=n,e.setTimeout(function(){u._dispatchEvent("addstream",r)})}p.forEach(function(e){n.id===e[2].id&&d(u,e[0],e[1],[n])})}}),p.forEach(function(e){e[2]||d(u,e[0],e[1],[])}),e.setTimeout(function(){u&&u.transceivers&&u.transceivers.forEach(function(e){e.iceTransport&&"new"===e.iceTransport.state&&0<e.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))})},4e3),Promise.resolve()},u.prototype.close=function(){this.transceivers.forEach(function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()}),this._isClosed=!0,this._updateSignalingState("closed")},u.prototype._updateSignalingState=function(e){this.signalingState=e,e=new Event("signalingstatechange"),this._dispatchEvent("signalingstatechange",e)},u.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0))},u.prototype._updateIceConnectionState=function(){var e={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(t){t.iceTransport&&!t.rejected&&e[t.iceTransport.state]++});var t="new";0<e.failed?t="failed":0<e.checking?t="checking":0<e.disconnected?t="disconnected":0<e.new?t="new":0<e.connected?t="connected":0<e.completed&&(t="completed"),t!==this.iceConnectionState&&(this.iceConnectionState=t,t=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",t))},u.prototype._updateConnectionState=function(){var e={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(t){t.iceTransport&&t.dtlsTransport&&!t.rejected&&(e[t.iceTransport.state]++,e[t.dtlsTransport.state]++)}),e.connected+=e.completed;var t="new";0<e.failed?t="failed":0<e.connecting?t="connecting":0<e.disconnected?t="disconnected":0<e.new?t="new":0<e.connected&&(t="connected"),t!==this.connectionState&&(this.connectionState=t,t=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",t))},u.prototype.createOffer=function(n){var i=this;if(i._isClosed)return Promise.reject(s("InvalidStateError","Can not call createOffer after close"));var o=i.transceivers.filter(function(e){return"audio"===e.kind}).length,a=i.transceivers.filter(function(e){return"video"===e.kind}).length;if(n){if(n.mandatory||n.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==n.offerToReceiveAudio&&(o=!0===n.offerToReceiveAudio?1:!1===n.offerToReceiveAudio?0:n.offerToReceiveAudio),void 0!==n.offerToReceiveVideo&&(a=!0===n.offerToReceiveVideo?1:!1===n.offerToReceiveVideo?0:n.offerToReceiveVideo)}for(i.transceivers.forEach(function(e){"audio"===e.kind?0>--o&&(e.wantReceive=!1):"video"===e.kind&&0>--a&&(e.wantReceive=!1)});0<o||0<a;)0<o&&(i._createTransceiver("audio"),o--),0<a&&(i._createTransceiver("video"),a--);var d=c.writeSessionBoilerplate(i._sdpSessionId,i._sdpSessionVersion++);return i.transceivers.forEach(function(n,r){var o=n.track,a=n.kind,s=n.mid||c.generateIdentifier();n.mid=s,n.iceGatherer||(n.iceGatherer=i._createIceGatherer(r,i.usingBundle)),s=e.RTCRtpSender.getCapabilities(a),15019>t&&(s.codecs=s.codecs.filter(function(e){return"rtx"!==e.name})),s.codecs.forEach(function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),n.remoteCapabilities&&n.remoteCapabilities.codecs&&n.remoteCapabilities.codecs.forEach(function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)})}),s.headerExtensions.forEach(function(e){(n.remoteCapabilities&&n.remoteCapabilities.headerExtensions||[]).forEach(function(t){e.uri===t.uri&&(e.id=t.id)})}),r=n.sendEncodingParameters||[{ssrc:1001*(2*r+1)}],o&&15019<=t&&"video"===a&&!r[0].rtx&&(r[0].rtx={ssrc:r[0].ssrc+1}),n.wantReceive&&(n.rtpReceiver=new e.RTCRtpReceiver(n.dtlsTransport,a)),n.localCapabilities=s,n.sendEncodingParameters=r}),"max-compat"!==i._config.bundlePolicy&&(d+="a=group:BUNDLE "+i.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),d+="a=ice-options:trickle\r\n",i.transceivers.forEach(function(e,t){d+=r(e,e.localCapabilities,"offer",e.stream,i._dtlsRole),d+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===i.iceGatheringState||0!==t&&i.usingBundle||(e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1,d+="a="+c.writeCandidate(e)+"\r\n"}),"completed"===e.iceGatherer.state&&(d+="a=end-of-candidates\r\n"))}),n=new e.RTCSessionDescription({type:"offer",sdp:d}),Promise.resolve(n)},u.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(s("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(s("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var o=c.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(o+="a=group:BUNDLE "+n.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"),o+="a=ice-options:trickle\r\n";var a=c.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach(function(e,s){if(!(s+1>a))if(e.rejected)"application"===e.kind?o="DTLS/SCTP"===e.protocol?o+"m=application 0 DTLS/SCTP 5000\r\n":o+"m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?o+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(o+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),o+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n";else{var c;e.stream&&("audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&15019<=t&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1})),!(s=i(e.localCapabilities,e.remoteCapabilities)).codecs.filter(function(e){return"rtx"===e.name.toLowerCase()}).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,o+=r(e,s,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(o+="a=rtcp-rsize\r\n")}});var d=new e.RTCSessionDescription({type:"answer",sdp:o});return Promise.resolve(d)},u.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise(function(r,i){if(!n._remoteDescription)return i(s("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var o=e.sdpMLineIndex;if(e.sdpMid)for(var d=0;d<n.transceivers.length;d++)if(n.transceivers[d].mid===e.sdpMid){o=d;break}var u=n.transceivers[o];if(!u)return i(s("OperationError","Can not add ICE candidate"));if(u.rejected)return r();if("tcp"===(d=0<Object.keys(e.candidate).length?c.parseCandidate(e.candidate):{}).protocol&&(0===d.port||9===d.port)||d.component&&1!==d.component)return r();if((0===o||0<o&&u.iceTransport!==n.transceivers[0].iceTransport)&&!a(u.iceTransport,d))return i(s("OperationError","Can not add ICE candidate"));0===(i=e.candidate.trim()).indexOf("a=")&&(i=i.substr(2)),(t=c.getMediaSections(n._remoteDescription.sdp))[o]+="a="+(d.type?i:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=c.getDescription(n._remoteDescription.sdp)+t.join("")}else for(o=0;o<n.transceivers.length&&(n.transceivers[o].rejected||(n.transceivers[o].iceTransport.addRemoteCandidate({}),(t=c.getMediaSections(n._remoteDescription.sdp))[o]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=c.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));o++);r()})},u.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach(function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)}),!n)throw s("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach(function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(t){e[t]&&r.push(e[t].getStats())})}),Promise.all(r).then(function(e){var t=new Map;return e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})}),t})},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach(function(t){if((t=e[t])&&t.prototype&&t.prototype.getStats){var n=t.prototype.getStats;t.prototype.getStats=function(){return n.apply(this).then(function(e){var t=new Map;return Object.keys(e).forEach(function(n){var r=e[n];e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[r.type]||r.type,t.set(n,e[n])}),t})}}});var l=["createOffer","createAnswer"];return l.forEach(function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then(function(t){"function"==typeof e[0]&&e[0].apply(null,[t])},function(t){"function"==typeof e[1]&&e[1].apply(null,[t])}):t.apply(this,arguments)}}),(l=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach(function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)},function(t){"function"==typeof e[2]&&e[2].apply(null,[t])}):t.apply(this,arguments)}}),["getStats"].forEach(function(e){var t=u.prototype[e];u.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then(function(){"function"==typeof e[1]&&e[1].apply(null)}):t.apply(this,arguments)}}),u}},{sdp:17}],17:[function(e,t,n){var r={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};r.localCName=r.generateIdentifier(),r.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})},r.splitSections=function(e){return e.split("\nm=").map(function(e,t){return(0<t?"m="+e:e).trim()+"\r\n"})},r.getDescription=function(e){return(e=r.splitSections(e))&&e[0]},r.getMediaSections=function(e){return(e=r.splitSections(e)).shift(),e},r.matchPrefix=function(e,t){return r.splitLines(e).filter(function(e){return 0===e.indexOf(t)})},r.parseCandidate=function(e){for(var t={foundation:(e=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(e[1],10),protocol:e[2].toLowerCase(),priority:parseInt(e[3],10),ip:e[4],address:e[4],port:parseInt(e[5],10),type:e[7]},n=8;n<e.length;n+=2)switch(e[n]){case"raddr":t.relatedAddress=e[n+1];break;case"rport":t.relatedPort=parseInt(e[n+1],10);break;case"tcptype":t.tcpType=e[n+1];break;case"ufrag":t.ufrag=e[n+1],t.usernameFragment=e[n+1];break;default:t[e[n]]=e[n+1]}return t},r.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},r.parseIceOptions=function(e){return e.substr(14).split(" ")},r.parseRtpMap=function(e){e=e.substr(9).split(" ");var t={payloadType:parseInt(e.shift(),10)};return e=e[0].split("/"),t.name=e[0],t.clockRate=parseInt(e[1],10),t.channels=3===e.length?parseInt(e[2],10):1,t.numChannels=t.channels,t},r.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},r.parseExtmap=function(e){return e=e.substr(9).split(" "),{id:parseInt(e[0],10),direction:0<e[0].indexOf("/")?e[0].split("/")[1]:"sendrecv",uri:e[1]}},r.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},r.parseFmtp=function(e){for(var t={},n=e.substr(e.indexOf(" ")+1).split(";"),r=0;r<n.length;r++)t[(e=n[r].trim().split("="))[0].trim()]=e[1];return t},r.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var r=[];Object.keys(e.parameters).forEach(function(t){e.parameters[t]?r.push(t+"="+e.parameters[t]):r.push(t)}),t+="a=fmtp:"+n+" "+r.join(";")+"\r\n"}return t},r.parseRtcpFb=function(e){return{type:(e=e.substr(e.indexOf(" ")+1).split(" ")).shift(),parameter:e.join(" ")}},r.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},r.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},r=e.indexOf(":",t);return-1<r?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},r.parseSsrcGroup=function(e){return{semantics:(e=e.substr(13).split(" ")).shift(),ssrcs:e.map(function(e){return parseInt(e,10)})}},r.getMid=function(e){if(e=r.matchPrefix(e,"a=mid:")[0])return e.substr(6)},r.parseFingerprint=function(e){return{algorithm:(e=e.substr(14).split(" "))[0].toLowerCase(),value:e[1]}},r.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:r.matchPrefix(e+t,"a=fingerprint:").map(r.parseFingerprint)}},r.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},r.getIceParameters=function(e,t){return{usernameFragment:(e=(e=r.splitLines(e)).concat(r.splitLines(t))).filter(function(e){return 0===e.indexOf("a=ice-ufrag:")})[0].substr(12),password:e.filter(function(e){return 0===e.indexOf("a=ice-pwd:")})[0].substr(10)}},r.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},r.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=r.splitLines(e)[0].split(" "),i=3;i<n.length;i++){var o=n[i];if(a=r.matchPrefix(e,"a=rtpmap:"+o+" ")[0]){var a=r.parseRtpMap(a),s=r.matchPrefix(e,"a=fmtp:"+o+" ");switch(a.parameters=s.length?r.parseFmtp(s[0]):{},a.rtcpFeedback=r.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(r.parseRtcpFb),t.codecs.push(a),a.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(a.name.toUpperCase())}}}return r.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(r.parseExtmap(e))}),t},r.writeRtpDescription=function(e,t){var n=(n=(n=(n=(n=(n=(n="")+"m="+e+" ")+(0<t.codecs.length?"9":"0"))+" UDP/TLS/RTP/SAVPF ")+t.codecs.map(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType}).join(" ")+"\r\n")+"c=IN IP4 0.0.0.0\r\n")+"a=rtcp:9 IN IP4 0.0.0.0\r\n";t.codecs.forEach(function(e){n+=r.writeRtpMap(e),n+=r.writeFmtp(e),n+=r.writeRtcpFb(e)});var i=0;return t.codecs.forEach(function(e){e.maxptime>i&&(i=e.maxptime)}),0<i&&(n+="a=maxptime:"+i+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach(function(e){n+=r.writeExtmap(e)}),n},r.parseRtpEncodingParameters=function(e){var t,n,i=[],o=r.parseRtpParameters(e),a=-1!==o.fecMechanisms.indexOf("RED"),s=-1!==o.fecMechanisms.indexOf("ULPFEC"),c=0<(n=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})).length&&n[0].ssrc;0<(n=r.matchPrefix(e,"a=ssrc-group:FID").map(function(e){return e.substr(17).split(" ").map(function(e){return parseInt(e,10)})})).length&&1<n[0].length&&n[0][0]===c&&(t=n[0][1]),o.codecs.forEach(function(e){"RTX"===e.name.toUpperCase()&&e.parameters.apt&&(e={ssrc:c,codecPayloadType:parseInt(e.parameters.apt,10)},c&&t&&(e.rtx={ssrc:t}),i.push(e),a&&((e=JSON.parse(JSON.stringify(e))).fec={ssrc:c,mechanism:s?"red+ulpfec":"red"},i.push(e)))}),0===i.length&&c&&i.push({ssrc:c});var d=r.matchPrefix(e,"b=");return d.length&&(d=0===d[0].indexOf("b=TIAS:")?parseInt(d[0].substr(7),10):0===d[0].indexOf("b=AS:")?950*parseInt(d[0].substr(5),10)-16e3:void 0,i.forEach(function(e){e.maxBitrate=d})),i},r.parseRtcpParameters=function(e){var t={},n=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"cname"===e.attribute})[0];return n&&(t.cname=n.value,t.ssrc=n.ssrc),n=r.matchPrefix(e,"a=rtcp-rsize"),t.reducedSize=0<n.length,t.compound=0===n.length,e=r.matchPrefix(e,"a=rtcp-mux"),t.mux=0<e.length,t},r.parseMsid=function(e){var t=r.matchPrefix(e,"a=msid:");return 1===t.length?{stream:(e=t[0].substr(7).split(" "))[0],track:e[1]}:0<(e=r.matchPrefix(e,"a=ssrc:").map(function(e){return r.parseSsrcMedia(e)}).filter(function(e){return"msid"===e.attribute})).length?{stream:(e=e[0].value.split(" "))[0],track:e[1]}:void 0},r.generateSessionId=function(){return Math.random().toString().substr(2,21)},r.writeSessionBoilerplate=function(e,t,n){return t=void 0!==t?t:2,"v=0\r\no="+(n||"thisisadapterortc")+" "+(e=e||r.generateSessionId())+" "+t+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},r.writeMediaSection=function(e,t,n,i){return t=r.writeRtpDescription(e.kind,t),t+=r.writeIceParameters(e.iceGatherer.getLocalParameters()),t+=r.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),t+="a=mid:"+e.mid+"\r\n",t=e.direction?t+"a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?t+"a=sendrecv\r\n":e.rtpSender?t+"a=sendonly\r\n":e.rtpReceiver?t+"a=recvonly\r\n":t+"a=inactive\r\n",e.rtpSender&&(t=t+"a="+(n="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n")+"a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+n,e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+n,t+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")),t+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+r.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+r.localCName+"\r\n"),t},r.getDirection=function(e,t){e=r.splitLines(e);for(var n=0;n<e.length;n++)switch(e[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return e[n].substr(2)}return t?r.getDirection(t):"sendrecv"},r.getKind=function(e){return r.splitLines(e)[0].split(" ")[0].substr(2)},r.isRejected=function(e){return"0"===e.split(" ",2)[1]},r.parseMLine=function(e){return{kind:(e=r.splitLines(e)[0].substr(2).split(" "))[0],port:parseInt(e[1],10),protocol:e[2],fmt:e.slice(3).join(" ")}},r.parseOLine=function(e){return{username:(e=r.matchPrefix(e,"o=")[0].substr(2).split(" "))[0],sessionId:e[1],sessionVersion:parseInt(e[2],10),netType:e[3],addressType:e[4],address:e[5]}},r.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;e=r.splitLines(e);for(var t=0;t<e.length;t++)if(2>e[t].length||"="!==e[t].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=r)},{}]},{},[1])(1)},function(e,t,n){n(52)(n(53))},function(e,t){e.exports=function(e){function t(e){"undefined"!=typeof console&&(console.error||console.log)("[Script Loader]",e)}try{"undefined"!=typeof execScript&&"undefined"!=typeof attachEvent&&"undefined"==typeof addEventListener?execScript(e):"undefined"!=typeof eval?eval.call(null,e):t("EvalError: No eval function available")}catch(e){t(e)}}},function(e,t){e.exports="/* globals $$, jQuery, Elements, document, window, L */\n\n/**\n* Copyright 2013 Marc J. Schmidt. See the LICENSE file at the top-level\n* directory of this distribution and at\n* https://github.com/marcj/css-element-queries/blob/master/LICENSE.\n*/\nthis.L = this.L || {};\n\n/**\n * @param {HTMLElement} element\n * @param {String}      prop\n * @returns {String|Number}\n */\nL.GetComputedStyle = (computedElement, prop) => {\n  if (computedElement.currentStyle) {\n    return computedElement.currentStyle[prop];\n  } else if (window.getComputedStyle) {\n    return window.getComputedStyle(computedElement, null).getPropertyValue(prop);\n  }\n  return computedElement.style[prop];\n};\n\n  /**\n   *\n   * @type {Function}\n   * @constructor\n   */\nL.ElementQueries = function ElementQueries() {\n      /**\n       *\n       * @param element\n       * @returns {Number}\n       */\n  function getEmSize(element = document.documentElement) {\n    const fontSize = L.GetComputedStyle(element, 'fontSize');\n    return parseFloat(fontSize) || 16;\n  }\n\n      /**\n       *\n       * @copyright https://github.com/Mr0grog/element-query/blob/master/LICENSE\n       *\n       * @param element\n       * @param value\n       * @param units\n       * @returns {*}\n       */\n  function convertToPx(element, originalValue) {\n    let vh;\n    let vw;\n    let chooser;\n    const units = originalValue.replace(/[0-9]*/, '');\n    const value = parseFloat(originalValue);\n    switch (units) {\n      case 'px':\n        return value;\n      case 'em':\n        return value * getEmSize(element);\n      case 'rem':\n        return value * getEmSize();\n              // Viewport units!\n              // According to http://quirksmode.org/mobile/tableViewport.html\n              // documentElement.clientWidth/Height gets us the most reliable info\n      case 'vw':\n        return (value * document.documentElement.clientWidth) / 100;\n      case 'vh':\n        return (value * document.documentElement.clientHeight) / 100;\n      case 'vmin':\n      case 'vmax':\n        vw = document.documentElement.clientWidth / 100;\n        vh = document.documentElement.clientHeight / 100;\n        chooser = Math[units === 'vmin' ? 'min' : 'max'];\n        return value * chooser(vw, vh);\n      default:\n        return value;\n              // for now, not supporting physical units (since they are just a set number of px)\n              // or ex/ch (getting accurate measurements is hard)\n    }\n  }\n\n      /**\n       *\n       * @param {HTMLElement} element\n       * @constructor\n       */\n  function SetupInformation(element) {\n    this.element = element;\n    this.options = [];\n    let i;\n    let j;\n    let option;\n    let width = 0;\n    let height = 0;\n    let value;\n    let actualValue;\n    let attrValues;\n    let attrValue;\n    let attrName;\n\n          /**\n           * @param option {mode: 'min|max', property: 'width|height', value: '123px'}\n           */\n    this.addOption = (newOption) => {\n      this.options.push(newOption);\n    };\n\n    const attributes = ['min-width', 'min-height', 'max-width', 'max-height'];\n\n          /**\n           * Extracts the computed width/height and sets to min/max- attribute.\n           */\n    this.call = () => {\n              // extract current dimensions\n      width = this.element.offsetWidth;\n      height = this.element.offsetHeight;\n\n      attrValues = {};\n\n      for (i = 0, j = this.options.length; i < j; i += 1) {\n        option = this.options[i];\n        value = convertToPx(this.element, option.value);\n\n        actualValue = option.property === 'width' ? width : height;\n        attrName = `${option.mode}-${option.property}`;\n        attrValue = '';\n\n        if (option.mode === 'min' && actualValue >= value) {\n          attrValue += option.value;\n        }\n\n        if (option.mode === 'max' && actualValue <= value) {\n          attrValue += option.value;\n        }\n\n        if (!attrValues[attrName]) attrValues[attrName] = '';\n        if (attrValue && (` ${attrValues[attrName]} `)\n                                            .indexOf(` ${attrValue} `) === -1) {\n          attrValues[attrName] += ` ${attrValue}`;\n        }\n      }\n\n      for (let k = 0; k < attributes.length; k += 1) {\n        if (attrValues[attributes[k]]) {\n          this.element.setAttribute(attributes[k],\n                                                attrValues[attributes[k]].substr(1));\n        } else {\n          this.element.removeAttribute(attributes[k]);\n        }\n      }\n    };\n  }\n\n      /**\n       * @param {HTMLElement} element\n       * @param {Object}      options\n       */\n  function setupElement(originalElement, options) {\n    const element = originalElement;\n    if (element.elementQueriesSetupInformation) {\n      element.elementQueriesSetupInformation.addOption(options);\n    } else {\n      element.elementQueriesSetupInformation = new SetupInformation(element);\n      element.elementQueriesSetupInformation.addOption(options);\n      element.sensor = new L.ResizeSensor(element, () => {\n        element.elementQueriesSetupInformation.call();\n      });\n    }\n    element.elementQueriesSetupInformation.call();\n    return element;\n  }\n\n      /**\n       * @param {String} selector\n       * @param {String} mode min|max\n       * @param {String} property width|height\n       * @param {String} value\n       */\n  function queueQuery(selector, mode, property, value) {\n    let query;\n    if (document.querySelectorAll) query = document.querySelectorAll.bind(document);\n    if (!query && typeof $$ !== 'undefined') query = $$;\n    if (!query && typeof jQuery !== 'undefined') query = jQuery;\n\n    if (!query) {\n      throw new Error('No document.querySelectorAll, jQuery or Mootools\\'s $$ found.');\n    }\n\n    const elements = query(selector) || [];\n    for (let i = 0, j = elements.length; i < j; i += 1) {\n      elements[i] = setupElement(elements[i], {\n        mode,\n        property,\n        value,\n      });\n    }\n  }\n\n  const regex = /,?([^,\\n]*)\\[[\\s\\t]*(min|max)-(width|height)[\\s\\t]*[~$^]?=[\\s\\t]*\"([^\"]*)\"[\\s\\t]*]([^\\n\\s{]*)/mgi;  // jshint ignore:line\n\n      /**\n       * @param {String} css\n       */\n  function extractQuery(originalCss) {\n    let match;\n    const css = originalCss.replace(/'/g, '\"');\n    while ((match = regex.exec(css)) !== null) {\n      if (match.length > 5) {\n        queueQuery(match[1] || match[5], match[2], match[3], match[4]);\n      }\n    }\n  }\n\n      /**\n       * @param {CssRule[]|String} rules\n       */\n  function readRules(originalRules) {\n    if (!originalRules) {\n      return;\n    }\n    let selector = '';\n    let rules = originalRules;\n    if (typeof originalRules === 'string') {\n      rules = originalRules.toLowerCase();\n      if (rules.indexOf('min-width') !== -1 || rules.indexOf('max-width') !== -1) {\n        extractQuery(rules);\n      }\n    } else {\n      for (let i = 0, j = rules.length; i < j; i += 1) {\n        if (rules[i].type === 1) {\n          selector = rules[i].selectorText || rules[i].cssText;\n          if (selector.indexOf('min-height') !== -1 ||\n                          selector.indexOf('max-height') !== -1) {\n            extractQuery(selector);\n          } else if (selector.indexOf('min-width') !== -1 ||\n                                 selector.indexOf('max-width') !== -1) {\n            extractQuery(selector);\n          }\n        } else if (rules[i].type === 4) {\n          readRules(rules[i].cssRules || rules[i].rules);\n        }\n      }\n    }\n  }\n\n      /**\n       * Searches all css rules and setups the event listener\n       * to all elements with element query rules..\n       */\n  this.init = () => {\n    const styleSheets = document.styleSheets || [];\n    for (let i = 0, j = styleSheets.length; i < j; i += 1) {\n      if (Object.prototype.hasOwnProperty.call(styleSheets[i], 'cssText')) {\n        readRules(styleSheets[i].cssText);\n      } else if (Object.prototype.hasOwnProperty.call(styleSheets[i], 'cssRules')) {\n        readRules(styleSheets[i].cssRules);\n      } else if (Object.prototype.hasOwnProperty.call(styleSheets[i], 'rules')) {\n        readRules(styleSheets[i].rules);\n      }\n    }\n  };\n};\n\nfunction init() {\n  (new L.ElementQueries()).init();\n}\n\nif (window.addEventListener) {\n  window.addEventListener('load', init, false);\n} else {\n  window.attachEvent('onload', init);\n}\n\n  /**\n   * Iterate over each of the provided element(s).\n   *\n   * @param {HTMLElement|HTMLElement[]} elements\n   * @param {Function}                  callback\n   */\nfunction forEachElement(elements, callback = () => {}) {\n  const elementsType = Object.prototype.toString.call(elements);\n  const isCollectionTyped = (elementsType === '[object Array]' ||\n          (elementsType === '[object NodeList]') ||\n          (elementsType === '[object HTMLCollection]') ||\n          (typeof jQuery !== 'undefined' && elements instanceof jQuery) || // jquery\n          (typeof Elements !== 'undefined' && elements instanceof Elements) // mootools\n      );\n  let i = 0;\n  const j = elements.length;\n  if (isCollectionTyped) {\n    for (; i < j; i += 1) {\n      callback(elements[i]);\n    }\n  } else {\n    callback(elements);\n  }\n}\n  /**\n   * Class for dimension change detection.\n   *\n   * @param {Element|Element[]|Elements|jQuery} element\n   * @param {Function} callback\n   *\n   * @constructor\n   */\nL.ResizeSensor = function ResizeSensor(element, callback = () => {}) {\n      /**\n       *\n       * @constructor\n       */\n  function EventQueue() {\n    let q = [];\n    this.add = (ev) => {\n      q.push(ev);\n    };\n\n    let i;\n    let j;\n    this.call = () => {\n      for (i = 0, j = q.length; i < j; i += 1) {\n        q[i].call();\n      }\n    };\n\n    this.remove = (ev) => {\n      const newQueue = [];\n      for (i = 0, j = q.length; i < j; i += 1) {\n        if (q[i] !== ev) newQueue.push(q[i]);\n      }\n      q = newQueue;\n    };\n\n    this.length = () => q.length;\n  }\n\n      /**\n       *\n       * @param {HTMLElement} element\n       * @param {Function}    resized\n       */\n  function attachResizeEvent(htmlElement, resized) {\n    // Only used for the dirty checking, so the event callback count is limted\n    //  to max 1 call per fps per sensor.\n    // In combination with the event based resize sensor this saves cpu time,\n    // because the sensor is too fast and\n    // would generate too many unnecessary events.\n    const customRequestAnimationFrame = window.requestAnimationFrame ||\n    window.mozRequestAnimationFrame ||\n    window.webkitRequestAnimationFrame ||\n    function delay(fn) {\n      return window.setTimeout(fn, 20);\n    };\n\n    const newElement = htmlElement;\n    if (!newElement.resizedAttached) {\n      newElement.resizedAttached = new EventQueue();\n      newElement.resizedAttached.add(resized);\n    } else if (newElement.resizedAttached) {\n      newElement.resizedAttached.add(resized);\n      return;\n    }\n\n    newElement.resizeSensor = document.createElement('div');\n    newElement.resizeSensor.className = 'resize-sensor';\n    const style = 'position: absolute; left: 0; top: 0; right: 0; bottom: 0; ' +\n                      'overflow: hidden; z-index: -1; visibility: hidden;';\n    const styleChild = 'position: absolute; left: 0; top: 0; transition: 0s;';\n\n    newElement.resizeSensor.style.cssText = style;\n    newElement.resizeSensor.innerHTML =\n              `<div class=\"resize-sensor-expand\" style=\"${style}\">` +\n                  `<div style=\"${styleChild}\"></div>` +\n              '</div>' +\n              `<div class=\"resize-sensor-shrink\" style=\"${style}\">` +\n                  `<div style=\"${styleChild} width: 200%; height: 200%\"></div>` +\n              '</div>';\n    newElement.appendChild(newElement.resizeSensor);\n\n    if (L.GetComputedStyle(newElement, 'position') === 'static') {\n      newElement.style.position = 'relative';\n    }\n\n    const expand = newElement.resizeSensor.childNodes[0];\n    const expandChild = expand.childNodes[0];\n    const shrink = newElement.resizeSensor.childNodes[1];\n\n    const reset = () => {\n      expandChild.style.width = `${100000}px`;\n      expandChild.style.height = `${100000}px`;\n\n      expand.scrollLeft = 100000;\n      expand.scrollTop = 100000;\n\n      shrink.scrollLeft = 100000;\n      shrink.scrollTop = 100000;\n    };\n\n    reset();\n    let dirty = false;\n\n    const dirtyChecking = () => {\n      if (!newElement.resizedAttached) return;\n\n      if (dirty) {\n        newElement.resizedAttached.call();\n        dirty = false;\n      }\n\n      customRequestAnimationFrame(dirtyChecking);\n    };\n\n    customRequestAnimationFrame(dirtyChecking);\n    let lastWidth;\n    let lastHeight;\n    let cachedWidth;\n    let cachedHeight; // useful to not query offsetWidth twice\n\n    const onScroll = () => {\n      if ((cachedWidth = newElement.offsetWidth) !== lastWidth ||\n                (cachedHeight = newElement.offsetHeight) !== lastHeight) {\n        dirty = true;\n\n        lastWidth = cachedWidth;\n        lastHeight = cachedHeight;\n      }\n      reset();\n    };\n\n    const addEvent = (el, name, cb) => {\n      if (el.attachEvent) {\n        el.attachEvent(`on${name}`, cb);\n      } else {\n        el.addEventListener(name, cb);\n      }\n    };\n\n    addEvent(expand, 'scroll', onScroll);\n    addEvent(shrink, 'scroll', onScroll);\n  }\n\n  forEachElement(element, (elem) => {\n    attachResizeEvent(elem, callback);\n  });\n\n  this.detach = (ev) => {\n    L.ResizeSensor.detach(element, ev);\n  };\n};\n\nL.ResizeSensor.detach = (element, ev) => {\n  forEachElement(element, (elem) => {\n    const elementItem = elem;\n    if (elementItem.resizedAttached && typeof ev === 'function') {\n      elementItem.resizedAttached.remove(ev);\n      if (elementItem.resizedAttached.length()) return;\n    }\n    if (elementItem.resizeSensor) {\n      if (elementItem.contains(elementItem.resizeSensor)) {\n        elementItem.removeChild(elementItem.resizeSensor);\n      }\n      delete elementItem.resizeSensor;\n      delete elementItem.resizedAttached;\n    }\n  });\n};\n"}]).default}).call(this,n(/*! ./../../node_modules/webpack/buildin/global.js */"./node_modules/webpack/buildin/global.js"))},"./sdk/polyfills.js":
/*!**************************!*\
  !*** ./sdk/polyfills.js ***!
  \**************************/
/*! no exports provided */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: multi ./sdk/polyfills.js ./sdk/index.js (referenced with single entry) */function(e,t,n){"use strict";n.r(t);n(/*! raf/polyfill */"./node_modules/raf/polyfill.js");"undefined"==typeof Promise&&(n(/*! promise/lib/rejection-tracking */"./node_modules/promise/lib/rejection-tracking.js").enable(),window.Promise=n(/*! promise/lib/es6-extensions.js */"./node_modules/promise/lib/es6-extensions.js")),n(/*! whatwg-fetch */"./node_modules/whatwg-fetch/fetch.js"),Object.assign=n(/*! object-assign */"./node_modules/object-assign/index.js")},0:
/*!***********************************************!*\
  !*** multi ./sdk/polyfills.js ./sdk/index.js ***!
  \***********************************************/
/*! no static exports found */
/*! all exports used */
/*! ModuleConcatenation bailout: Module is not an ECMAScript module */function(e,t,n){n(/*! /home/anastasiia/Project/TeeVid-Server/sdk/polyfills.js */"./sdk/polyfills.js"),e.exports=n(/*! /home/anastasiia/Project/TeeVid-Server/sdk/index.js */"./sdk/index.js")}});
//# sourceMappingURL=sdk.js.map